<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Structural-Models &mdash; ChiSurf 0.0.5 documentation</title>
    
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.0.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="ChiSurf 0.0.5 documentation" href="../../index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          ChiSurf</a>
        <span class="navbar-text navbar-version pull-left"><b>0.0.5</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use_cases.html">Use cases</a></li>
</ul>
<ul class="simple">
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Structural-Models</a><ul>
<li><a class="reference internal" href="#module-mfm.structure.structure">Structure</a></li>
<li><a class="reference internal" href="#module-mfm.structure.trajectory">Trajectory</a></li>
<li><a class="reference internal" href="#fret-positioning-system">FRET-Positioning-System</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/user_documentation/api/structure.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="module-mfm.structure">
<span id="structural-models"></span><h1>Structural-Models<a class="headerlink" href="#module-mfm.structure" title="Permalink to this headline">¶</a></h1>
<p>The structure module contains most functions and classes to handle structural models of proteins. It contains basically
two submodules:</p>
<ol class="arabic simple">
<li><a class="reference internal" href="#module-mfm.structure.structure" title="mfm.structure.structure"><code class="xref py py-mod docutils literal"><span class="pre">mfm.structure.structure</span></code></a></li>
<li><a class="reference internal" href="#module-mfm.structure.trajectory" title="mfm.structure.trajectory"><code class="xref py py-mod docutils literal"><span class="pre">mfm.structure.trajectory</span></code></a></li>
<li><code class="xref py py-mod docutils literal"><span class="pre">mfm.potential</span></code></li>
</ol>
<p>The module <code class="xref py py-mod docutils literal"><span class="pre">mfm.potential</span></code> provides a set of potentials. The module <a class="reference internal" href="#module-mfm.structure.structure" title="mfm.structure.structure"><code class="xref py py-mod docutils literal"><span class="pre">mfm.structure.structure</span></code></a>
provides a set of functions and classes to work with structures and trajectories.</p>
<dl class="class">
<dt id="mfm.structure.Structure">
<em class="property">class </em><code class="descclassname">mfm.structure.</code><code class="descname">Structure</code><span class="sig-paren">(</span><em>p_object</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure.html#Structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.Structure" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">Structure</span><span class="p">(</span><span class="s1">&#39;./sample_data/modelling/pdb_files/hGBP1_closed.pdb&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">======================================</span>
<span class="go">Filename: ../sample_data/structure/HM_1FN5_Naming.pdb</span>
<span class="go">Path: ../sample_data/structure</span>
<span class="go">Number of atoms: 9316</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">structure</span><span class="p">)[:</span><span class="mi">324</span><span class="p">]</span>
<span class="go">ATOM      1    N MET     7      72.739 -17.501   8.879  0.00  0.00             N</span>
<span class="go">ATOM      2   CA MET     7      73.841 -17.042   9.747  0.00  0.00             C</span>
<span class="go">ATOM      3    C MET     7      74.361 -18.178  10.643  0.00  0.00             C</span>
<span class="go">ATOM      4    O MET     7      73.642 -18.708  11.489  0.00  0.00             O</span>
</pre></div>
</div>
<p>Write structure to disk</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;test_out.pdb&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Radius of gyration</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span><span class="o">.</span><span class="n">radius_gyration</span>
<span class="go">50.31556120901161</span>
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#mfm.structure.Structure.xyz" title="mfm.structure.Structure.xyz"><code class="xref py py-obj docutils literal"><span class="pre">xyz</span></code></a></td>
<td>Cartesian coordinates of all atoms</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>max_atom_residue</td>
<td>(int) Maximum atoms per residue. The maximum atoms per residue have to be limited, because of the residue/atom lookup tables. By default maximum 16 atoms per residue are allowed.</td>
</tr>
<tr class="row-even"><td>residue_names: list</td>
<td>residue names is a list of the residue-names. Here the residues are represented by the same name as the initial PDB-file, usually 3-letter amino-acid code. The residue_names attribute may look like: [&#8216;TYR&#8217;, &#8216;HIS&#8217;, &#8216;ARG&#8217;]</td>
</tr>
<tr class="row-odd"><td>n_atoms: int</td>
<td>The number of atoms</td>
</tr>
<tr class="row-even"><td>b_factos: array</td>
<td>An array of the b-factors.</td>
</tr>
<tr class="row-odd"><td>radius_gyration: float</td>
<td>The attribute radius_gyration returns the radius of gyration of the structure. The radius of gyration is given by: rG = (np.sqrt((coord - rM) ** 2).sum(axis=1)).mean() Here rM are the mean coordinates of the structure.</td>
</tr>
<tr class="row-even"><td><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param filename:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</td>
<td>Path to the pdb file on disk</td>
</tr>
<tr class="row-odd"><td><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">param make_coarse:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</td>
<td>Conversion to coarse representation using internal coordinates. Side-chains are not considered. The Cbeta-atoms is moved to center of mass of the side-chain.</td>
</tr>
<tr class="row-even"><td><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param verbose:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</td>
<td>print output to stdout</td>
</tr>
<tr class="row-odd"><td><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">param auto_update:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</td>
<td>update cartesian-coordiantes automatically after change of internal coordinates. This only applies for coarse-grained coordinates</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="mfm.structure.Structure.b_factors">
<code class="descname">b_factors</code><a class="headerlink" href="#mfm.structure.Structure.b_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>B-factors of the C-alpha atoms</p>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.Structure.get_atom_index">
<code class="descname">get_atom_index</code><span class="sig-paren">(</span><em>atom_names</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure.html#Structure.get_atom_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.Structure.get_atom_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the indeces with a given atom name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom_names</strong> &#8211; list of string of the atom-names</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of integers the indices with a given atom name</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mfm.structure.Structure.vdw">
<code class="descname">vdw</code><a class="headerlink" href="#mfm.structure.Structure.vdw" title="Permalink to this definition">¶</a></dt>
<dd><p>Van der Waals radii of all atoms</p>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.Structure.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure.html#Structure.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.Structure.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the structure to a filename. By default it uses PDB files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> &#8211; The filename</li>
<li><strong>append_model</strong> &#8211; bool
If True the structure is appended to the filename as a new model otherwise the file is overwritten</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mfm.structure.Structure.xyz">
<code class="descname">xyz</code><a class="headerlink" href="#mfm.structure.Structure.xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian coordinates of all atoms</p>
</dd></dl>

</dd></dl>

<div class="section" id="module-mfm.structure.structure">
<span id="structure"></span><h2>Structure<a class="headerlink" href="#module-mfm.structure.structure" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mfm.structure.structure.average">
<code class="descclassname">mfm.structure.structure.</code><code class="descname">average</code><span class="sig-paren">(</span><em>structures</em>, <em>weights=None</em>, <em>write=True</em>, <em>filename=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.average" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates weighted average of a list of structures.
saves to filename if write is True
if filename not provided makes new &#8220;average.pdb&#8221; file in temp-folder
of the system</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/structure/2807_8_9_b.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">average</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg</span>
<span class="go">&lt;mfm.structure.structure.Structure at 0x117ff770&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg</span><span class="o">.</span><span class="n">filename</span>
<span class="go">&#39;c:\users\peulen\appdata\local\temp\average.pdb&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.count_atoms">
<code class="descclassname">mfm.structure.structure.</code><code class="descname">count_atoms</code><span class="sig-paren">(</span><em>topology_dict</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#count_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.count_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of atoms in a topology dict</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>topology_dict</strong> &#8211; dict
a topology of a structure as python dict (as described by MDTraj)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.find_best">
<code class="descclassname">mfm.structure.structure.</code><code class="descname">find_best</code><span class="sig-paren">(</span><em>target</em>, <em>reference</em>, <em>atom_indices=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#find_best"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.find_best" title="Permalink to this definition">¶</a></dt>
<dd><p>target and reference are both of type mdtraj.Trajectory
reference is of length 1, target of arbitrary length</p>
<p>returns a Structure object and the index within the trajectory</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/structure/2807_8_9_b.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_best</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">mdtraj</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">mdtraj</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">(2, &lt;mdtraj.Trajectory with 1 frames, 2495 atoms, 164 residues, without unitcells at 0x13570b30&gt;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.get_atom_index_by_name">
<code class="descclassname">mfm.structure.structure.</code><code class="descname">get_atom_index_by_name</code><span class="sig-paren">(</span><em>pdb</em>, <em>atom_names</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#get_atom_index_by_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.get_atom_index_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns atom-indices given a an atomic name as list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pdb</strong> &#8211; </li>
<li><strong>atom_names</strong> &#8211; list of strings</li>
<li><strong>verbose</strong> &#8211; bool</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb_file</span> <span class="o">=</span> <span class="s1">&#39;./sample_data/model/hgbp1/hGBP1_closed.pdb&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">pdb_file</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Opening PDB-file: ./sample_data/model/hgbp1/hGBP1_closed.pdb</span>
<span class="go">======================================</span>
<span class="go">Filename: ./sample_data/model/hgbp1/hGBP1_closed.pdb</span>
<span class="go">Path: ./sample_data/model/hgbp1</span>
<span class="go">Number of atoms: 9316</span>
<span class="go">--------------------------</span>
</pre></div>
</div>
<p>Get all atom-indices of all C-alphas in the TRY</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mfm</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">selection2atom_idx</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;TRP&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]})</span>
<span class="go">OrderedDict([(&#39;TRP&#39;, array([1114, 1155, 1651, 2690], dtype=uint32))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mfm</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">selection2atom_idx</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;TRP&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">],</span> <span class="s1">&#39;TYR&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]})</span>
<span class="go">OrderedDict([(&#39;TRP&#39;, array([1114, 1155, 1651, 2690], dtype=uint32)), (&#39;TYR&#39;, array([ 608,  707, 1879,</span>
<span class="go">2107, 2128, 3013, 3067, 4231, 4667, 5169, 6651, 6733, 7005, 7026, 7289, 8272], dtype=uint32))])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.get_atom_index_of_residue_types">
<code class="descclassname">mfm.structure.structure.</code><code class="descname">get_atom_index_of_residue_types</code><span class="sig-paren">(</span><em>pdb</em>, <em>res_types</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#get_atom_index_of_residue_types"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.get_atom_index_of_residue_types" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns atom-indices given a selection of residue types and atom names as OrderedDict.
The selection is based on dictionaries. For each residue-type only the atoms within a
list are selected (see example)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pdb</strong> &#8211; </li>
<li><strong>res_types</strong> &#8211; dict</li>
<li><strong>verbose</strong> &#8211; bool</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">OrderedDict</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb_file</span> <span class="o">=</span> <span class="s1">&#39;./sample_data/model/hgbp1/hGBP1_closed.pdb&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">pdb_file</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Opening PDB-file: ./sample_data/model/hgbp1/hGBP1_closed.pdb</span>
<span class="go">======================================</span>
<span class="go">Filename: ./sample_data/model/hgbp1/hGBP1_closed.pdb</span>
<span class="go">Path: ./sample_data/model/hgbp1</span>
<span class="go">Number of atoms: 9316</span>
<span class="go">--------------------------</span>
</pre></div>
</div>
<p>Get all atom-indices of all C-alphas in the TRY</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mfm</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">selection2atom_idx</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;TRP&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]})</span>
<span class="go">OrderedDict([(&#39;TRP&#39;, array([1114, 1155, 1651, 2690], dtype=uint32))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mfm</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">selection2atom_idx</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;TRP&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">],</span> <span class="s1">&#39;TYR&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]})</span>
<span class="go">OrderedDict([(&#39;TRP&#39;, array([1114, 1155, 1651, 2690], dtype=uint32)), (&#39;TYR&#39;, array([ 608,  707, 1879,</span>
<span class="go">2107, 2128, 3013, 3067, 4231, 4667, 5169, 6651, 6733, 7005, 7026, 7289, 8272], dtype=uint32))])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.get_coordinates_of_residues">
<code class="descclassname">mfm.structure.structure.</code><code class="descname">get_coordinates_of_residues</code><span class="sig-paren">(</span><em>atoms</em>, <em>quencher</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#get_coordinates_of_residues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.get_coordinates_of_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns coordinates and indices of all atoms of certain residue type.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pdb</strong> &#8211; numpy-array
numpy-array as returned by PDB.read</li>
<li><strong>quencher</strong> &#8211; dict</li>
<li><strong>verbose</strong> &#8211; bool</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb_file</span> <span class="o">=</span> <span class="s1">&#39;./sample_data/model/hgbp1/hGBP1_closed.pdb&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">pdb_file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">pdb_file</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Opening PDB-file: ./sample_data/model/hgbp1/hGBP1_closed.pdb</span>
<span class="go">======================================</span>
<span class="go">Filename: ./sample_data/model/hgbp1/hGBP1_closed.pdb</span>
<span class="go">Path: ./sample_data/model/hgbp1</span>
<span class="go">Number of atoms: 9316</span>
<span class="go">--------------------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mfm</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">get_quencher_coordinates</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;TRP&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]})</span>
<span class="go">OrderedDict([(&#39;TRP&#39;, array([[ 74.783,  -7.884,  18.04 ],</span>
<span class="go">    [ 71.558, -13.346,  15.126],</span>
<span class="go">   [ 70.873,   4.983,  23.373],</span>
<span class="go">   [ 61.507,  -8.977,  33.237]]))])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.make_dictionary_of_atoms">
<code class="descclassname">mfm.structure.structure.</code><code class="descname">make_dictionary_of_atoms</code><span class="sig-paren">(</span><em>atoms</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#make_dictionary_of_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.make_dictionary_of_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Organizes atoms residue-wise in an OrderedDict</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atoms</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">OrderedDict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.onRMSF">
<code class="descclassname">mfm.structure.structure.</code><code class="descname">onRMSF</code><span class="sig-paren">(</span><em>structures</em>, <em>selectedNbrs</em>, <em>atomName=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#onRMSF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.onRMSF" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the root mean square deviation with respect to the average structure
for a given set of structures. The structures do not have to be aligned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>structures</strong> &#8211; </li>
<li><strong>selectedNbrs</strong> &#8211; </li>
<li><strong>atomName</strong> &#8211; </li>
<li><strong>weights</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.rmsd">
<code class="descclassname">mfm.structure.structure.</code><code class="descname">rmsd</code><span class="sig-paren">(</span><em>structure_a</em>, <em>structure_b</em>, <em>atom_indices=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#rmsd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the root-mean-squared deviation between two structures. In case the indices of the atoms are
provided only the, respective atoms are used to calculate the RMSD.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>structure_a</strong> &#8211; </li>
<li><strong>structure_b</strong> &#8211; </li>
<li><strong>atom_indices</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">float, root-mean-squared deviation</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/structure/2807_8_9_b.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span>
<span class="go">&lt;mfm.structure.structure.Structure at 0x135f3ad0&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span>
<span class="go">&lt;mfm.structure.structure.Structure at 0x1348fbb0&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rmsd</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
<span class="go">6.960082250440536</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.sequence">
<code class="descclassname">mfm.structure.structure.</code><code class="descname">sequence</code><span class="sig-paren">(</span><em>structure</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#sequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dictionary of sequences keyed to chain and type of sequence used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>structure</strong> &#8211; Structure</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.super_impose">
<code class="descclassname">mfm.structure.structure.</code><code class="descname">super_impose</code><span class="sig-paren">(</span><em>structure_ref</em>, <em>structure_align</em>, <em>atom_indices=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#super_impose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.super_impose" title="Permalink to this definition">¶</a></dt>
<dd><p>Superimpose two structures</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>structure_ref</strong> &#8211; </li>
<li><strong>structure_align</strong> &#8211; </li>
<li><strong>atom_indices</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-mfm.structure.trajectory">
<span id="trajectory"></span><h2>Trajectory<a class="headerlink" href="#module-mfm.structure.trajectory" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="mfm.structure.trajectory.TrajectoryFile">
<em class="property">class </em><code class="descclassname">mfm.structure.trajectory.</code><code class="descname">TrajectoryFile</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/trajectory.html#TrajectoryFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Creates an Trajectory of Structures given a HDF5-File using mdtraj.HDF5TrajectoryFile</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>structure</strong> : string / Structure</p>
<blockquote>
<div><blockquote>
<div><p>determines the topology
is either a string containing the filename of a PDB-File or an instance of Structure()
Obligatory in write mode, not needed in reading mode</p>
</div></blockquote>
<dl class="docutils">
<dt>filename_hdf</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">string</span><dd><p class="first last">the filename of the HDF5-file</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first"><strong>verbose</strong> : bool</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>stride</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">int, default=None</span><dd><p class="first last">Only read every stride-th frame.</p>
</dd>
<dt>frame</dt>
 <span class="classifier-delimiter">:</span> <span class="classifier">integer or None</span><dd><p class="first last">If frame is an integer only the frame number provided by the integer is loaded otherwise the whole trajectory
is loaded.</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>import mfm.structure    &gt;&gt;&gt; import mfm</dt>
<dd><div class="first highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">Structure</span><span class="p">(</span><span class="s1">&#39;./sample_data/modelling/trajectory/h5-file/T4L_Topology.pdb&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">make_coarse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/modelling/trajectory/h5-file/hgbp1_transition.h5&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;mfm.structure.structure.Structure at 0x11f34e10&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">ATOM      1    N MET     1     -10.750  14.401  -5.002  0.00  0.00             N</span>
<span class="go">ATOM      2   H1 MET     1     -11.310  14.080  -4.226  0.00  0.00             H</span>
<span class="go">ATOM      3   H2 MET     1     -11.333  14.344  -5.825  0.00  0.00             H</span>
<span class="go">ATOM      4   H3 MET     1     -10.387  15.316  -4.776  0.00  0.00             H</span>
<span class="go">ATOM      5   CA MET     1      -9.555  13.486  -5.166  0.00  0.00             C</span>
<span class="go">....</span>
</pre></div>
</div>
<p>Opening h5-Trajectory file</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/modelling/trajectory/h5-file/hgbp1_transition.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">[&lt;mfm.structure.structure.Structure at 0x1345d5d0&gt;,</span>
<span class="go">&lt;mfm.structure.structure.Structure at 0x1345d610&gt;,</span>
<span class="go">&lt;mfm.structure.structure.Structure at 0x132d2230&gt;]</span>
</pre></div>
</div>
<p>Name of the trajectory</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">t</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;/ sample_data/ structure/ sample_data/ structure/ T4L_Trajectory.h5&#39;</span>
</pre></div>
</div>
<p>initialize with mdtraj.Trajectory</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/modelling/trajectory/h5-file/hgbp1_transition.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">mdtraj</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;test.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="mfm.structure.trajectory.TrajectoryFile.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>xyz</em>, <em>update_rmsd=True</em>, <em>energy=inf</em>, <em>energy_fret=inf</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/trajectory.html#TrajectoryFile.append"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a structure of type :py::class`mfm.Structure` to the trajectory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>structure</strong> &#8211; Structure</li>
<li><strong>update_rmsd</strong> &#8211; bool</li>
<li><strong>energy</strong> &#8211; float
Energy of the system</li>
<li><strong>energy_fret</strong> &#8211; float
Energy of the FRET-potential</li>
<li><strong>verbose</strong> &#8211; bool
By default True. If True energy, energy_fret, RMSD and dRMSD are printed to std-out.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/structure/2807_8_9_b.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">&lt;mdtraj.Trajectory with 92 frames, 2495 atoms, 164 residues, without unitcells at 0x11762b70&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&lt;mdtraj.Trajectory with 93 frames, 2495 atoms, 164 residues, without unitcells at 0x11762b70&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="mfm.structure.trajectory.TrajectoryFile.average">
<code class="descname">average</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.average" title="Permalink to this definition">¶</a></dt>
<dd><p>The average structure (<a class="reference internal" href="#mfm.structure.Structure" title="mfm.structure.Structure"><code class="xref py py-class docutils literal"><span class="pre">Structure</span></code></a>) of the trajectory</p>
</dd></dl>

<dl class="attribute">
<dt id="mfm.structure.trajectory.TrajectoryFile.directory">
<code class="descname">directory</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Directory in which the filename of the trajectory is located in</p>
</dd></dl>

<dl class="attribute">
<dt id="mfm.structure.trajectory.TrajectoryFile.filename">
<code class="descname">filename</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.filename" title="Permalink to this definition">¶</a></dt>
<dd><p>The filename of the trajectory</p>
</dd></dl>

<dl class="attribute">
<dt id="mfm.structure.trajectory.TrajectoryFile.invert">
<code class="descname">invert</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.invert" title="Permalink to this definition">¶</a></dt>
<dd><p>If True the oder of the trajectory is inverted (by default False)</p>
</dd></dl>

<dl class="attribute">
<dt id="mfm.structure.trajectory.TrajectoryFile.name">
<code class="descname">name</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the trajectory composed of the directory and the filename</p>
</dd></dl>

<dl class="attribute">
<dt id="mfm.structure.trajectory.TrajectoryFile.reference">
<code class="descname">reference</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.reference" title="Permalink to this definition">¶</a></dt>
<dd><p>The reference structure used for RMSD-calculation. This cannot be set directly but has to be set via the number
of the reference state :py:attribute`.rmsd_ref_state`</p>
</dd></dl>

<dl class="attribute">
<dt id="mfm.structure.trajectory.TrajectoryFile.rmsd_ref_state">
<code class="descname">rmsd_ref_state</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.rmsd_ref_state" title="Permalink to this definition">¶</a></dt>
<dd><p>The index (frame number) of the reference state used for the RMSD calculation</p>
</dd></dl>

<dl class="attribute">
<dt id="mfm.structure.trajectory.TrajectoryFile.values">
<code class="descname">values</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.values" title="Permalink to this definition">¶</a></dt>
<dd><p>A 2D-numpy array containing the RMSD, dRMSD, energy and the chi2 values of the trajectory</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/structure/2807_8_9_b.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">&lt;mdtraj.Trajectory with 92 frames, 2495 atoms, 164 residues, without unitcells at 0x117f3b70&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">values</span>
<span class="go">array([], shape=(4, 0), dtype=float64)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">inf     inf     0.0000  0.6678</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">inf     inf     0.0000  0.0000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">values</span>
<span class="go">array([ [  5.96507968e-09,   5.96508192e-09],</span>
<span class="go">        [  6.67834069e-01,   5.96507944e-09],</span>
<span class="go">        [             inf,              inf],</span>
<span class="go">        [             inf,              inf]])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="fret-positioning-system">
<h2>FRET-Positioning-System<a class="headerlink" href="#fret-positioning-system" title="Permalink to this headline">¶</a></h2>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016, Thomas Peulen.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>