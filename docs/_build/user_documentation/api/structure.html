<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Structural-Models &#8212; ChiSurf  documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          ChiSurf</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use_cases.html">Use cases</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Structural-Models</a><ul>
<li><a class="reference internal" href="#module-mfm.structure.structure">Structure</a></li>
<li><a class="reference internal" href="#module-mfm.structure.trajectory">Trajectory</a></li>
<li><a class="reference internal" href="#fret-positioning-system">FRET-Positioning-System</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/user_documentation/api/structure.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Structural-Models</a><ul>
<li><a class="reference internal" href="#module-mfm.structure.structure">Structure</a></li>
<li><a class="reference internal" href="#module-mfm.structure.trajectory">Trajectory</a></li>
<li><a class="reference internal" href="#fret-positioning-system">FRET-Positioning-System</a></li>
</ul>
</li>
</ul>

<div id="sourcelink">
  <a href="../../_sources/user_documentation/api/structure.rst.txt"
     rel="nofollow">Source</a>
</div>
<form action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="module-mfm.structure">
<span id="structural-models"></span><h1>Structural-Models<a class="headerlink" href="#module-mfm.structure" title="Permalink to this headline">¶</a></h1>
<p>The structure module contains most functions and classes to handle structural models of proteins. It contains basically
two submodules:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#module-mfm.structure.structure" title="mfm.structure.structure"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mfm.structure.structure</span></code></a></p></li>
<li><p><a class="reference internal" href="#module-mfm.structure.trajectory" title="mfm.structure.trajectory"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mfm.structure.trajectory</span></code></a></p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">mfm.potential</span></code></p></li>
</ol>
<p>The module <code class="xref py py-mod docutils literal notranslate"><span class="pre">mfm.potential</span></code> provides a set of potentials. The module <a class="reference internal" href="#module-mfm.structure.structure" title="mfm.structure.structure"><code class="xref py py-mod docutils literal notranslate"><span class="pre">mfm.structure.structure</span></code></a>
provides a set of functions and classes to work with structures and trajectories.</p>
<div class="section" id="module-mfm.structure.structure">
<span id="structure"></span><h2>Structure<a class="headerlink" href="#module-mfm.structure.structure" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="mfm.structure.structure.Structure">
<em class="property">class </em><code class="sig-prename descclassname">mfm.structure.structure.</code><code class="sig-name descname">Structure</code><span class="sig-paren">(</span><em class="sig-param">p_object</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#Structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.Structure" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm.structure</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">Structure</span><span class="p">(</span><span class="s1">&#39;1dg3&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">======================================</span>
<span class="go">Filename: ../sample_data/structure/HM_1FN5_Naming.pdb</span>
<span class="go">Path: ../sample_data/structure</span>
<span class="go">Number of atoms: 9316</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">structure</span><span class="p">)[:</span><span class="mi">324</span><span class="p">])</span>
<span class="go">ATOM      1    N HIS A   6     -18.863  20.262  33.465  0.00  0.00             N</span>
<span class="go">ATOM      2   CA HIS A   6     -17.949  21.401  33.768  0.00  0.00             C</span>
<span class="go">ATOM      3    C HIS A   6     -18.327  22.599  32.897  0.00  0.00             C</span>
<span class="go">ATOM      4    O HIS A   6     -19.507  22.812  32.614  0.00  0.00             O</span>
</pre></div>
</div>
<p>Write structure to disk</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;test_out.pdb&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Radius of gyration</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span><span class="o">.</span><span class="n">radius_gyration</span>
<span class="go">50.31556120901161</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>max_atom_residue</strong><span class="classifier">int</span></dt><dd><p>Maximum atoms per residue. The maximum atoms per residue have to be limited, because of the
residue/atom lookup tables. By default maximum 16 atoms per residue are allowed.</p>
</dd>
<dt><a class="reference internal" href="#mfm.structure.structure.Structure.xyz" title="mfm.structure.structure.Structure.xyz"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xyz</span></code></a><span class="classifier">numpy-array</span></dt><dd><p>Cartesian coordinates of all atoms</p>
</dd>
<dt><strong>residue_names: list</strong></dt><dd><p>residue names is a list of the residue-names. Here the residues are represented by the same
name as the initial PDB-file, usually 3-letter amino-acid code. The residue_names attribute
may look like: [‘TYR’, ‘HIS’, ‘ARG’]</p>
</dd>
<dt><strong>n_atoms: int</strong></dt><dd><p>The number of atoms</p>
</dd>
<dt><strong>b_factos: array</strong></dt><dd><p>An array of the b-factors.</p>
</dd>
<dt><strong>radius_gyration: float</strong></dt><dd><p>The attribute radius_gyration returns the radius of gyration of the structure. The radius of gyration
is given by: rG = (np.sqrt((coord - rM) ** 2).sum(axis=1)).mean()
Here rM are the mean coordinates of the structure.</p>
</dd>
<dt><strong>:param filename: str</strong></dt><dd><p>Path to the pdb file on disk</p>
</dd>
<dt><strong>:param make_coarse: bool</strong></dt><dd><p>Conversion to coarse representation using internal coordinates. Side-chains are
not considered. The Cbeta-atoms is moved to center of mass of the side-chain.</p>
</dd>
<dt><strong>:param verbose: bool</strong></dt><dd><p>print output to stdout</p>
</dd>
<dt><strong>:param auto_update: bool</strong></dt><dd><p>update cartesian-coordiantes automatically after change of internal coordinates.
This only applies for coarse-grained coordinates</p>
</dd>
</dl>
</dd>
</dl>
<dl class="method">
<dt id="mfm.structure.structure.Structure.append_potential">
<code class="sig-name descname">append_potential</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">function</em>, <em class="sig-param">kwargs={}</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#Structure.append_potential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.Structure.append_potential" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> – </p></li>
<li><p><strong>kwargs</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm.structure</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">Structure</span><span class="p">(</span><span class="s1">&#39;./sample_data/modelling/pdb_files/hGBP1_closed.pdb&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span><span class="o">.</span><span class="n">append_potential</span><span class="p">(</span><span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">potential</span><span class="o">.</span><span class="n">lennard_jones_calpha</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span><span class="o">.</span><span class="n">energy</span>
<span class="go">-948.0396693387753</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span><span class="o">.</span><span class="n">append_potential</span><span class="p">(</span><span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">potential</span><span class="o">.</span><span class="n">internal_potential_calpha</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{})</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.structure.Structure.b_factors">
<em class="property">property </em><code class="sig-name descname">b_factors</code><a class="headerlink" href="#mfm.structure.structure.Structure.b_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>B-factors of the C-alpha atoms</p>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.structure.Structure.get_atom_index">
<code class="sig-name descname">get_atom_index</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">atom_names</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#Structure.get_atom_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.Structure.get_atom_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the indeces with a given atom name</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_names</strong> – list of string of the atom-names</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of integers the indices with a given atom name</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.structure.Structure.vdw">
<em class="property">property </em><code class="sig-name descname">vdw</code><a class="headerlink" href="#mfm.structure.structure.Structure.vdw" title="Permalink to this definition">¶</a></dt>
<dd><p>Van der Waals radii of all atoms</p>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.structure.Structure.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#Structure.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.Structure.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the structure to a filename. By default it uses PDB files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – The filename</p></li>
<li><p><strong>append_model</strong> – bool
If True the structure is appended to the filename as a new model otherwise the file is overwritten</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.structure.Structure.xyz">
<em class="property">property </em><code class="sig-name descname">xyz</code><a class="headerlink" href="#mfm.structure.structure.Structure.xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian coordinates of all atoms</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.average">
<code class="sig-prename descclassname">mfm.structure.structure.</code><code class="sig-name descname">average</code><span class="sig-paren">(</span><em class="sig-param">structures: 'List[mfm.structure.structure.Structure]'</em>, <em class="sig-param">weights=None</em>, <em class="sig-param">write=True</em>, <em class="sig-param">filename=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#average"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.average" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates weighted average of a list of structures.
saves to filename if write is True
if filename not provided makes new “average.pdb” file in temp-folder
of the system</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/structure/2807_8_9_b.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">average</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg</span>
<span class="go">&lt;mfm.structure.structure.Structure at 0x117ff770&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg</span><span class="o">.</span><span class="n">labeling_file</span>
<span class="go">&#39;c:\users\peulen\appdata\local\temp\average.pdb&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.count_atoms">
<code class="sig-prename descclassname">mfm.structure.structure.</code><code class="sig-name descname">count_atoms</code><span class="sig-paren">(</span><em class="sig-param">topology_dict</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#count_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.count_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of atoms in a topology dict</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>topology_dict</strong> – dict
a topology of a structure as python dict (as described by MDTraj)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.find_best">
<code class="sig-prename descclassname">mfm.structure.structure.</code><code class="sig-name descname">find_best</code><span class="sig-paren">(</span><em class="sig-param">target</em>, <em class="sig-param">reference</em>, <em class="sig-param">atom_indices=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#find_best"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.find_best" title="Permalink to this definition">¶</a></dt>
<dd><p>target and reference are both of type mdtraj.Trajectory
reference is of length 1, target of arbitrary length</p>
<p>returns a Structure object and the index within the trajectory</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/structure/2807_8_9_b.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">find_best</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">mdtraj</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">mdtraj</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">(2, &lt;mdtraj.Trajectory with 1 frames, 2495 atoms, 164 residues, without unitcells at 0x13570b30&gt;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.get_atom_index_by_name">
<code class="sig-prename descclassname">mfm.structure.structure.</code><code class="sig-name descname">get_atom_index_by_name</code><span class="sig-paren">(</span><em class="sig-param">pdb</em>, <em class="sig-param">atom_names</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#get_atom_index_by_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.get_atom_index_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns atom-indices given a an atomic name as list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdb</strong> – </p></li>
<li><p><strong>atom_names</strong> – list of strings</p></li>
<li><p><strong>verbose</strong> – bool</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb_file</span> <span class="o">=</span> <span class="s1">&#39;./sample_data/model/hgbp1/hGBP1_closed.pdb&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">pdb_file</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Opening PDB-file: ./sample_data/model/hgbp1/hGBP1_closed.pdb</span>
<span class="go">======================================</span>
<span class="go">Filename: ./sample_data/model/hgbp1/hGBP1_closed.pdb</span>
<span class="go">Path: ./sample_data/model/hgbp1</span>
<span class="go">Number of atoms: 9316</span>
<span class="go">--------------------------</span>
</pre></div>
</div>
<p>Get all atom-indices of all C-alphas in the TRY</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mfm</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">selection2atom_idx</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;TRP&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]})</span>
<span class="go">OrderedDict([(&#39;TRP&#39;, array([1114, 1155, 1651, 2690], dtype=uint32))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mfm</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">selection2atom_idx</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;TRP&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">],</span> <span class="s1">&#39;TYR&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]})</span>
<span class="go">OrderedDict([(&#39;TRP&#39;, array([1114, 1155, 1651, 2690], dtype=uint32)), (&#39;TYR&#39;, array([ 608,  707, 1879,</span>
<span class="go">2107, 2128, 3013, 3067, 4231, 4667, 5169, 6651, 6733, 7005, 7026, 7289, 8272], dtype=uint32))])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.get_atom_index_of_residue_types">
<code class="sig-prename descclassname">mfm.structure.structure.</code><code class="sig-name descname">get_atom_index_of_residue_types</code><span class="sig-paren">(</span><em class="sig-param">pdb</em>, <em class="sig-param">res_types</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#get_atom_index_of_residue_types"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.get_atom_index_of_residue_types" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns atom-indices given a selection of residue types and atom names as OrderedDict.
The selection is based on dictionaries. For each residue-type only the atoms within a
list are selected (see example)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdb</strong> – </p></li>
<li><p><strong>res_types</strong> – dict</p></li>
<li><p><strong>verbose</strong> – bool</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>OrderedDict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb_file</span> <span class="o">=</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">PDB</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">pdb_file</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Opening PDB-file: ./sample_data/model/hgbp1/hGBP1_closed.pdb</span>
<span class="go">======================================</span>
<span class="go">Filename: ./sample_data/model/hgbp1/hGBP1_closed.pdb</span>
<span class="go">Path: ./sample_data/model/hgbp1</span>
<span class="go">Number of atoms: 9316</span>
<span class="go">--------------------------</span>
</pre></div>
</div>
<p>Get all atom-indices of all C-alphas in the TRY</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mfm</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">selection2atom_idx</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;TRP&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]})</span>
<span class="go">OrderedDict([(&#39;TRP&#39;, array([1114, 1155, 1651, 2690], dtype=uint32))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mfm</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">selection2atom_idx</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;TRP&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">],</span> <span class="s1">&#39;TYR&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]})</span>
<span class="go">OrderedDict([(&#39;TRP&#39;, array([1114, 1155, 1651, 2690], dtype=uint32)), (&#39;TYR&#39;, array([ 608,  707, 1879,</span>
<span class="go">2107, 2128, 3013, 3067, 4231, 4667, 5169, 6651, 6733, 7005, 7026, 7289, 8272], dtype=uint32))])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.get_coordinates_of_residues">
<code class="sig-prename descclassname">mfm.structure.structure.</code><code class="sig-name descname">get_coordinates_of_residues</code><span class="sig-paren">(</span><em class="sig-param">atoms</em>, <em class="sig-param">quencher</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#get_coordinates_of_residues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.get_coordinates_of_residues" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns coordinates and indices of all atoms of certain residue type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdb</strong> – numpy-array
numpy-array as returned by PDB.read</p></li>
<li><p><strong>quencher</strong> – dict</p></li>
<li><p><strong>verbose</strong> – bool</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb_file</span> <span class="o">=</span> <span class="n">models</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">pdb_file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">pdb_file</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Opening PDB-file: ./sample_data/model/hgbp1/hGBP1_closed.pdb</span>
<span class="go">======================================</span>
<span class="go">Filename: ./sample_data/model/hgbp1/hGBP1_closed.pdb</span>
<span class="go">Path: ./sample_data/model/hgbp1</span>
<span class="go">Number of atoms: 9316</span>
<span class="go">--------------------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mfm</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">dye_diffusion</span><span class="o">.</span><span class="n">get_quencher_coordinates</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;TRP&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CA&#39;</span><span class="p">]})</span>
<span class="go">OrderedDict([(&#39;TRP&#39;, array([[ 74.783,  -7.884,  18.04 ],</span>
<span class="go">    [ 71.558, -13.346,  15.126],</span>
<span class="go">   [ 70.873,   4.983,  23.373],</span>
<span class="go">   [ 61.507,  -8.977,  33.237]]))])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.make_dictionary_of_atoms">
<code class="sig-prename descclassname">mfm.structure.structure.</code><code class="sig-name descname">make_dictionary_of_atoms</code><span class="sig-paren">(</span><em class="sig-param">atoms</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#make_dictionary_of_atoms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.make_dictionary_of_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Organizes atoms residue-wise in an OrderedDict</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atoms</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>OrderedDict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.onRMSF">
<code class="sig-prename descclassname">mfm.structure.structure.</code><code class="sig-name descname">onRMSF</code><span class="sig-paren">(</span><em class="sig-param">structures</em>, <em class="sig-param">selectedNbrs: 'List[int]'</em>, <em class="sig-param">atomName: 'str' = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#onRMSF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.onRMSF" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the root mean square deviation with respect to the average structure
for a given set of structures. The structures do not have to be aligned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structures</strong> – </p></li>
<li><p><strong>selectedNbrs</strong> – </p></li>
<li><p><strong>atomName</strong> – </p></li>
<li><p><strong>weights</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.rmsd">
<code class="sig-prename descclassname">mfm.structure.structure.</code><code class="sig-name descname">rmsd</code><span class="sig-paren">(</span><em class="sig-param">structure_a: 'mfm.structure.structure.Structure'</em>, <em class="sig-param">structure_b: 'mfm.structure.structure.Structure'</em>, <em class="sig-param">atom_indices=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#rmsd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.rmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the root-mean-squared deviation between two structures. In case the indices of the atoms are
provided only the, respective atoms are used to calculate the RMSD.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure_a</strong> – </p></li>
<li><p><strong>structure_b</strong> – </p></li>
<li><p><strong>atom_indices</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>float, root-mean-squared deviation</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/structure/2807_8_9_b.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span>
<span class="go">&lt;mfm.structure.structure.Structure at 0x135f3ad0&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span>
<span class="go">&lt;mfm.structure.structure.Structure at 0x1348fbb0&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rmsd</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
<span class="go">6.960082250440536</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.sequence">
<code class="sig-prename descclassname">mfm.structure.structure.</code><code class="sig-name descname">sequence</code><span class="sig-paren">(</span><em class="sig-param">structure_obj</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#sequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dictionary of sequences keyed to chain and type of sequence used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>structure_obj</strong> – Structure</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mfm.structure.structure.super_impose">
<code class="sig-prename descclassname">mfm.structure.structure.</code><code class="sig-name descname">super_impose</code><span class="sig-paren">(</span><em class="sig-param">structure_ref: 'mfm.structure.structure.Structure'</em>, <em class="sig-param">structure_align: 'mfm.structure.structure.Structure'</em>, <em class="sig-param">atom_indices=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/structure.html#super_impose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.structure.super_impose" title="Permalink to this definition">¶</a></dt>
<dd><p>Superimpose two structures</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure_ref</strong> – </p></li>
<li><p><strong>structure_align</strong> – </p></li>
<li><p><strong>atom_indices</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-mfm.structure.trajectory">
<span id="trajectory"></span><h2>Trajectory<a class="headerlink" href="#module-mfm.structure.trajectory" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="mfm.structure.trajectory.TrajectoryFile">
<em class="property">class </em><code class="sig-prename descclassname">mfm.structure.trajectory.</code><code class="sig-name descname">TrajectoryFile</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">filename: Optional[str] = None</em>, <em class="sig-param">make_coarse: bool = False</em>, <em class="sig-param">rmsd_ref_state: int = 0</em>, <em class="sig-param">stride: int = 1</em>, <em class="sig-param">inverse_trajectory: bool = False</em>, <em class="sig-param">center: bool = False</em>, <em class="sig-param">verbose: bool = False</em>, <em class="sig-param">atom_indices: Optional[List[int]] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/trajectory.html#TrajectoryFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Creates an Trajectory of mfm.structure.Structures given a HDF5-File using mdtraj.HDF5TrajectoryFile</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>structure</strong><span class="classifier">string / mfm.structure.Structure</span></dt><dd><blockquote>
<div><p>determines the topology
is either a string containing the filename of a PDB-File or an instance of mfm.structure.Structure()
Obligatory in write mode, not needed in reading mode</p>
</div></blockquote>
<dl class="simple">
<dt>filename_hdf<span class="classifier">string</span></dt><dd><p>the filename of the HDF5-file</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Other Parameters</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>verbose</strong><span class="classifier">bool</span></dt><dd><dl class="simple">
<dt>stride<span class="classifier">int, default=None</span></dt><dd><p>Only read every stride-th frame.</p>
</dd>
<dt>frame<span class="classifier">integer or None</span></dt><dd><p>If frame is an integer only the frame number provided by the integer is loaded otherwise the whole trajectory
is loaded.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<dl>
<dt>import mfm.structure    &gt;&gt;&gt; import mfm</dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">Structure</span><span class="p">(</span><span class="s1">&#39;./sample_data/modelling/trajectory/h5-file/T4L_Topology.pdb&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">make_coarse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/modelling/trajectory/h5-file/hgbp1_transition.h5&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;mfm.structure.structure.mfm.structure.Structure at 0x11f34e10&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">ATOM      1    N MET     1     -10.750  14.401  -5.002  0.00  0.00             N</span>
<span class="go">ATOM      2   H1 MET     1     -11.310  14.080  -4.226  0.00  0.00             H</span>
<span class="go">ATOM      3   H2 MET     1     -11.333  14.344  -5.825  0.00  0.00             H</span>
<span class="go">ATOM      4   H3 MET     1     -10.387  15.316  -4.776  0.00  0.00             H</span>
<span class="go">ATOM      5   CA MET     1      -9.555  13.486  -5.166  0.00  0.00             C</span>
<span class="go">....</span>
</pre></div>
</div>
<p>Opening h5-Trajectory file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/modelling/trajectory/h5-file/hgbp1_transition.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="go">[&lt;mfm.structure.structure.mfm.structure.Structure at 0x1345d5d0&gt;,</span>
<span class="go">&lt;mfm.structure.structure.mfm.structure.Structure at 0x1345d610&gt;,</span>
<span class="go">&lt;mfm.structure.structure.mfm.structure.Structure at 0x132d2230&gt;]</span>
</pre></div>
</div>
<p>Name of the trajectory</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">&#39;/ sample_data/ structure/ sample_data/ structure/ T4L_Trajectory.h5&#39;</span>
</pre></div>
</div>
<p>initialize with mdtraj.Trajectory</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/modelling/trajectory/h5-file/hgbp1_transition.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">mdtraj</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;test.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="mfm.structure.trajectory.TrajectoryFile.append">
<code class="sig-name descname">append</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">xyz</em>, <em class="sig-param">update_rmsd: 'bool' = True</em>, <em class="sig-param">energy: 'float' = inf</em>, <em class="sig-param">energy_fret: 'float' = inf</em>, <em class="sig-param">verbose: 'bool' = True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/trajectory.html#TrajectoryFile.append"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Append a structure of type :py::class`mfm.mfm.structure.Structure` to the trajectory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> – mfm.structure.Structure</p></li>
<li><p><strong>update_rmsd</strong> – bool</p></li>
<li><p><strong>energy</strong> – float
Energy of the system</p></li>
<li><p><strong>energy_fret</strong> – float
Energy of the FRET-potential</p></li>
<li><p><strong>verbose</strong> – bool
By default True. If True energy, energy_fret, RMSD and dRMSD are printed to std-out.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/structure/2807_8_9_b.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">&lt;mdtraj.Trajectory with 92 frames, 2495 atoms, 164 residues, without unitcells at 0x11762b70&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&lt;mdtraj.Trajectory with 93 frames, 2495 atoms, 164 residues, without unitcells at 0x11762b70&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.trajectory.TrajectoryFile.average">
<em class="property">property </em><code class="sig-name descname">average</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.average" title="Permalink to this definition">¶</a></dt>
<dd><p>The average structure (<code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code>) of the trajectory</p>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.trajectory.TrajectoryFile.directory">
<em class="property">property </em><code class="sig-name descname">directory</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Directory in which the filename of the trajectory is located in</p>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.trajectory.TrajectoryFile.filename">
<em class="property">property </em><code class="sig-name descname">filename</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.filename" title="Permalink to this definition">¶</a></dt>
<dd><p>The filename of the trajectory</p>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.trajectory.TrajectoryFile.invert">
<em class="property">property </em><code class="sig-name descname">invert</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.invert" title="Permalink to this definition">¶</a></dt>
<dd><p>If True the oder of the trajectory is inverted (by default False)</p>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.trajectory.TrajectoryFile.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the trajectory composed of the directory and the filename</p>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.trajectory.TrajectoryFile.reference">
<em class="property">property </em><code class="sig-name descname">reference</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.reference" title="Permalink to this definition">¶</a></dt>
<dd><p>The reference structure used for RMSD-calculation. This cannot be set directly but has to be set via the number
of the reference state :py:attribute`.rmsd_ref_state`</p>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.trajectory.TrajectoryFile.rmsd_ref_state">
<em class="property">property </em><code class="sig-name descname">rmsd_ref_state</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.rmsd_ref_state" title="Permalink to this definition">¶</a></dt>
<dd><p>The index (frame number) of the reference state used for the RMSD calculation</p>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.trajectory.TrajectoryFile.slice">
<code class="sig-name descname">slice</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">key</em>, <em class="sig-param">copy=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/mfm/structure/trajectory.html#TrajectoryFile.slice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Slice trajectory, by extracting one or more frames into a separate object</p>
<p>This method can also be called using index bracket notation, i.e
<cite>traj[1] == traj.slice(1)</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>key</strong><span class="classifier">{int, np.ndarray, slice}</span></dt><dd><p>The slice to take. Can be either an int, a list of ints, or a slice
object.</p>
</dd>
<dt><strong>copy</strong><span class="classifier">bool, default=True</span></dt><dd><p>Copy the arrays after slicing. If you set this to false, then if
you modify a slice, you’ll modify the original array since they
point to the same data.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mfm.structure.trajectory.TrajectoryFile.values">
<em class="property">property </em><code class="sig-name descname">values</code><a class="headerlink" href="#mfm.structure.trajectory.TrajectoryFile.values" title="Permalink to this definition">¶</a></dt>
<dd><p>A 2D-numpy array containing the RMSD, dRMSD, energy and the chi2 values of the trajectory</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mfm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">TrajectoryFile</span><span class="p">(</span><span class="s1">&#39;./sample_data/structure/2807_8_9_b.h5&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">&lt;mdtraj.Trajectory with 92 frames, 2495 atoms, 164 residues, without unitcells at 0x117f3b70&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">values</span>
<span class="go">array([], shape=(4, 0), dtype=float64)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">inf     inf     0.0000  0.6678</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">inf     inf     0.0000  0.0000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">values</span>
<span class="go">array([ [  5.96507968e-09,   5.96508192e-09],</span>
<span class="go">        [  6.67834069e-01,   5.96507944e-09],</span>
<span class="go">        [             inf,              inf],</span>
<span class="go">        [             inf,              inf]])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="fret-positioning-system">
<h2>FRET-Positioning-System<a class="headerlink" href="#fret-positioning-system" title="Permalink to this headline">¶</a></h2>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016, Thomas Peulen.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>