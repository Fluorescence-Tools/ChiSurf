<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>mfm.tools.fret_lines &mdash; ChiSurf 0.0.5 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-3.3.6/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-3.3.6/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.0.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="ChiSurf 0.0.5 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html">
          ChiSurf</a>
        <span class="navbar-text navbar-version pull-left"><b>0.0.5</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../user_documentation/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_documentation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_documentation/tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_documentation/tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_documentation/use_cases.html">Use cases</a></li>
</ul>
<ul class="simple">
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <h1>Source code for mfm.tools.fret_lines</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PyQt4</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">uic</span>
<span class="kn">from</span> <span class="nn">guiqwt.plot</span> <span class="kn">import</span> <span class="n">CurveDialog</span>
<span class="kn">from</span> <span class="nn">guiqwt.builder</span> <span class="kn">import</span> <span class="n">make</span>

<span class="kn">import</span> <span class="nn">mfm</span>
<span class="kn">import</span> <span class="nn">mfm.fitting.models.tcspc</span> <span class="kn">as</span> <span class="nn">fret_models</span>
<span class="kn">from</span> <span class="nn">mfm.fitting.models.tcspc.fret</span> <span class="kn">import</span> <span class="n">WormLikeChainModelWidget</span>


<div class="viewcode-block" id="FRETLineGenerator"><a class="viewcode-back" href="../../../api/mfm.tools.html#mfm.tools.fret_lines.FRETLineGenerator">[docs]</a><span class="k">class</span> <span class="nc">FRETLineGenerator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Calculates FRET-lines for arbitrary models</span>

<span class="sd">    :param kwargs:</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    parameter_name : str</span>
<span class="sd">        The parameter name of the variable which is used to generate the FRET-line.</span>
<span class="sd">    fret_species_averaged_lifetime : float</span>
<span class="sd">        The species averages lifetime of the model.</span>
<span class="sd">    fret_fluorescence_averaged_lifetime : float</span>
<span class="sd">        The fluorescence averaged lifetime of the model.</span>
<span class="sd">    donor_species_averaged_lifetime : float</span>
<span class="sd">        The species averaged lifetime of the donor of the model.</span>
<span class="sd">    transfer_efficiency : float</span>
<span class="sd">        The transfer efficiency of the model.</span>
<span class="sd">    parameter_values : array</span>
<span class="sd">        The parameter values used for the calculation of the FRET-line</span>
<span class="sd">    parameter_range : array</span>
<span class="sd">        Start and stop value of the parameter range used for calculation of the FRET-line</span>
<span class="sd">    n_points : int</span>
<span class="sd">        The number of points used to calculate the FRET-line</span>
<span class="sd">    model : LifetimeModel</span>
<span class="sd">        The TCSPC-model used to calculate the FRET-line</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    calc()</span>
<span class="sd">        Recaclulates the FRET-line</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import mfm.fitting.models.tcspc as m</span>
<span class="sd">    &gt;&gt;&gt; from mfm.tools.fret_lines import FRETLineGenerator</span>
<span class="sd">    &gt;&gt;&gt; R1 = 80</span>
<span class="sd">    &gt;&gt;&gt; R2 = 35</span>
<span class="sd">    &gt;&gt;&gt; fl = FRETLineGenerator()</span>
<span class="sd">    &gt;&gt;&gt; fl.model = m.GaussianModel</span>
<span class="sd">    &gt;&gt;&gt; fl.model.parameter_dict[&#39;DOnly&#39;].value = 0.0</span>

<span class="sd">    Adding donor lifetimes</span>

<span class="sd">    &gt;&gt;&gt; fl.model.donors.append(1.0, 4)</span>
<span class="sd">    &gt;&gt;&gt; fl.model.donors.append(1.0, 2)</span>

<span class="sd">    Add a new Gaussian distance</span>

<span class="sd">    &gt;&gt;&gt; fl.model.append(55.0, 10, 1.0)</span>

<span class="sd">    The fluorescence/species averaged lifetime of the model is obtained by</span>

<span class="sd">    &gt;&gt;&gt; fl.fret_fluorescence_averaged_lifetime</span>
<span class="sd">    2.5600809847436152</span>
<span class="sd">    &gt;&gt;&gt; fl.fret_species_averaged_lifetime</span>
<span class="sd">    2.2459102590812412</span>

<span class="sd">    The model parameters can be changed using their names by the *parameter_dict*</span>

<span class="sd">    &gt;&gt;&gt; fl.model.parameter_dict[&#39;R(G,1)&#39;].value = 40.0</span>
<span class="sd">    &gt;&gt;&gt; fl.model.parameter_dict[&#39;s(G,1)&#39;].value = 8.0</span>

<span class="sd">    Set the name of the parameter changes to calculate the distributions used for the</span>
<span class="sd">    FRET-lines. Here a more common parameter as the donor-acceptor separation distance</span>
<span class="sd">    is used to generate a static FRET-line.</span>

<span class="sd">    &gt;&gt;&gt; fl.parameter_name = &#39;R(G,1)&#39;</span>

<span class="sd">    Set the range in which this parameter is modified to generate the line and calculate the FRET-line</span>

<span class="sd">    &gt;&gt;&gt; fl.parameter_range = 0.1, 1000</span>
<span class="sd">    &gt;&gt;&gt; fl.calc()</span>

<span class="sd">    By adding a second Gaussian and changing the species fraction you can also generate a dynamic-FRET line</span>

<span class="sd">    .. plot:: plots/fret-lines.py</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;verbose&#39;</span><span class="p">,</span> <span class="n">mfm</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_polynomial_degree</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;polynomial_degree&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantum_yield_donor</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;quantum_yield_donor&#39;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantum_yield_acceptor</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;quantum_yield_acceptor&#39;</span><span class="p">,</span> <span class="mf">0.32</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_range</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;range&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_points</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;n_points&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parameter_name&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_t_max</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;t_max&#39;</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dt</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_points</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">curve</span><span class="o">.</span><span class="n">DataCurve</span><span class="p">(</span><span class="n">setup</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_points</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_points</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_points</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_points</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_points</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">mfm</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">tcspc</span><span class="o">.</span><span class="n">tcspc</span><span class="o">.</span><span class="n">LifetimeModel</span><span class="p">(</span><span class="n">fit</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dt</span><span class="p">,</span> <span class="n">do_convolution</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transfer_efficiencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_points</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fluorescence_averaged_lifetimes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_points</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">conversion_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The fluorescence averaged lifetime vs. the species averaged lifetime</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluorescence_averaged_lifetimes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fret_species_averaged_lifetimes</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parameter_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The name of the parameter which is varies</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_name</span>

    <span class="nd">@parameter_name.setter</span>
    <span class="k">def</span> <span class="nf">parameter_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parameter_name</span> <span class="o">=</span> <span class="n">v</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fret_species_averaged_lifetime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The current species averages lifetime of the FRET sample xi * taui</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">species_averaged_lifetime</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fret_fluorescence_averaged_lifetime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The current fluorescence averaged lifetime of the FRET-sample = xi*taui**2 / species_averaged_lifetime</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">fret_fluorescence_averaged_lifetime</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">donor_species_averaged_lifetime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The current species averaged lifetime of the donor sample xi*taui</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="o">.</span><span class="n">lifetimes</span><span class="o">.</span><span class="n">species_averaged_lifetime</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">transfer_efficiency</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The current transfer efficency</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">fret_species_averaged_lifetime</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">donor_species_averaged_lifetime</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">polynomial_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The degree of the polynomial to approximate the conversion function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_polynomial_degree</span>

    <span class="nd">@polynomial_degree.setter</span>
    <span class="k">def</span> <span class="nf">polynomial_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The degree of the polynomial used to approximate the transfer function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_polynomial_degree</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">polynom_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A numpy array with polynomial coefficients approximating the tauX(tauF) conversion function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluorescence_averaged_lifetimes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fret_species_averaged_lifetimes</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">polynomial_degree</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">conversion_function_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A string used for plotting of the conversion function tauX(tauF)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polynom_coefficients</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">c</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">*x^</span><span class="si">%i</span><span class="s2">+&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">transfer_efficency_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used for instance for plotting in origin</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;1.0-(</span><span class="si">%s</span><span class="s2">)/(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conversion_function_string</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">donor_species_averaged_lifetime</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fdfa_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used for instance for plotting in origin</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantum_yield_donor</span>
        <span class="n">qa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantum_yield_acceptor</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2"> / ((</span><span class="si">%s</span><span class="s2">)/(</span><span class="si">%s</span><span class="s2">) - 1)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">qd</span><span class="p">,</span> <span class="n">qa</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">donor_species_averaged_lifetime</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">conversion_function_string</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">donor_lifetime_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The donor lifetime spectrum in form amplitude, lifetime, amplitude, lifetime</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">lifetimes</span><span class="o">.</span><span class="n">lifetime_spectrum</span>

    <span class="nd">@donor_lifetime_spectrum.setter</span>
    <span class="k">def</span> <span class="nf">donor_lifetime_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">lifetimes</span><span class="o">.</span><span class="n">lifetime_spectrum</span> <span class="o">=</span> <span class="n">v</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parameter_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The values the parameter as defined by :py:attr:`~mfm.fluorescence.fret_lines.FRETLineGenerator.parameter_name`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter_range</span>
        <span class="n">n_points</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_points</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">n_points</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parameter_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_range</span>

    <span class="nd">@parameter_range.setter</span>
    <span class="k">def</span> <span class="nf">parameter_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_range</span> <span class="o">=</span> <span class="n">v</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_points</span>

    <span class="nd">@n_points.setter</span>
    <span class="k">def</span> <span class="nf">n_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_points</span> <span class="o">=</span> <span class="n">v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span>

    <span class="nd">@model.setter</span>
    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">v</span><span class="p">(</span><span class="n">fit</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dt</span><span class="p">)</span>

<div class="viewcode-block" id="FRETLineGenerator.calc"><a class="viewcode-back" href="../../../api/mfm.tools.html#mfm.tools.fret_lines.FRETLineGenerator.calc">[docs]</a>    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">parameter_range</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">verbose</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;verbose&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parameter_name</span> <span class="o">=</span> <span class="n">parameter_name</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameter_range</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parameter_range</span> <span class="o">=</span> <span class="n">parameter_range</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Calculating FRET-Line&quot;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Using parameter: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter_name</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;In a range: </span><span class="si">%.1f</span><span class="s2"> .. </span><span class="si">%.1f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="n">transfer_efficiencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_points</span><span class="p">)</span>
        <span class="n">fluorescence_averaged_lifetimes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_points</span><span class="p">)</span>
        <span class="n">species_averaged_lifetimes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_points</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">parameter_value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter_values</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter_name</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">parameter_value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">update_model</span><span class="p">()</span>
            <span class="n">fluorescence_averaged_lifetimes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fret_fluorescence_averaged_lifetime</span>
            <span class="n">transfer_efficiencies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transfer_efficiency</span>
            <span class="n">species_averaged_lifetimes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fret_species_averaged_lifetime</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transfer_efficiencies</span> <span class="o">=</span> <span class="n">transfer_efficiencies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fret_species_averaged_lifetimes</span> <span class="o">=</span> <span class="n">species_averaged_lifetimes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fluorescence_averaged_lifetimes</span> <span class="o">=</span> <span class="n">fluorescence_averaged_lifetimes</span></div></div>


<div class="viewcode-block" id="StaticFRETLine"><a class="viewcode-back" href="../../../api/mfm.tools.html#mfm.tools.fret_lines.StaticFRETLine">[docs]</a><span class="k">class</span> <span class="nc">StaticFRETLine</span><span class="p">(</span><span class="n">FRETLineGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is used to calculate static-FRET lines of Gaussian distributed states.</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import mfm.tools.fret_lines as fret_lines</span>
<span class="sd">    &gt;&gt;&gt; s = fret_lines.StaticFRETLine()</span>
<span class="sd">    &gt;&gt;&gt; s.calc()</span>

<span class="sd">    Now lets look at the conversion function in comparison to a 1:1 relation</span>

<span class="sd">    &gt;&gt;&gt; import pylab as p</span>
<span class="sd">    &gt;&gt;&gt; x, y = s.conversion_function</span>
<span class="sd">    &gt;&gt;&gt; p.plot(x, y)</span>
<span class="sd">    &gt;&gt;&gt; p.plot(x, x)</span>
<span class="sd">    &gt;&gt;&gt; p.show()</span>

<span class="sd">    This class has basically only one relevant attribute that is the width of the DA-distance distirbution</span>
<span class="sd">    within a state.</span>

<span class="sd">    A conversion polynomial for plotting purposes can be obtained</span>

<span class="sd">    &gt;&gt;&gt; s.polynomial_string</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sigma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Width of the DA-distance distribution within the state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;s(G,1)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@sigma.setter</span>
    <span class="k">def</span> <span class="nf">sigma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;s(G,1)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">v</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">FRETLineGenerator</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">fret_models</span><span class="o">.</span><span class="n">GaussianModel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;DOnly&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">lifetimes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">40.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

<div class="viewcode-block" id="StaticFRETLine.calc"><a class="viewcode-back" href="../../../api/mfm.tools.html#mfm.tools.fret_lines.StaticFRETLine.calc">[docs]</a>    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">parameter_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;x(G,1)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">FRETLineGenerator</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter_name</span><span class="o">=</span><span class="s1">&#39;R(G,1)&#39;</span><span class="p">,</span> <span class="n">parameter_range</span><span class="o">=</span><span class="n">parameter_range</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;return_conversion&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conversion_function</span></div></div>


<div class="viewcode-block" id="DynamicFRETLine"><a class="viewcode-back" href="../../../api/mfm.tools.html#mfm.tools.fret_lines.DynamicFRETLine">[docs]</a><span class="k">class</span> <span class="nc">DynamicFRETLine</span><span class="p">(</span><span class="n">FRETLineGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a `convenience` class for a simple two-state Gaussian distance distribution</span>
<span class="sd">    dynamic FRET-model. Two Gaussian distance distributions are considered as limiting</span>
<span class="sd">    states and the dynamic-FRET line is calculated</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import mfm.tools.fret_lines as fret_lines</span>
<span class="sd">    &gt;&gt;&gt; d = fret_lines.DynamicFRETLine()</span>
<span class="sd">    &gt;&gt;&gt; print d.model</span>
<span class="sd">    Model: Gaussian-Donor</span>
<span class="sd">    Parameter       Value   Bounds  Fixed   Linke</span>
<span class="sd">    bg      0.0000  (None, None)    False   False</span>
<span class="sd">    sc      0.0000  (None, None)    False   False</span>
<span class="sd">    t(L,1)  4.0000  (None, None)    False   False</span>
<span class="sd">    x(L,1)  1.0000  (None, None)    False   False</span>
<span class="sd">    t0      4.1000  (None, None)    True    False</span>
<span class="sd">    R0      52.0000 (None, None)    True    False</span>
<span class="sd">    k2      0.6670  (None, None)    True    False</span>
<span class="sd">    DOnly   0.0000  (0.0, 1.0)      False   False</span>
<span class="sd">    x(G,1)  1.0000  (None, None)    False   False</span>
<span class="sd">    x(G,2)  1.0000  (None, None)    False   False</span>
<span class="sd">    s(G,1)  10.0000 (None, None)    False   False</span>
<span class="sd">    s(G,2)  10.0000 (None, None)    False   False</span>
<span class="sd">    R(G,1)  40.0000 (None, None)    False   False</span>
<span class="sd">    R(G,2)  80.0000 (None, None)    False   False</span>
<span class="sd">    dt      0.1000  (None, None)    True    False</span>
<span class="sd">    start   0.0000  (None, None)    True    False</span>
<span class="sd">    stop    20.0000 (None, None)    True    False</span>
<span class="sd">    rep     10.0000 (None, None)    True    False</span>
<span class="sd">    lb      0.0000  (None, None)    False   False</span>
<span class="sd">    ts      0.0000  (None, None)    False   False</span>
<span class="sd">    p0      1.0000  (None, None)    True    False</span>
<span class="sd">    r0      0.3800  (None, None)    False   False</span>
<span class="sd">    l1      0.0308  (None, None)    False   False</span>
<span class="sd">    l2      0.0368  (None, None)    False   False</span>
<span class="sd">    g       1.0000  (None, None)    False   False</span>

<span class="sd">    Set a new sigma</span>

<span class="sd">    &gt;&gt;&gt; d.sigma = 3.0</span>
<span class="sd">    &gt;&gt;&gt; print d.model</span>
<span class="sd">    Model: Gaussian-Donor</span>
<span class="sd">    Parameter       Value   Bounds  Fixed   Linke</span>
<span class="sd">    bg      0.0000  (None, None)    False   False</span>
<span class="sd">    sc      0.0000  (None, None)    False   False</span>
<span class="sd">    t(L,1)  4.0000  (None, None)    False   False</span>
<span class="sd">    x(L,1)  1.0000  (None, None)    False   False</span>
<span class="sd">    t0      4.1000  (None, None)    True    False</span>
<span class="sd">    R0      52.0000 (None, None)    True    False</span>
<span class="sd">    k2      0.6670  (None, None)    True    False</span>
<span class="sd">    DOnly   0.0000  (0.0, 1.0)      False   False</span>
<span class="sd">    x(G,1)  1.0000  (None, None)    False   False</span>
<span class="sd">    x(G,2)  1.0000  (None, None)    False   False</span>
<span class="sd">    s(G,1)  3.0000  (None, None)    False   False</span>
<span class="sd">    s(G,2)  3.0000  (None, None)    False   False</span>
<span class="sd">    R(G,1)  40.0000 (None, None)    False   False</span>
<span class="sd">    R(G,2)  80.0000 (None, None)    False   False</span>
<span class="sd">    dt      0.1000  (None, None)    True    False</span>
<span class="sd">    start   0.0000  (None, None)    True    False</span>
<span class="sd">    stop    20.0000 (None, None)    True    False</span>
<span class="sd">    rep     10.0000 (None, None)    True    False</span>
<span class="sd">    lb      0.0000  (None, None)    False   False</span>
<span class="sd">    ts      0.0000  (None, None)    False   False</span>
<span class="sd">    p0      1.0000  (None, None)    True    False</span>
<span class="sd">    r0      0.3800  (None, None)    False   False</span>
<span class="sd">    l1      0.0308  (None, None)    False   False</span>
<span class="sd">    l2      0.0368  (None, None)    False   False</span>
<span class="sd">    g       1.0000  (None, None)    False   False</span>

<span class="sd">    Calculate the FRET-line</span>

<span class="sd">    &gt;&gt;&gt; d.calc()</span>
<span class="sd">    Calculating FRET-Line</span>
<span class="sd">    Using parameter: x(G,2)</span>
<span class="sd">    In a range: 0.1 .. 100.0</span>

<span class="sd">    Plot the conversion function</span>

<span class="sd">    &gt;&gt;&gt; import pylab as p</span>
<span class="sd">    &gt;&gt;&gt; tauf, taux = d.conversion_function</span>
<span class="sd">    &gt;&gt;&gt; p.plot(tauf, taux)</span>
<span class="sd">    &gt;&gt;&gt; p.show()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">FRETLineGenerator</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">fret_models</span><span class="o">.</span><span class="n">gaussion</span><span class="o">.</span><span class="n">GaussianModel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;DOnly&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">lifetimes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">40.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">80.0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mean_distance_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mean distance of first limiting state 1</span>
<span class="sd">       &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;R(G,1)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@mean_distance_1.setter</span>
    <span class="k">def</span> <span class="nf">mean_distance_1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;R(G,1)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">v</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mean_distance_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mean distance of first limiting state 2</span>
<span class="sd">       &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;R(G,2)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@mean_distance_1.setter</span>
    <span class="k">def</span> <span class="nf">mean_distance_2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;R(G,2)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">v</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sigma_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Width of first limiting state</span>
<span class="sd">       &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;s(G,1)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@sigma_1.setter</span>
    <span class="k">def</span> <span class="nf">sigma_1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;s(G,1)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">v</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sigma_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Width of second limiting state</span>
<span class="sd">       &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;s(G,2)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@sigma_2.setter</span>
    <span class="k">def</span> <span class="nf">sigma_1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;s(G,2)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">v</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sigma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The width of both sigmas</span>
<span class="sd">       &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;s(G,1)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;s(G,2)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

    <span class="nd">@sigma.setter</span>
    <span class="k">def</span> <span class="nf">sigma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;s(G,1)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;s(G,2)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;s(G,1)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">v</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;s(G,2)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">v</span>

<div class="viewcode-block" id="DynamicFRETLine.calc"><a class="viewcode-back" href="../../../api/mfm.tools.html#mfm.tools.fret_lines.DynamicFRETLine.calc">[docs]</a>    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">parameter_range</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;x(G,1)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_dict</span><span class="p">[</span><span class="s1">&#39;x(G,2)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">FRETLineGenerator</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter_name</span><span class="o">=</span><span class="s1">&#39;x(G,2)&#39;</span><span class="p">,</span> <span class="n">parameter_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;return_conversion&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conversion_function</span></div></div>


<div class="viewcode-block" id="DynamicFRETLineSteps"><a class="viewcode-back" href="../../../api/mfm.tools.html#mfm.tools.fret_lines.DynamicFRETLineSteps">[docs]</a><span class="k">class</span> <span class="nc">DynamicFRETLineSteps</span><span class="p">(</span><span class="n">DynamicFRETLine</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class helps to generate a dynamic FRET line for a linear multi-state system</span>
<span class="sd">    if two end-points are known the number of steps `n` between the end-points is provided</span>
<span class="sd">    by the user of this class and and `n` dynamic FRET-lines are calculated. Based on these</span>
<span class="sd">    FRET-lines an overall conversion function covering the whole range from the start to</span>
<span class="sd">    the end is calculated.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; import mfm.tools.fret_lines as fret_lines</span>
<span class="sd">    &gt;&gt;&gt; d = fret_lines.DynamicFRETLineSteps()</span>

<span class="sd">    We also want to plot the conversion function. I use pylab</span>

<span class="sd">    &gt;&gt;&gt; import pylab as p</span>

<span class="sd">    Now lets calculate the conversion function. By default 10 intermediate steps</span>
<span class="sd">    are used</span>

<span class="sd">    &gt;&gt;&gt; d.calc()</span>
<span class="sd">    &gt;&gt;&gt; x, y = d.joint_conversion_function</span>
<span class="sd">    &gt;&gt;&gt; p.plot(x, y)</span>

<span class="sd">    Now lets use only three steps and lets check how it looks like</span>

<span class="sd">    &gt;&gt;&gt; d.number_of_intermediates = 3</span>
<span class="sd">    &gt;&gt;&gt; d.calc()</span>
<span class="sd">    &gt;&gt;&gt; x, y = d.joint_conversion_function</span>
<span class="sd">    &gt;&gt;&gt; p.plot(x, y)</span>

<span class="sd">    Before we look at the plot a 1:1 conversion function might be useful to have a</span>
<span class="sd">    reference and a static FRET-line</span>

<span class="sd">    &gt;&gt;&gt; p.plot(x, x)</span>
<span class="sd">    &gt;&gt;&gt; s = fret_lines.StaticFRETLine()</span>
<span class="sd">    &gt;&gt;&gt; s.calc()</span>
<span class="sd">    &gt;&gt;&gt; x, y = s.conversion_function</span>
<span class="sd">    &gt;&gt;&gt; p.plot(x, y)</span>

<span class="sd">    &gt;&gt;&gt; p.show()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">joint_conversion_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The overall conversion function including all intermediates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joint_conversion_function</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">start_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_point</span>

    <span class="nd">@start_point.setter</span>
    <span class="k">def</span> <span class="nf">start_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The start point in Angstrom</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start_point</span> <span class="o">=</span> <span class="n">v</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">end_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_end_point</span>

    <span class="nd">@end_point.setter</span>
    <span class="k">def</span> <span class="nf">end_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The end point in Angstrom</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_end_point</span> <span class="o">=</span> <span class="n">v</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_intermediates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The number of intermediate points between the start and the endpoint</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_intermediates</span>

    <span class="nd">@number_of_intermediates.setter</span>
    <span class="k">def</span> <span class="nf">number_of_intermediates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_intermediates</span> <span class="o">=</span> <span class="n">v</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mean_distances</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The array of mean distances between the two endpoints</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_intermediates</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">DynamicFRETLine</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start_point</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;start_point&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_end_point</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;end_point&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number_of_intermediates</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;number_of_intermediates&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_joint_conversion_function</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="DynamicFRETLineSteps.calc"><a class="viewcode-back" href="../../../api/mfm.tools.html#mfm.tools.fret_lines.DynamicFRETLineSteps.calc">[docs]</a>    <span class="k">def</span> <span class="nf">calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">parameter_range</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">mean_distances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_distances</span>
        <span class="n">conversion_functions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mean_distances</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean_distance_1</span> <span class="o">=</span> <span class="n">mean_distances</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean_distance_2</span> <span class="o">=</span> <span class="n">mean_distances</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">DynamicFRETLine</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameter_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">parameter_range</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">conversion_functions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conversion_function</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_joint_conversion_function</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">conversion_functions</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;return_conversion&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">conversion_function</span></div></div>


<div class="viewcode-block" id="FRETLineGeneratorWidget"><a class="viewcode-back" href="../../../api/mfm.tools.html#mfm.tools.fret_lines.FRETLineGeneratorWidget">[docs]</a><span class="k">class</span> <span class="nc">FRETLineGeneratorWidget</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QWidget</span><span class="p">,</span> <span class="n">FRETLineGenerator</span><span class="p">):</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;FRET-Line Generator&quot;</span>

    <span class="n">models</span> <span class="o">=</span> <span class="p">[(</span><span class="n">mfm</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">tcspc</span><span class="o">.</span><span class="n">fret</span><span class="o">.</span><span class="n">GaussianModelWidget</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hide_corrections&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_fit&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_generic&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_convolve&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_rotation&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_error&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_donor&#39;</span><span class="p">:</span> <span class="bp">True</span>
                                                          <span class="p">}),</span>
              <span class="p">(</span><span class="n">WormLikeChainModelWidget</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hide_corrections&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_fit&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_generic&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_convolve&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_rotation&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_error&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_donor&#39;</span><span class="p">:</span> <span class="bp">True</span>
                                                         <span class="p">}),</span>
              <span class="p">(</span><span class="n">mfm</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">tcspc</span><span class="o">.</span><span class="n">mix_model</span><span class="o">.</span><span class="n">MixModelWidget</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hide_corrections&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_fit&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_generic&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_convolve&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_rotation&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_error&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_donor&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;enable_mix_model_donor&#39;</span><span class="p">:</span> <span class="bp">True</span>
                                                         <span class="p">}),</span>
              <span class="p">(</span><span class="n">mfm</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">tcspc</span><span class="o">.</span><span class="n">fret</span><span class="o">.</span><span class="n">FRETrateModelWidget</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hide_corrections&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_fit&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_generic&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_convolve&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_rotation&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_error&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;hide_donor&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                                                          <span class="s1">&#39;enable_mix_model_donor&#39;</span><span class="p">:</span> <span class="bp">True</span>
                                                         <span class="p">}),</span>
              <span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span>

    <span class="nd">@model.setter</span>
    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_index</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">model_index</span><span class="p">)</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">model_index</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">fit</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">,</span> <span class="o">**</span><span class="n">parameter</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">current_model_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spinBox</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parameter_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox</span><span class="o">.</span><span class="n">value</span><span class="p">()),</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleSpinBox_2</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">QtGui</span><span class="o">.</span><span class="n">QWidget</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">uic</span><span class="o">.</span><span class="n">loadUi</span><span class="p">(</span><span class="s1">&#39;./mfm/ui/tools/fret_line.ui&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">win</span> <span class="o">=</span> <span class="n">CurveDialog</span><span class="p">(</span><span class="n">edit</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">toolbar</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># Make Plot</span>
        <span class="n">plot</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">get_plot</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_5</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">plot</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fret_line_plot</span> <span class="o">=</span> <span class="n">plot</span>

        <span class="n">FRETLineGenerator</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span> <span class="o">=</span> <span class="n">mfm</span><span class="o">.</span><span class="n">FitQtThread</span><span class="p">()</span>  <span class="c1"># the fit has to be a QtThread</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_points</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;verbose&#39;</span><span class="p">,</span> <span class="n">mfm</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_names</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_model_index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionModel_changed</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">SIGNAL</span><span class="p">(</span><span class="s1">&#39;triggered()&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">onModelChanged</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionParameter_changed</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">SIGNAL</span><span class="p">(</span><span class="s1">&#39;triggered()&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">onParameterChanged</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionUpdate_Parameter</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">SIGNAL</span><span class="p">(</span><span class="s1">&#39;triggered()&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_parameter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionCalculate_FRET_Line</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">SIGNAL</span><span class="p">(</span><span class="s1">&#39;triggered()&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">onCalculate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actionClear_plot</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">SIGNAL</span><span class="p">(</span><span class="s1">&#39;triggered()&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">onClearPlot</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">onModelChanged</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_parameter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>

<div class="viewcode-block" id="FRETLineGeneratorWidget.onClearPlot"><a class="viewcode-back" href="../../../api/mfm.tools.html#mfm.tools.fret_lines.FRETLineGeneratorWidget.onClearPlot">[docs]</a>    <span class="k">def</span> <span class="nf">onClearPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;onClearPlot&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fret_line_plot</span><span class="o">.</span><span class="n">del_all_items</span><span class="p">()</span></div>

<div class="viewcode-block" id="FRETLineGeneratorWidget.onCalculate"><a class="viewcode-back" href="../../../api/mfm.tools.html#mfm.tools.fret_lines.FRETLineGeneratorWidget.onCalculate">[docs]</a>    <span class="k">def</span> <span class="nf">onCalculate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc</span><span class="p">()</span>
        <span class="n">fret_line</span> <span class="o">=</span> <span class="n">make</span><span class="o">.</span><span class="n">curve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fluorescence_averaged_lifetimes</span><span class="p">,</span>  <span class="bp">self</span><span class="o">.</span><span class="n">transfer_efficiencies</span><span class="p">,</span>
                               <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fret_line_plot</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">fret_line</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fret_line_plot</span><span class="o">.</span><span class="n">do_autoscale</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transfer_efficency_string</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_2</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fdfa_string</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_3</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polynom_coefficients</span><span class="p">))</span></div>

<div class="viewcode-block" id="FRETLineGeneratorWidget.onParameterChanged"><a class="viewcode-back" href="../../../api/mfm.tools.html#mfm.tools.fret_lines.FRETLineGeneratorWidget.onParameterChanged">[docs]</a>    <span class="k">def</span> <span class="nf">onParameterChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_2</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span></div>

<div class="viewcode-block" id="FRETLineGeneratorWidget.update_parameter"><a class="viewcode-back" href="../../../api/mfm.tools.html#mfm.tools.fret_lines.FRETLineGeneratorWidget.update_parameter">[docs]</a>    <span class="k">def</span> <span class="nf">update_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_2</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_2</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameter_names</span><span class="p">)</span></div>

<div class="viewcode-block" id="FRETLineGeneratorWidget.onModelChanged"><a class="viewcode-back" href="../../../api/mfm.tools.html#mfm.tools.fret_lines.FRETLineGeneratorWidget.onModelChanged">[docs]</a>    <span class="k">def</span> <span class="nf">onModelChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_model_index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">)</span></div></div>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2016, Thomas Peulen.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>