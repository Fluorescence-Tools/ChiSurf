<!DOCTYPE html>
<!-- Generated by Cython 0.29.13 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: cPotentials.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.13</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="cPotentials.cpp">cPotentials.cpp</a></p>
<div class="cython"><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-16 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: <span class="k">from</span> <span class="nn">libc.math</span> <span class="k">cimport</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: <span class="k">from</span> <span class="nn">libc.stdint</span> <span class="k">cimport</span> <span class="n">uint32_t</span><span class="p">,</span> <span class="n">int32_t</span><span class="p">,</span> <span class="n">uint8_t</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: <span class="k">from</span> <span class="nn">libc.stdlib</span> <span class="k">cimport</span> <span class="n">abort</span><span class="p">,</span> <span class="n">malloc</span><span class="p">,</span> <span class="n">free</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: <span class="k">from</span> <span class="nn">cython.parallel</span> <span class="k">import</span> <span class="n">prange</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">010</span>: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">int_max</span><span class="p">(</span><span class="nb">int</span> <span class="n">a</span><span class="p">,</span> <span class="nb">int</span> <span class="n">b</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span> <span class="k">return</span> <span class="n">a</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;=</span> <span class="n">b</span> <span class="k">else</span> <span class="n">b</span></pre>
<pre class='cython code score-0 '>static CYTHON_INLINE int __pyx_f_3mfm_9structure_9potential_11cPotentials_int_max(int __pyx_v_a, int __pyx_v_b) {
  int __pyx_r;
  if (((__pyx_v_a &gt;= __pyx_v_b) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = __pyx_v_b;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">011</span>: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">int_min</span><span class="p">(</span><span class="nb">int</span> <span class="n">a</span><span class="p">,</span> <span class="nb">int</span> <span class="n">b</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span> <span class="k">return</span> <span class="n">a</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">b</span> <span class="k">else</span> <span class="n">b</span></pre>
<pre class='cython code score-0 '>static CYTHON_INLINE int __pyx_f_3mfm_9structure_9potential_11cPotentials_int_min(int __pyx_v_a, int __pyx_v_b) {
  int __pyx_r;
  if (((__pyx_v_a &lt;= __pyx_v_b) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = __pyx_v_b;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">012</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">013</span>: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">double</span> <span class="nf">double_max</span><span class="p">(</span><span class="n">double</span> <span class="n">a</span><span class="p">,</span> <span class="n">double</span> <span class="n">b</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span> <span class="k">return</span> <span class="n">a</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;=</span> <span class="n">b</span> <span class="k">else</span> <span class="n">b</span></pre>
<pre class='cython code score-0 '>static CYTHON_INLINE double __pyx_f_3mfm_9structure_9potential_11cPotentials_double_max(double __pyx_v_a, double __pyx_v_b) {
  double __pyx_r;
  if (((__pyx_v_a &gt;= __pyx_v_b) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = __pyx_v_b;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">014</span>: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">double</span> <span class="nf">double_min</span><span class="p">(</span><span class="n">double</span> <span class="n">a</span><span class="p">,</span> <span class="n">double</span> <span class="n">b</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span> <span class="k">return</span> <span class="n">a</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">b</span> <span class="k">else</span> <span class="n">b</span></pre>
<pre class='cython code score-0 '>static CYTHON_INLINE double __pyx_f_3mfm_9structure_9potential_11cPotentials_double_min(double __pyx_v_a, double __pyx_v_b) {
  double __pyx_r;
  if (((__pyx_v_a &lt;= __pyx_v_b) != 0)) {
    __pyx_t_1 = __pyx_v_a;
  } else {
    __pyx_t_1 = __pyx_v_b;
  }
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">015</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">016</span>: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">double</span> <span class="nf">dist3c</span><span class="p">(</span><span class="n">double</span> <span class="n">r1x</span><span class="p">,</span> <span class="n">double</span> <span class="n">r1y</span><span class="p">,</span> <span class="n">double</span> <span class="n">r1z</span><span class="p">,</span> <span class="n">double</span> <span class="n">r2x</span><span class="p">,</span> <span class="n">double</span> <span class="n">r2y</span><span class="p">,</span> <span class="n">double</span> <span class="n">r2z</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static CYTHON_INLINE double __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c(double __pyx_v_r1x, double __pyx_v_r1y, double __pyx_v_r1z, double __pyx_v_r2x, double __pyx_v_r2y, double __pyx_v_r2z) {
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">017</span>:     <span class="k">return</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">r1x</span> <span class="o">-</span> <span class="n">r2x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r1x</span> <span class="o">-</span> <span class="n">r2x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1y</span> <span class="o">-</span> <span class="n">r2y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r1y</span> <span class="o">-</span> <span class="n">r2y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1z</span> <span class="o">-</span> <span class="n">r2z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r1z</span> <span class="o">-</span> <span class="n">r2z</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_r = sqrt(((((__pyx_v_r1x - __pyx_v_r2x) * (__pyx_v_r1x - __pyx_v_r2x)) + ((__pyx_v_r1y - __pyx_v_r2y) * (__pyx_v_r1y - __pyx_v_r2y))) + ((__pyx_v_r1z - __pyx_v_r2z) * (__pyx_v_r1z - __pyx_v_r2z))));
  goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">018</span>: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">double</span> <span class="nf">dist3c2</span><span class="p">(</span><span class="n">double</span> <span class="n">r1x</span><span class="p">,</span> <span class="n">double</span> <span class="n">r1y</span><span class="p">,</span> <span class="n">double</span> <span class="n">r1z</span><span class="p">,</span> <span class="n">double</span> <span class="n">r2x</span><span class="p">,</span> <span class="n">double</span> <span class="n">r2y</span><span class="p">,</span> <span class="n">double</span> <span class="n">r2z</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static CYTHON_INLINE double __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c2(double __pyx_v_r1x, double __pyx_v_r1y, double __pyx_v_r1z, double __pyx_v_r2x, double __pyx_v_r2y, double __pyx_v_r2z) {
  double __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">019</span>:     <span class="k">return</span> <span class="p">(</span><span class="n">r1x</span> <span class="o">-</span> <span class="n">r2x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r1x</span> <span class="o">-</span> <span class="n">r2x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1y</span> <span class="o">-</span> <span class="n">r2y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r1y</span> <span class="o">-</span> <span class="n">r2y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1z</span> <span class="o">-</span> <span class="n">r2z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r1z</span> <span class="o">-</span> <span class="n">r2z</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_r = ((((__pyx_v_r1x - __pyx_v_r2x) * (__pyx_v_r1x - __pyx_v_r2x)) + ((__pyx_v_r1y - __pyx_v_r2y) * (__pyx_v_r1y - __pyx_v_r2y))) + ((__pyx_v_r1z - __pyx_v_r2z) * (__pyx_v_r1z - __pyx_v_r2z)));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">020</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-95" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">023</span>: <span class="k">def</span> <span class="nf">mj</span><span class="p">(</span><span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">resLookUp</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">res_types</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">ca_dist</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">mjPot</span><span class="p">,</span></pre>
<pre class='cython code score-95 '>/* Python wrapper */
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_1mj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_3mfm_9structure_9potential_11cPotentials_1mj = {"mj", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_3mfm_9structure_9potential_11cPotentials_1mj, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_1mj(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_resLookUp = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_res_types = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_ca_dist = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xyz = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_mjPot = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_cutoff;
  int __pyx_v_c_beta_pos;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("mj (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_resLookUp,&amp;__pyx_n_s_res_types,&amp;__pyx_n_s_ca_dist,&amp;__pyx_n_s_xyz,&amp;__pyx_n_s_mjPot,&amp;__pyx_n_s_cutoff,&amp;__pyx_n_s_c_beta_pos,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_resLookUp)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_res_types)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("mj", 0, 5, 7, 1); <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ca_dist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("mj", 0, 5, 7, 2); <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_xyz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("mj", 0, 5, 7, 3); <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_mjPot)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("mj", 0, 5, 7, 4); <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cutoff);
          if (value) { values[5] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_c_beta_pos);
          if (value) { values[6] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "mj") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_resLookUp = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_resLookUp.memview)) __PYX_ERR(0, 23, __pyx_L3_error)</span>
    __pyx_v_res_types = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_res_types.memview)) __PYX_ERR(0, 23, __pyx_L3_error)</span>
    __pyx_v_ca_dist = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_ca_dist.memview)) __PYX_ERR(0, 23, __pyx_L3_error)</span>
    __pyx_v_xyz = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_xyz.memview)) __PYX_ERR(0, 23, __pyx_L3_error)</span>
    __pyx_v_mjPot = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[4], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_mjPot.memview)) __PYX_ERR(0, 23, __pyx_L3_error)</span>
    if (values[5]) {
      __pyx_v_cutoff = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_cutoff == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L3_error)</span>
    } else {
      __pyx_v_cutoff = ((double)6.5);
    }
    if (values[6]) {
      __pyx_v_c_beta_pos = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[6]); if (unlikely((__pyx_v_c_beta_pos == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L3_error)</span>
    } else {
      __pyx_v_c_beta_pos = ((int)4);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("mj", 0, 5, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.mj", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3mfm_9structure_9potential_11cPotentials_mj(__pyx_self, __pyx_v_resLookUp, __pyx_v_res_types, __pyx_v_ca_dist, __pyx_v_xyz, __pyx_v_mjPot, __pyx_v_cutoff, __pyx_v_c_beta_pos);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3mfm_9structure_9potential_11cPotentials_mj(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_resLookUp, __Pyx_memviewslice __pyx_v_res_types, __Pyx_memviewslice __pyx_v_ca_dist, __Pyx_memviewslice __pyx_v_xyz, __Pyx_memviewslice __pyx_v_mjPot, double __pyx_v_cutoff, int __pyx_v_c_beta_pos) {
  int __pyx_v_nRes;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_res_i;
  int __pyx_v_res_j;
  int __pyx_v_nCbi;
  int __pyx_v_nCbj;
  double __pyx_v_r1x;
  double __pyx_v_r1y;
  double __pyx_v_r1z;
  double __pyx_v_r2x;
  double __pyx_v_r2y;
  double __pyx_v_r2z;
  double __pyx_v_dij;
  double __pyx_v_cut2;
  CYTHON_UNUSED double __pyx_v_cut_ca2;
  double __pyx_v_E;
  int __pyx_v_nCont;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("mj", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_30);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_31);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_32);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.mj", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_resLookUp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_res_types, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_ca_dist, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_mjPot, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__26 = <span class='py_c_api'>PyTuple_Pack</span>(25, __pyx_n_s_resLookUp, __pyx_n_s_res_types, __pyx_n_s_ca_dist, __pyx_n_s_xyz, __pyx_n_s_mjPot, __pyx_n_s_cutoff, __pyx_n_s_c_beta_pos, __pyx_n_s_nRes, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_res_i, __pyx_n_s_res_j, __pyx_n_s_nCbi, __pyx_n_s_nCbj, __pyx_n_s_r1x, __pyx_n_s_r1y, __pyx_n_s_r1z, __pyx_n_s_r2x, __pyx_n_s_r2y, __pyx_n_s_r2z, __pyx_n_s_dij, __pyx_n_s_cut2, __pyx_n_s_cut_ca2, __pyx_n_s_E, __pyx_n_s_nCont);<span class='error_goto'> if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__26);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3mfm_9structure_9potential_11cPotentials_1mj, NULL, __pyx_n_s_mfm_structure_potential_cPotenti_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_mj, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__27 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 25, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__26, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_mfm_structure_potential_cPotenti, __pyx_n_s_mj, 23, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__27)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">024</span>:        <span class="n">double</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">6.5</span><span class="p">,</span> <span class="nb">int</span> <span class="n">c_beta_pos</span><span class="o">=</span><span class="mf">4</span><span class="p">):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">025</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">nRes</span> <span class="o">=</span> <span class="n">resLookUp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nRes = (__pyx_v_resLookUp.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">026</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">res_i</span><span class="p">,</span> <span class="nf">res_j</span><span class="p">,</span> <span class="nf">nCbi</span><span class="p">,</span> <span class="nf">nCbj</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">r1x</span><span class="p">,</span> <span class="nf">r1y</span><span class="p">,</span> <span class="nf">r1z</span><span class="p">,</span> <span class="nf">r2x</span><span class="p">,</span> <span class="nf">r2y</span><span class="p">,</span> <span class="nf">r2z</span><span class="p">,</span> <span class="nf">dij</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">028</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">cut2</span> <span class="o">=</span> <span class="n">cutoff</span> <span class="o">*</span> <span class="n">cutoff</span></pre>
<pre class='cython code score-0 '>  __pyx_v_cut2 = (__pyx_v_cutoff * __pyx_v_cutoff);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">029</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">cut_ca2</span> <span class="o">=</span> <span class="n">cutoff</span> <span class="o">*</span> <span class="n">cutoff</span></pre>
<pre class='cython code score-0 '>  __pyx_v_cut_ca2 = (__pyx_v_cutoff * __pyx_v_cutoff);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">030</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">031</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">nCont</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nCont = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">032</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">nRes</span><span class="p">,</span> <span class="k">nogil</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nRes;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for reduction(+:__pyx_v_E) lastprivate(__pyx_v_dij) firstprivate(__pyx_v_i) lastprivate(__pyx_v_i) lastprivate(__pyx_v_j) lastprivate(__pyx_v_nCbi) lastprivate(__pyx_v_nCbj) reduction(+:__pyx_v_nCont) lastprivate(__pyx_v_r1x) lastprivate(__pyx_v_r1y) lastprivate(__pyx_v_r1z) lastprivate(__pyx_v_r2x) lastprivate(__pyx_v_r2y) lastprivate(__pyx_v_r2z) lastprivate(__pyx_v_res_i) lastprivate(__pyx_v_res_j)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_i = (int)(0 + 1 * __pyx_t_2);
                            /* Initialize private variables to invalid values */
                            __pyx_v_dij = ((double)__PYX_NAN());
                            __pyx_v_j = ((int)0xbad0bad0);
                            __pyx_v_nCbi = ((int)0xbad0bad0);
                            __pyx_v_nCbj = ((int)0xbad0bad0);
                            __pyx_v_r1x = ((double)__PYX_NAN());
                            __pyx_v_r1y = ((double)__PYX_NAN());
                            __pyx_v_r1z = ((double)__PYX_NAN());
                            __pyx_v_r2x = ((double)__PYX_NAN());
                            __pyx_v_r2y = ((double)__PYX_NAN());
                            __pyx_v_r2z = ((double)__PYX_NAN());
                            __pyx_v_res_i = ((int)0xbad0bad0);
                            __pyx_v_res_j = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">033</span>:         <span class="n">res_i</span> <span class="o">=</span> <span class="n">res_types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = __pyx_v_i;
                            if (__pyx_t_4 &lt; 0) __pyx_t_4 += __pyx_v_res_types.shape[0];
                            __pyx_v_res_i = (*((int *) ( /* dim=0 */ (__pyx_v_res_types.data + __pyx_t_4 * __pyx_v_res_types.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">034</span>:         <span class="n">nCbi</span> <span class="o">=</span> <span class="n">resLookUp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">c_beta_pos</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                            __pyx_t_5 = __pyx_v_i;
                            __pyx_t_6 = __pyx_v_c_beta_pos;
                            if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_resLookUp.shape[0];
                            if (__pyx_t_6 &lt; 0) __pyx_t_6 += __pyx_v_resLookUp.shape[1];
                            __pyx_v_nCbi = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_5 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_6 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">035</span>:         <span class="n">r1x</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCbi</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                            __pyx_t_7 = __pyx_v_nCbi;
                            __pyx_t_8 = 0;
                            if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_v_xyz.shape[0];
                            if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_v_xyz.shape[1];
                            __pyx_v_r1x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_7 * __pyx_v_xyz.strides[0]) ) + __pyx_t_8 * __pyx_v_xyz.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">036</span>:         <span class="n">r1y</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCbi</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                            __pyx_t_9 = __pyx_v_nCbi;
                            __pyx_t_10 = 1;
                            if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_v_xyz.shape[0];
                            if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_v_xyz.shape[1];
                            __pyx_v_r1y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_9 * __pyx_v_xyz.strides[0]) ) + __pyx_t_10 * __pyx_v_xyz.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">037</span>:         <span class="n">r1z</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCbi</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                            __pyx_t_11 = __pyx_v_nCbi;
                            __pyx_t_12 = 2;
                            if (__pyx_t_11 &lt; 0) __pyx_t_11 += __pyx_v_xyz.shape[0];
                            if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_v_xyz.shape[1];
                            __pyx_v_r1z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_11 * __pyx_v_xyz.strides[0]) ) + __pyx_t_12 * __pyx_v_xyz.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">038</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">nRes</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                            __pyx_t_13 = __pyx_v_nRes;
                            __pyx_t_14 = __pyx_t_13;
                            for (__pyx_t_15 = (__pyx_v_i + 1); __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
                              __pyx_v_j = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">039</span>:             <span class="n">res_j</span> <span class="o">=</span> <span class="n">res_types</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_16 = __pyx_v_j;
                              if (__pyx_t_16 &lt; 0) __pyx_t_16 += __pyx_v_res_types.shape[0];
                              __pyx_v_res_j = (*((int *) ( /* dim=0 */ (__pyx_v_res_types.data + __pyx_t_16 * __pyx_v_res_types.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">040</span>:             <span class="n">nCbj</span> <span class="o">=</span> <span class="n">resLookUp</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">c_beta_pos</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_17 = __pyx_v_j;
                              __pyx_t_18 = __pyx_v_c_beta_pos;
                              if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_v_resLookUp.shape[0];
                              if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_v_resLookUp.shape[1];
                              __pyx_v_nCbj = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_17 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_18 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">041</span>:             <span class="k">if</span> <span class="n">ca_dist</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">cutoff</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="mf">1.6</span><span class="p">)</span> <span class="o">**</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_19 = __pyx_v_i;
                              __pyx_t_20 = __pyx_v_j;
                              if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_v_ca_dist.shape[0];
                              if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_v_ca_dist.shape[1];
                              __pyx_t_21 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ca_dist.data + __pyx_t_19 * __pyx_v_ca_dist.strides[0]) ) + __pyx_t_20 * __pyx_v_ca_dist.strides[1]) ))) &lt; pow((__pyx_v_cutoff + (2.0 * 1.6)), 2.0)) != 0);
                              if (__pyx_t_21) {
/* … */
                              }
                            }
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">042</span>:                 <span class="n">r2x</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCbj</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                __pyx_t_22 = __pyx_v_nCbj;
                                __pyx_t_23 = 0;
                                if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_v_xyz.shape[0];
                                if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_v_xyz.shape[1];
                                __pyx_v_r2x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_22 * __pyx_v_xyz.strides[0]) ) + __pyx_t_23 * __pyx_v_xyz.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">043</span>:                 <span class="n">r2y</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCbj</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                __pyx_t_24 = __pyx_v_nCbj;
                                __pyx_t_25 = 1;
                                if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_v_xyz.shape[0];
                                if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_v_xyz.shape[1];
                                __pyx_v_r2y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_24 * __pyx_v_xyz.strides[0]) ) + __pyx_t_25 * __pyx_v_xyz.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">044</span>:                 <span class="n">r2z</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCbj</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                __pyx_t_26 = __pyx_v_nCbj;
                                __pyx_t_27 = 2;
                                if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_v_xyz.shape[0];
                                if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_v_xyz.shape[1];
                                __pyx_v_r2z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_26 * __pyx_v_xyz.strides[0]) ) + __pyx_t_27 * __pyx_v_xyz.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">045</span>:                 <span class="n">dij</span> <span class="o">=</span> <span class="n">dist3c2</span><span class="p">(</span><span class="n">r1x</span><span class="p">,</span> <span class="n">r1y</span><span class="p">,</span> <span class="n">r1z</span><span class="p">,</span> <span class="n">r2x</span><span class="p">,</span> <span class="n">r2y</span><span class="p">,</span> <span class="n">r2z</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                                __pyx_v_dij = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c2(__pyx_v_r1x, __pyx_v_r1y, __pyx_v_r1z, __pyx_v_r2x, __pyx_v_r2y, __pyx_v_r2z);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">046</span>:                 <span class="k">if</span> <span class="n">dij</span> <span class="o">&lt;</span> <span class="n">cut2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>                                __pyx_t_21 = ((__pyx_v_dij &lt; __pyx_v_cut2) != 0);
                                if (__pyx_t_21) {
/* … */
                                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">047</span>:                     <span class="n">E</span> <span class="o">+=</span> <span class="n">mjPot</span><span class="p">[</span><span class="n">res_i</span><span class="p">,</span> <span class="n">res_j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                  __pyx_t_28 = __pyx_v_res_i;
                                  __pyx_t_29 = __pyx_v_res_j;
                                  if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_v_mjPot.shape[0];
                                  if (__pyx_t_29 &lt; 0) __pyx_t_29 += __pyx_v_mjPot.shape[1];
                                  __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_mjPot.data + __pyx_t_28 * __pyx_v_mjPot.strides[0]) ) + __pyx_t_29 * __pyx_v_mjPot.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">048</span>:                     <span class="n">nCont</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>                                  __pyx_v_nCont = (__pyx_v_nCont + 1);
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">049</span>:     <span class="k">return</span> <span class="n">nCont</span><span class="p">,</span> <span class="n">E</span></pre>
<pre class='cython code score-15 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_30 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nCont);<span class='error_goto'> if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_30);
  __pyx_t_31 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E);<span class='error_goto'> if (unlikely(!__pyx_t_31)) __PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_31);
  __pyx_t_32 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_32)) __PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_32);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_30);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_32, 0, __pyx_t_30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_31);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_32, 1, __pyx_t_31);
  __pyx_t_30 = 0;
  __pyx_t_31 = 0;
  __pyx_r = __pyx_t_32;
  __pyx_t_32 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">050</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">053</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-108" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">054</span>: <span class="k">def</span> <span class="nf">hBondLookUpAll</span><span class="p">(</span><span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">resLookUp</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">caDist</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">hPot</span><span class="p">,</span> <span class="n">double</span> <span class="n">cutoffCA2</span><span class="p">,</span></pre>
<pre class='cython code score-108 '>/* Python wrapper */
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_3hBondLookUpAll(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_3mfm_9structure_9potential_11cPotentials_3hBondLookUpAll = {"hBondLookUpAll", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_3mfm_9structure_9potential_11cPotentials_3hBondLookUpAll, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_3hBondLookUpAll(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_resLookUp = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_caDist = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_xyz = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_hPot = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_cutoffCA2;
  double __pyx_v_cutoffH2;
  double __pyx_v_binWidth;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("hBondLookUpAll (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_resLookUp,&amp;__pyx_n_s_caDist,&amp;__pyx_n_s_xyz,&amp;__pyx_n_s_hPot,&amp;__pyx_n_s_cutoffCA2,&amp;__pyx_n_s_cutoffH2,&amp;__pyx_n_s_binWidth,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_resLookUp)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_caDist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hBondLookUpAll", 0, 6, 7, 1); <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_xyz)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hBondLookUpAll", 0, 6, 7, 2); <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_hPot)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hBondLookUpAll", 0, 6, 7, 3); <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cutoffCA2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hBondLookUpAll", 0, 6, 7, 4); <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cutoffH2)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hBondLookUpAll", 0, 6, 7, 5); <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_binWidth);
          if (value) { values[6] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "hBondLookUpAll") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_resLookUp = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_resLookUp.memview)) __PYX_ERR(0, 54, __pyx_L3_error)</span>
    __pyx_v_caDist = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_caDist.memview)) __PYX_ERR(0, 54, __pyx_L3_error)</span>
    __pyx_v_xyz = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_xyz.memview)) __PYX_ERR(0, 54, __pyx_L3_error)</span>
    __pyx_v_hPot = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_hPot.memview)) __PYX_ERR(0, 54, __pyx_L3_error)</span>
    __pyx_v_cutoffCA2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_cutoffCA2 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L3_error)</span>
    __pyx_v_cutoffH2 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_cutoffH2 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 55, __pyx_L3_error)</span>
    if (values[6]) {
      __pyx_v_binWidth = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[6]); if (unlikely((__pyx_v_binWidth == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 55, __pyx_L3_error)</span>
    } else {
      __pyx_v_binWidth = ((double)0.01);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("hBondLookUpAll", 0, 6, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.hBondLookUpAll", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3mfm_9structure_9potential_11cPotentials_2hBondLookUpAll(__pyx_self, __pyx_v_resLookUp, __pyx_v_caDist, __pyx_v_xyz, __pyx_v_hPot, __pyx_v_cutoffCA2, __pyx_v_cutoffH2, __pyx_v_binWidth);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3mfm_9structure_9potential_11cPotentials_2hBondLookUpAll(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_resLookUp, __Pyx_memviewslice __pyx_v_caDist, __Pyx_memviewslice __pyx_v_xyz, __Pyx_memviewslice __pyx_v_hPot, double __pyx_v_cutoffCA2, double __pyx_v_cutoffH2, double __pyx_v_binWidth) {
  int __pyx_v_binNbr;
  int __pyx_v_nCi;
  int __pyx_v_nCj;
  int __pyx_v_nNi;
  int __pyx_v_nNj;
  int __pyx_v_nOi;
  int __pyx_v_nOj;
  int __pyx_v_nHi;
  int __pyx_v_nHj;
  double __pyx_v_dONij;
  double __pyx_v_dONji;
  double __pyx_v_dCNij;
  double __pyx_v_dCNji;
  double __pyx_v_dOHij;
  double __pyx_v_dOHji;
  double __pyx_v_dCHij;
  double __pyx_v_dCHji;
  int __pyx_v_nRes;
  int __pyx_v_ri;
  int __pyx_v_rj;
  CYTHON_UNUSED int __pyx_v_maxBin;
  int __pyx_v_nHBond;
  double __pyx_v_E;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("hBondLookUpAll", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_251);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_252);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_253);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.hBondLookUpAll", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_resLookUp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_caDist, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_hPot, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__28 = <span class='py_c_api'>PyTuple_Pack</span>(30, __pyx_n_s_resLookUp, __pyx_n_s_caDist, __pyx_n_s_xyz, __pyx_n_s_hPot, __pyx_n_s_cutoffCA2, __pyx_n_s_cutoffH2, __pyx_n_s_binWidth, __pyx_n_s_binNbr, __pyx_n_s_nCi, __pyx_n_s_nCj, __pyx_n_s_nNi, __pyx_n_s_nNj, __pyx_n_s_nOi, __pyx_n_s_nOj, __pyx_n_s_nHi, __pyx_n_s_nHj, __pyx_n_s_dONij, __pyx_n_s_dONji, __pyx_n_s_dCNij, __pyx_n_s_dCNji, __pyx_n_s_dOHij, __pyx_n_s_dOHji, __pyx_n_s_dCHij, __pyx_n_s_dCHji, __pyx_n_s_nRes, __pyx_n_s_ri, __pyx_n_s_rj, __pyx_n_s_maxBin, __pyx_n_s_nHBond, __pyx_n_s_E);<span class='error_goto'> if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__28);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3mfm_9structure_9potential_11cPotentials_3hBondLookUpAll, NULL, __pyx_n_s_mfm_structure_potential_cPotenti_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_hBondLookUpAll, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__29 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 30, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__28, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_mfm_structure_potential_cPotenti, __pyx_n_s_hBondLookUpAll, 54, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__29)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">055</span>:                 <span class="n">double</span> <span class="n">cutoffH2</span><span class="p">,</span> <span class="n">double</span> <span class="n">binWidth</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">056</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">binNbr</span><span class="p">,</span> <span class="nf">nCi</span><span class="p">,</span> <span class="nf">nCj</span><span class="p">,</span> <span class="nf">nNi</span><span class="p">,</span> <span class="nf">nNj</span><span class="p">,</span> <span class="nf">nOi</span><span class="p">,</span> <span class="nf">nOj</span><span class="p">,</span> <span class="nf">nHi</span><span class="p">,</span> <span class="nf">nHj</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">057</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">dONij</span><span class="p">,</span> <span class="nf">dONji</span><span class="p">,</span> <span class="nf">dCNij</span><span class="p">,</span> <span class="nf">dCNji</span><span class="p">,</span> <span class="nf">dOHij</span><span class="p">,</span> <span class="nf">dOHji</span><span class="p">,</span> <span class="nf">dCHij</span><span class="p">,</span> <span class="nf">dCHji</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">058</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">nRes</span> <span class="o">=</span> <span class="n">resLookUp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nRes = (__pyx_v_resLookUp.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">059</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">ri</span><span class="p">,</span> <span class="nf">rj</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">060</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">maxBin</span> <span class="o">=</span> <span class="n">hPot</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_maxBin = (__pyx_v_hPot.shape[1]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">061</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">nHBond</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nHBond = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">062</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">063</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">064</span>:     <span class="k">for</span> <span class="n">ri</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">nRes</span><span class="p">,</span> <span class="k">nogil</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
        __pyx_t_1 = __pyx_v_nRes;
        if (1 == 0) abort();
        {
            #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
                #undef likely
                #undef unlikely
                #define likely(x)   (x)
                #define unlikely(x) (x)
            #endif
            __pyx_t_3 = (__pyx_t_1 - 0 + 1 - 1/abs(1)) / 1;
            if (__pyx_t_3 &gt; 0)
            {
                #ifdef _OPENMP
                #pragma omp parallel
                #endif /* _OPENMP */
                {
                    #ifdef _OPENMP
                    #pragma omp for reduction(+:__pyx_v_E) lastprivate(__pyx_v_binNbr) lastprivate(__pyx_v_dCHij) lastprivate(__pyx_v_dCHji) lastprivate(__pyx_v_dCNij) lastprivate(__pyx_v_dCNji) lastprivate(__pyx_v_dOHij) lastprivate(__pyx_v_dOHji) lastprivate(__pyx_v_dONij) lastprivate(__pyx_v_dONji) lastprivate(__pyx_v_nCi) lastprivate(__pyx_v_nCj) reduction(+:__pyx_v_nHBond) lastprivate(__pyx_v_nHi) lastprivate(__pyx_v_nHj) lastprivate(__pyx_v_nNi) lastprivate(__pyx_v_nNj) lastprivate(__pyx_v_nOi) lastprivate(__pyx_v_nOj) firstprivate(__pyx_v_ri) lastprivate(__pyx_v_ri) lastprivate(__pyx_v_rj)
                    #endif /* _OPENMP */
                    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2++){
                        {
                            __pyx_v_ri = (int)(0 + 1 * __pyx_t_2);
                            /* Initialize private variables to invalid values */
                            __pyx_v_binNbr = ((int)0xbad0bad0);
                            __pyx_v_dCHij = ((double)__PYX_NAN());
                            __pyx_v_dCHji = ((double)__PYX_NAN());
                            __pyx_v_dCNij = ((double)__PYX_NAN());
                            __pyx_v_dCNji = ((double)__PYX_NAN());
                            __pyx_v_dOHij = ((double)__PYX_NAN());
                            __pyx_v_dOHji = ((double)__PYX_NAN());
                            __pyx_v_dONij = ((double)__PYX_NAN());
                            __pyx_v_dONji = ((double)__PYX_NAN());
                            __pyx_v_nCi = ((int)0xbad0bad0);
                            __pyx_v_nCj = ((int)0xbad0bad0);
                            __pyx_v_nHi = ((int)0xbad0bad0);
                            __pyx_v_nHj = ((int)0xbad0bad0);
                            __pyx_v_nNi = ((int)0xbad0bad0);
                            __pyx_v_nNj = ((int)0xbad0bad0);
                            __pyx_v_nOi = ((int)0xbad0bad0);
                            __pyx_v_nOj = ((int)0xbad0bad0);
                            __pyx_v_rj = ((int)0xbad0bad0);
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">065</span>:         <span class="n">nNi</span> <span class="o">=</span> <span class="n">resLookUp</span><span class="p">[</span><span class="n">ri</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                            __pyx_t_4 = __pyx_v_ri;
                            __pyx_t_5 = 0;
                            if (__pyx_t_4 &lt; 0) __pyx_t_4 += __pyx_v_resLookUp.shape[0];
                            if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_resLookUp.shape[1];
                            __pyx_v_nNi = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_4 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_5 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">066</span>:         <span class="n">nCi</span> <span class="o">=</span> <span class="n">resLookUp</span><span class="p">[</span><span class="n">ri</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                            __pyx_t_6 = __pyx_v_ri;
                            __pyx_t_7 = 2;
                            if (__pyx_t_6 &lt; 0) __pyx_t_6 += __pyx_v_resLookUp.shape[0];
                            if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_v_resLookUp.shape[1];
                            __pyx_v_nCi = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_6 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_7 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">067</span>:         <span class="n">nOi</span> <span class="o">=</span> <span class="n">resLookUp</span><span class="p">[</span><span class="n">ri</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                            __pyx_t_8 = __pyx_v_ri;
                            __pyx_t_9 = 3;
                            if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_v_resLookUp.shape[0];
                            if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_v_resLookUp.shape[1];
                            __pyx_v_nOi = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_8 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_9 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">068</span>:         <span class="n">nHi</span> <span class="o">=</span> <span class="n">resLookUp</span><span class="p">[</span><span class="n">ri</span><span class="p">,</span> <span class="mf">5</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                            __pyx_t_10 = __pyx_v_ri;
                            __pyx_t_11 = 5;
                            if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_v_resLookUp.shape[0];
                            if (__pyx_t_11 &lt; 0) __pyx_t_11 += __pyx_v_resLookUp.shape[1];
                            __pyx_v_nHi = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_10 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_11 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">069</span>:         <span class="k">for</span> <span class="n">rj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ri</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">nRes</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                            __pyx_t_12 = __pyx_v_nRes;
                            __pyx_t_13 = __pyx_t_12;
                            for (__pyx_t_14 = (__pyx_v_ri + 1); __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
                              __pyx_v_rj = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">070</span>:             <span class="k">if</span> <span class="n">caDist</span><span class="p">[</span><span class="n">ri</span><span class="p">,</span> <span class="n">rj</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">cutoffCA2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>                              __pyx_t_15 = __pyx_v_ri;
                              __pyx_t_16 = __pyx_v_rj;
                              if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_v_caDist.shape[0];
                              if (__pyx_t_16 &lt; 0) __pyx_t_16 += __pyx_v_caDist.shape[1];
                              __pyx_t_17 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_caDist.data + __pyx_t_15 * __pyx_v_caDist.strides[0]) ) + __pyx_t_16 * __pyx_v_caDist.strides[1]) ))) &lt; __pyx_v_cutoffCA2) != 0);
                              if (__pyx_t_17) {
/* … */
                              }
                            }
                        }
                    }
                }
            }
        }
        #if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))
            #undef likely
            #undef unlikely
            #define likely(x)   __builtin_expect(!!(x), 1)
            #define unlikely(x) __builtin_expect(!!(x), 0)
        #endif
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">071</span>:                 <span class="n">nNj</span> <span class="o">=</span> <span class="n">resLookUp</span><span class="p">[</span><span class="n">rj</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                __pyx_t_18 = __pyx_v_rj;
                                __pyx_t_19 = 0;
                                if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_v_resLookUp.shape[0];
                                if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_v_resLookUp.shape[1];
                                __pyx_v_nNj = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_18 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_19 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">072</span>:                 <span class="n">nCj</span> <span class="o">=</span> <span class="n">resLookUp</span><span class="p">[</span><span class="n">rj</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                __pyx_t_20 = __pyx_v_rj;
                                __pyx_t_21 = 2;
                                if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_v_resLookUp.shape[0];
                                if (__pyx_t_21 &lt; 0) __pyx_t_21 += __pyx_v_resLookUp.shape[1];
                                __pyx_v_nCj = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_20 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_21 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">073</span>:                 <span class="n">nOj</span> <span class="o">=</span> <span class="n">resLookUp</span><span class="p">[</span><span class="n">rj</span><span class="p">,</span> <span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                __pyx_t_22 = __pyx_v_rj;
                                __pyx_t_23 = 3;
                                if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_v_resLookUp.shape[0];
                                if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_v_resLookUp.shape[1];
                                __pyx_v_nOj = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_22 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_23 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">074</span>:                 <span class="n">nHj</span> <span class="o">=</span> <span class="n">resLookUp</span><span class="p">[</span><span class="n">rj</span><span class="p">,</span> <span class="mf">5</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                __pyx_t_24 = __pyx_v_rj;
                                __pyx_t_25 = 5;
                                if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_v_resLookUp.shape[0];
                                if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_v_resLookUp.shape[1];
                                __pyx_v_nHj = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_24 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_25 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">075</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">076</span>:                 <span class="k">if</span> <span class="n">nHi</span> <span class="o">&gt;</span> <span class="mf">0</span> <span class="ow">and</span> <span class="n">nHj</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span> <span class="c"># Both aa no Pro</span></pre>
<pre class='cython code score-0 '>                                __pyx_t_26 = ((__pyx_v_nHi &gt; 0) != 0);
                                if (__pyx_t_26) {
                                } else {
                                  __pyx_t_17 = __pyx_t_26;
                                  goto __pyx_L14_bool_binop_done;
                                }
                                __pyx_t_26 = ((__pyx_v_nHj &gt; 0) != 0);
                                __pyx_t_17 = __pyx_t_26;
                                __pyx_L14_bool_binop_done:;
                                if (__pyx_t_17) {
/* … */
                                  goto __pyx_L13;
                                }
</pre><pre class="cython line score-0">&#xA0;<span class="">077</span>:                     <span class="c"># i -&gt; j</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">078</span>:                     <span class="n">dOHij</span> <span class="o">=</span> <span class="n">dist3c2</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nHj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHj</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOi</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                  __pyx_t_27 = __pyx_v_nHj;
                                  __pyx_t_28 = 0;
                                  if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_v_xyz.shape[1];
                                  __pyx_t_29 = __pyx_v_nHj;
                                  __pyx_t_30 = 1;
                                  if (__pyx_t_29 &lt; 0) __pyx_t_29 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_30 &lt; 0) __pyx_t_30 += __pyx_v_xyz.shape[1];
                                  __pyx_t_31 = __pyx_v_nHj;
                                  __pyx_t_32 = 2;
                                  if (__pyx_t_31 &lt; 0) __pyx_t_31 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_32 &lt; 0) __pyx_t_32 += __pyx_v_xyz.shape[1];
                                  __pyx_t_33 = __pyx_v_nOi;
                                  __pyx_t_34 = 0;
                                  if (__pyx_t_33 &lt; 0) __pyx_t_33 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_34 &lt; 0) __pyx_t_34 += __pyx_v_xyz.shape[1];
                                  __pyx_t_35 = __pyx_v_nOi;
                                  __pyx_t_36 = 1;
                                  if (__pyx_t_35 &lt; 0) __pyx_t_35 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_36 &lt; 0) __pyx_t_36 += __pyx_v_xyz.shape[1];
                                  __pyx_t_37 = __pyx_v_nOi;
                                  __pyx_t_38 = 2;
                                  if (__pyx_t_37 &lt; 0) __pyx_t_37 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_38 &lt; 0) __pyx_t_38 += __pyx_v_xyz.shape[1];
                                  __pyx_v_dOHij = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c2((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_27 * __pyx_v_xyz.strides[0]) ) + __pyx_t_28 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_29 * __pyx_v_xyz.strides[0]) ) + __pyx_t_30 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_31 * __pyx_v_xyz.strides[0]) ) + __pyx_t_32 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_33 * __pyx_v_xyz.strides[0]) ) + __pyx_t_34 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_35 * __pyx_v_xyz.strides[0]) ) + __pyx_t_36 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_37 * __pyx_v_xyz.strides[0]) ) + __pyx_t_38 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">079</span>:                     <span class="k">if</span> <span class="n">dOHij</span> <span class="o">&lt;</span> <span class="n">cutoffH2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>                                  __pyx_t_17 = ((__pyx_v_dOHij &lt; __pyx_v_cutoffH2) != 0);
                                  if (__pyx_t_17) {
/* … */
                                  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">080</span>:                         <span class="n">nHBond</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>                                    __pyx_v_nHBond = (__pyx_v_nHBond + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">081</span>:                         <span class="n">binNbr</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dOHij</span><span class="p">)</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                                    __pyx_v_binNbr = ((int)(sqrt(__pyx_v_dOHij) / __pyx_v_binWidth));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">082</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">2</span><span class="p">,</span> <span class="n">binNbr</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_39 = 2;
                                    __pyx_t_40 = __pyx_v_binNbr;
                                    if (__pyx_t_39 &lt; 0) __pyx_t_39 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_40 &lt; 0) __pyx_t_40 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_39 * __pyx_v_hPot.strides[0]) ) + __pyx_t_40 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">083</span>:                         <span class="n">dONij</span> <span class="o">=</span> <span class="n">dist3c</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nNj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNj</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOi</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_41 = __pyx_v_nNj;
                                    __pyx_t_42 = 0;
                                    if (__pyx_t_41 &lt; 0) __pyx_t_41 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_42 &lt; 0) __pyx_t_42 += __pyx_v_xyz.shape[1];
                                    __pyx_t_43 = __pyx_v_nNj;
                                    __pyx_t_44 = 1;
                                    if (__pyx_t_43 &lt; 0) __pyx_t_43 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_44 &lt; 0) __pyx_t_44 += __pyx_v_xyz.shape[1];
                                    __pyx_t_45 = __pyx_v_nNj;
                                    __pyx_t_46 = 2;
                                    if (__pyx_t_45 &lt; 0) __pyx_t_45 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_46 &lt; 0) __pyx_t_46 += __pyx_v_xyz.shape[1];
                                    __pyx_t_47 = __pyx_v_nOi;
                                    __pyx_t_48 = 0;
                                    if (__pyx_t_47 &lt; 0) __pyx_t_47 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_48 &lt; 0) __pyx_t_48 += __pyx_v_xyz.shape[1];
                                    __pyx_t_49 = __pyx_v_nOi;
                                    __pyx_t_50 = 1;
                                    if (__pyx_t_49 &lt; 0) __pyx_t_49 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_50 &lt; 0) __pyx_t_50 += __pyx_v_xyz.shape[1];
                                    __pyx_t_51 = __pyx_v_nOi;
                                    __pyx_t_52 = 2;
                                    if (__pyx_t_51 &lt; 0) __pyx_t_51 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_52 &lt; 0) __pyx_t_52 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dONij = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_41 * __pyx_v_xyz.strides[0]) ) + __pyx_t_42 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_43 * __pyx_v_xyz.strides[0]) ) + __pyx_t_44 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_45 * __pyx_v_xyz.strides[0]) ) + __pyx_t_46 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_47 * __pyx_v_xyz.strides[0]) ) + __pyx_t_48 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_49 * __pyx_v_xyz.strides[0]) ) + __pyx_t_50 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_51 * __pyx_v_xyz.strides[0]) ) + __pyx_t_52 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">084</span>:                         <span class="n">binNbr</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">dONij</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                                    __pyx_v_binNbr = ((int)(__pyx_v_dONij / __pyx_v_binWidth));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">085</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="n">binNbr</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_53 = 1;
                                    __pyx_t_54 = __pyx_v_binNbr;
                                    if (__pyx_t_53 &lt; 0) __pyx_t_53 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_54 &lt; 0) __pyx_t_54 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_53 * __pyx_v_hPot.strides[0]) ) + __pyx_t_54 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>:                         <span class="n">dCHij</span> <span class="o">=</span> <span class="n">dist3c</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nCi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCi</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHj</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_55 = __pyx_v_nCi;
                                    __pyx_t_56 = 0;
                                    if (__pyx_t_55 &lt; 0) __pyx_t_55 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_56 &lt; 0) __pyx_t_56 += __pyx_v_xyz.shape[1];
                                    __pyx_t_57 = __pyx_v_nCi;
                                    __pyx_t_58 = 1;
                                    if (__pyx_t_57 &lt; 0) __pyx_t_57 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_58 &lt; 0) __pyx_t_58 += __pyx_v_xyz.shape[1];
                                    __pyx_t_59 = __pyx_v_nCi;
                                    __pyx_t_60 = 2;
                                    if (__pyx_t_59 &lt; 0) __pyx_t_59 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_60 &lt; 0) __pyx_t_60 += __pyx_v_xyz.shape[1];
                                    __pyx_t_61 = __pyx_v_nHj;
                                    __pyx_t_62 = 0;
                                    if (__pyx_t_61 &lt; 0) __pyx_t_61 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_62 &lt; 0) __pyx_t_62 += __pyx_v_xyz.shape[1];
                                    __pyx_t_63 = __pyx_v_nHj;
                                    __pyx_t_64 = 1;
                                    if (__pyx_t_63 &lt; 0) __pyx_t_63 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_64 &lt; 0) __pyx_t_64 += __pyx_v_xyz.shape[1];
                                    __pyx_t_65 = __pyx_v_nHj;
                                    __pyx_t_66 = 2;
                                    if (__pyx_t_65 &lt; 0) __pyx_t_65 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_66 &lt; 0) __pyx_t_66 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCHij = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_55 * __pyx_v_xyz.strides[0]) ) + __pyx_t_56 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_57 * __pyx_v_xyz.strides[0]) ) + __pyx_t_58 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_59 * __pyx_v_xyz.strides[0]) ) + __pyx_t_60 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_61 * __pyx_v_xyz.strides[0]) ) + __pyx_t_62 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_63 * __pyx_v_xyz.strides[0]) ) + __pyx_t_64 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_65 * __pyx_v_xyz.strides[0]) ) + __pyx_t_66 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">087</span>:                         <span class="n">binNbr</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">dCHij</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                                    __pyx_v_binNbr = ((int)(__pyx_v_dCHij / __pyx_v_binWidth));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">088</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="n">binNbr</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_67 = 0;
                                    __pyx_t_68 = __pyx_v_binNbr;
                                    if (__pyx_t_67 &lt; 0) __pyx_t_67 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_68 &lt; 0) __pyx_t_68 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_67 * __pyx_v_hPot.strides[0]) ) + __pyx_t_68 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">089</span>:                         <span class="n">dCNij</span> <span class="o">=</span> <span class="n">dist3c</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nNj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNj</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCi</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_69 = __pyx_v_nNj;
                                    __pyx_t_70 = 0;
                                    if (__pyx_t_69 &lt; 0) __pyx_t_69 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_70 &lt; 0) __pyx_t_70 += __pyx_v_xyz.shape[1];
                                    __pyx_t_71 = __pyx_v_nNj;
                                    __pyx_t_72 = 1;
                                    if (__pyx_t_71 &lt; 0) __pyx_t_71 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_72 &lt; 0) __pyx_t_72 += __pyx_v_xyz.shape[1];
                                    __pyx_t_73 = __pyx_v_nNj;
                                    __pyx_t_74 = 2;
                                    if (__pyx_t_73 &lt; 0) __pyx_t_73 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_74 &lt; 0) __pyx_t_74 += __pyx_v_xyz.shape[1];
                                    __pyx_t_75 = __pyx_v_nCi;
                                    __pyx_t_76 = 0;
                                    if (__pyx_t_75 &lt; 0) __pyx_t_75 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_76 &lt; 0) __pyx_t_76 += __pyx_v_xyz.shape[1];
                                    __pyx_t_77 = __pyx_v_nCi;
                                    __pyx_t_78 = 1;
                                    if (__pyx_t_77 &lt; 0) __pyx_t_77 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_78 &lt; 0) __pyx_t_78 += __pyx_v_xyz.shape[1];
                                    __pyx_t_79 = __pyx_v_nCi;
                                    __pyx_t_80 = 2;
                                    if (__pyx_t_79 &lt; 0) __pyx_t_79 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_80 &lt; 0) __pyx_t_80 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCNij = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_69 * __pyx_v_xyz.strides[0]) ) + __pyx_t_70 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_71 * __pyx_v_xyz.strides[0]) ) + __pyx_t_72 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_73 * __pyx_v_xyz.strides[0]) ) + __pyx_t_74 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_75 * __pyx_v_xyz.strides[0]) ) + __pyx_t_76 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_77 * __pyx_v_xyz.strides[0]) ) + __pyx_t_78 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_79 * __pyx_v_xyz.strides[0]) ) + __pyx_t_80 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">090</span>:                         <span class="n">binNbr</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">dCNij</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                                    __pyx_v_binNbr = ((int)(__pyx_v_dCNij / __pyx_v_binWidth));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">091</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">3</span><span class="p">,</span> <span class="n">binNbr</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_81 = 3;
                                    __pyx_t_82 = __pyx_v_binNbr;
                                    if (__pyx_t_81 &lt; 0) __pyx_t_81 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_82 &lt; 0) __pyx_t_82 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_81 * __pyx_v_hPot.strides[0]) ) + __pyx_t_82 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">092</span>:                     <span class="c"># j -&gt; i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">093</span>:                     <span class="n">dOHji</span> <span class="o">=</span> <span class="n">dist3c2</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nHi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHi</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span></pre>
<pre class='cython code score-0 '>                                  __pyx_t_83 = __pyx_v_nHi;
                                  __pyx_t_84 = 0;
                                  if (__pyx_t_83 &lt; 0) __pyx_t_83 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_84 &lt; 0) __pyx_t_84 += __pyx_v_xyz.shape[1];
                                  __pyx_t_85 = __pyx_v_nHi;
                                  __pyx_t_86 = 1;
                                  if (__pyx_t_85 &lt; 0) __pyx_t_85 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_86 &lt; 0) __pyx_t_86 += __pyx_v_xyz.shape[1];
                                  __pyx_t_87 = __pyx_v_nHi;
                                  __pyx_t_88 = 2;
                                  if (__pyx_t_87 &lt; 0) __pyx_t_87 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_88 &lt; 0) __pyx_t_88 += __pyx_v_xyz.shape[1];
/* … */
                                  __pyx_v_dOHji = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c2((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_83 * __pyx_v_xyz.strides[0]) ) + __pyx_t_84 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_85 * __pyx_v_xyz.strides[0]) ) + __pyx_t_86 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_87 * __pyx_v_xyz.strides[0]) ) + __pyx_t_88 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_89 * __pyx_v_xyz.strides[0]) ) + __pyx_t_90 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_91 * __pyx_v_xyz.strides[0]) ) + __pyx_t_92 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_93 * __pyx_v_xyz.strides[0]) ) + __pyx_t_94 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">094</span>:                                    <span class="n">xyz</span><span class="p">[</span><span class="n">nOj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOj</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                  __pyx_t_89 = __pyx_v_nOj;
                                  __pyx_t_90 = 0;
                                  if (__pyx_t_89 &lt; 0) __pyx_t_89 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_90 &lt; 0) __pyx_t_90 += __pyx_v_xyz.shape[1];
                                  __pyx_t_91 = __pyx_v_nOj;
                                  __pyx_t_92 = 1;
                                  if (__pyx_t_91 &lt; 0) __pyx_t_91 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_92 &lt; 0) __pyx_t_92 += __pyx_v_xyz.shape[1];
                                  __pyx_t_93 = __pyx_v_nOj;
                                  __pyx_t_94 = 2;
                                  if (__pyx_t_93 &lt; 0) __pyx_t_93 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_94 &lt; 0) __pyx_t_94 += __pyx_v_xyz.shape[1];
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">095</span>:                     <span class="k">if</span> <span class="n">dOHji</span> <span class="o">&lt;</span> <span class="n">cutoffH2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>                                  __pyx_t_17 = ((__pyx_v_dOHji &lt; __pyx_v_cutoffH2) != 0);
                                  if (__pyx_t_17) {
/* … */
                                  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">096</span>:                         <span class="n">nHBond</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>                                    __pyx_v_nHBond = (__pyx_v_nHBond + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">097</span>:                         <span class="n">binNbr</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dOHji</span><span class="p">)</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>                                    __pyx_v_binNbr = ((int)(sqrt(__pyx_v_dOHji) / __pyx_v_binWidth));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">098</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">2</span><span class="p">,</span> <span class="n">binNbr</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_95 = 2;
                                    __pyx_t_96 = __pyx_v_binNbr;
                                    if (__pyx_t_95 &lt; 0) __pyx_t_95 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_96 &lt; 0) __pyx_t_96 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_95 * __pyx_v_hPot.strides[0]) ) + __pyx_t_96 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">099</span>:                         <span class="n">dONji</span> <span class="o">=</span> <span class="n">dist3c</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nNi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNi</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOj</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_97 = __pyx_v_nNi;
                                    __pyx_t_98 = 0;
                                    if (__pyx_t_97 &lt; 0) __pyx_t_97 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_98 &lt; 0) __pyx_t_98 += __pyx_v_xyz.shape[1];
                                    __pyx_t_99 = __pyx_v_nNi;
                                    __pyx_t_100 = 1;
                                    if (__pyx_t_99 &lt; 0) __pyx_t_99 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_100 &lt; 0) __pyx_t_100 += __pyx_v_xyz.shape[1];
                                    __pyx_t_101 = __pyx_v_nNi;
                                    __pyx_t_102 = 2;
                                    if (__pyx_t_101 &lt; 0) __pyx_t_101 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_102 &lt; 0) __pyx_t_102 += __pyx_v_xyz.shape[1];
                                    __pyx_t_103 = __pyx_v_nOj;
                                    __pyx_t_104 = 0;
                                    if (__pyx_t_103 &lt; 0) __pyx_t_103 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_104 &lt; 0) __pyx_t_104 += __pyx_v_xyz.shape[1];
                                    __pyx_t_105 = __pyx_v_nOj;
                                    __pyx_t_106 = 1;
                                    if (__pyx_t_105 &lt; 0) __pyx_t_105 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_106 &lt; 0) __pyx_t_106 += __pyx_v_xyz.shape[1];
                                    __pyx_t_107 = __pyx_v_nOj;
                                    __pyx_t_108 = 2;
                                    if (__pyx_t_107 &lt; 0) __pyx_t_107 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_108 &lt; 0) __pyx_t_108 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dONji = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_97 * __pyx_v_xyz.strides[0]) ) + __pyx_t_98 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_99 * __pyx_v_xyz.strides[0]) ) + __pyx_t_100 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_101 * __pyx_v_xyz.strides[0]) ) + __pyx_t_102 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_103 * __pyx_v_xyz.strides[0]) ) + __pyx_t_104 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_105 * __pyx_v_xyz.strides[0]) ) + __pyx_t_106 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_107 * __pyx_v_xyz.strides[0]) ) + __pyx_t_108 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">100</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">dONji</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_109 = 1;
                                    __pyx_t_110 = ((int)(__pyx_v_dONji / __pyx_v_binWidth));
                                    if (__pyx_t_109 &lt; 0) __pyx_t_109 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_110 &lt; 0) __pyx_t_110 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_109 * __pyx_v_hPot.strides[0]) ) + __pyx_t_110 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">101</span>:                         <span class="n">dCHji</span> <span class="o">=</span> <span class="n">dist3c</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nCj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCj</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHi</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_111 = __pyx_v_nCj;
                                    __pyx_t_112 = 0;
                                    if (__pyx_t_111 &lt; 0) __pyx_t_111 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_112 &lt; 0) __pyx_t_112 += __pyx_v_xyz.shape[1];
                                    __pyx_t_113 = __pyx_v_nCj;
                                    __pyx_t_114 = 1;
                                    if (__pyx_t_113 &lt; 0) __pyx_t_113 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_114 &lt; 0) __pyx_t_114 += __pyx_v_xyz.shape[1];
                                    __pyx_t_115 = __pyx_v_nCj;
                                    __pyx_t_116 = 2;
                                    if (__pyx_t_115 &lt; 0) __pyx_t_115 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_116 &lt; 0) __pyx_t_116 += __pyx_v_xyz.shape[1];
                                    __pyx_t_117 = __pyx_v_nHi;
                                    __pyx_t_118 = 0;
                                    if (__pyx_t_117 &lt; 0) __pyx_t_117 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_118 &lt; 0) __pyx_t_118 += __pyx_v_xyz.shape[1];
                                    __pyx_t_119 = __pyx_v_nHi;
                                    __pyx_t_120 = 1;
                                    if (__pyx_t_119 &lt; 0) __pyx_t_119 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_120 &lt; 0) __pyx_t_120 += __pyx_v_xyz.shape[1];
                                    __pyx_t_121 = __pyx_v_nHi;
                                    __pyx_t_122 = 2;
                                    if (__pyx_t_121 &lt; 0) __pyx_t_121 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_122 &lt; 0) __pyx_t_122 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCHji = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_111 * __pyx_v_xyz.strides[0]) ) + __pyx_t_112 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_113 * __pyx_v_xyz.strides[0]) ) + __pyx_t_114 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_115 * __pyx_v_xyz.strides[0]) ) + __pyx_t_116 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_117 * __pyx_v_xyz.strides[0]) ) + __pyx_t_118 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_119 * __pyx_v_xyz.strides[0]) ) + __pyx_t_120 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_121 * __pyx_v_xyz.strides[0]) ) + __pyx_t_122 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">102</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">dCHji</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_123 = 0;
                                    __pyx_t_124 = ((int)(__pyx_v_dCHji / __pyx_v_binWidth));
                                    if (__pyx_t_123 &lt; 0) __pyx_t_123 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_124 &lt; 0) __pyx_t_124 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_123 * __pyx_v_hPot.strides[0]) ) + __pyx_t_124 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">103</span>:                         <span class="n">dCNji</span> <span class="o">=</span> <span class="n">dist3c</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nNi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNi</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCj</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_125 = __pyx_v_nNi;
                                    __pyx_t_126 = 0;
                                    if (__pyx_t_125 &lt; 0) __pyx_t_125 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_126 &lt; 0) __pyx_t_126 += __pyx_v_xyz.shape[1];
                                    __pyx_t_127 = __pyx_v_nNi;
                                    __pyx_t_128 = 1;
                                    if (__pyx_t_127 &lt; 0) __pyx_t_127 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_128 &lt; 0) __pyx_t_128 += __pyx_v_xyz.shape[1];
                                    __pyx_t_129 = __pyx_v_nNi;
                                    __pyx_t_130 = 2;
                                    if (__pyx_t_129 &lt; 0) __pyx_t_129 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_130 &lt; 0) __pyx_t_130 += __pyx_v_xyz.shape[1];
                                    __pyx_t_131 = __pyx_v_nCj;
                                    __pyx_t_132 = 0;
                                    if (__pyx_t_131 &lt; 0) __pyx_t_131 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_132 &lt; 0) __pyx_t_132 += __pyx_v_xyz.shape[1];
                                    __pyx_t_133 = __pyx_v_nCj;
                                    __pyx_t_134 = 1;
                                    if (__pyx_t_133 &lt; 0) __pyx_t_133 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_134 &lt; 0) __pyx_t_134 += __pyx_v_xyz.shape[1];
                                    __pyx_t_135 = __pyx_v_nCj;
                                    __pyx_t_136 = 2;
                                    if (__pyx_t_135 &lt; 0) __pyx_t_135 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_136 &lt; 0) __pyx_t_136 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCNji = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_125 * __pyx_v_xyz.strides[0]) ) + __pyx_t_126 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_127 * __pyx_v_xyz.strides[0]) ) + __pyx_t_128 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_129 * __pyx_v_xyz.strides[0]) ) + __pyx_t_130 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_131 * __pyx_v_xyz.strides[0]) ) + __pyx_t_132 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_133 * __pyx_v_xyz.strides[0]) ) + __pyx_t_134 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_135 * __pyx_v_xyz.strides[0]) ) + __pyx_t_136 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">104</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">3</span><span class="p">,</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">dCNji</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_137 = 3;
                                    __pyx_t_138 = ((int)(__pyx_v_dCNji / __pyx_v_binWidth));
                                    if (__pyx_t_137 &lt; 0) __pyx_t_137 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_138 &lt; 0) __pyx_t_138 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_137 * __pyx_v_hPot.strides[0]) ) + __pyx_t_138 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">105</span>:                 <span class="k">elif</span> <span class="p">(</span><span class="n">nHj</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nHi</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                                __pyx_t_26 = ((__pyx_v_nHj &gt; 0) != 0);
                                if (__pyx_t_26) {
                                } else {
                                  __pyx_t_17 = __pyx_t_26;
                                  goto __pyx_L18_bool_binop_done;
                                }
                                __pyx_t_26 = ((__pyx_v_nHi &lt; 0) != 0);
                                __pyx_t_17 = __pyx_t_26;
                                __pyx_L18_bool_binop_done:;
                                if (__pyx_t_17) {
/* … */
                                  goto __pyx_L13;
                                }
</pre><pre class="cython line score-0">&#xA0;<span class="">106</span>:                     <span class="c"># j -&gt; i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">107</span>:                     <span class="n">dOHij</span> <span class="o">=</span> <span class="n">dist3c2</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nHj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHj</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOi</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                  __pyx_t_139 = __pyx_v_nHj;
                                  __pyx_t_140 = 0;
                                  if (__pyx_t_139 &lt; 0) __pyx_t_139 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_140 &lt; 0) __pyx_t_140 += __pyx_v_xyz.shape[1];
                                  __pyx_t_141 = __pyx_v_nHj;
                                  __pyx_t_142 = 1;
                                  if (__pyx_t_141 &lt; 0) __pyx_t_141 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_142 &lt; 0) __pyx_t_142 += __pyx_v_xyz.shape[1];
                                  __pyx_t_143 = __pyx_v_nHj;
                                  __pyx_t_144 = 2;
                                  if (__pyx_t_143 &lt; 0) __pyx_t_143 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_144 &lt; 0) __pyx_t_144 += __pyx_v_xyz.shape[1];
                                  __pyx_t_145 = __pyx_v_nOi;
                                  __pyx_t_146 = 0;
                                  if (__pyx_t_145 &lt; 0) __pyx_t_145 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_146 &lt; 0) __pyx_t_146 += __pyx_v_xyz.shape[1];
                                  __pyx_t_147 = __pyx_v_nOi;
                                  __pyx_t_148 = 1;
                                  if (__pyx_t_147 &lt; 0) __pyx_t_147 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_148 &lt; 0) __pyx_t_148 += __pyx_v_xyz.shape[1];
                                  __pyx_t_149 = __pyx_v_nOi;
                                  __pyx_t_150 = 2;
                                  if (__pyx_t_149 &lt; 0) __pyx_t_149 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_150 &lt; 0) __pyx_t_150 += __pyx_v_xyz.shape[1];
                                  __pyx_v_dOHij = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c2((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_139 * __pyx_v_xyz.strides[0]) ) + __pyx_t_140 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_141 * __pyx_v_xyz.strides[0]) ) + __pyx_t_142 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_143 * __pyx_v_xyz.strides[0]) ) + __pyx_t_144 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_145 * __pyx_v_xyz.strides[0]) ) + __pyx_t_146 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_147 * __pyx_v_xyz.strides[0]) ) + __pyx_t_148 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_149 * __pyx_v_xyz.strides[0]) ) + __pyx_t_150 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">108</span>:                     <span class="k">if</span> <span class="n">dOHij</span> <span class="o">&lt;</span> <span class="n">cutoffH2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>                                  __pyx_t_17 = ((__pyx_v_dOHij &lt; __pyx_v_cutoffH2) != 0);
                                  if (__pyx_t_17) {
/* … */
                                  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">109</span>:                         <span class="n">nHBond</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>                                    __pyx_v_nHBond = (__pyx_v_nHBond + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">110</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">2</span><span class="p">,</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dOHij</span><span class="p">)</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_151 = 2;
                                    __pyx_t_152 = ((int)(sqrt(__pyx_v_dOHij) / __pyx_v_binWidth));
                                    if (__pyx_t_151 &lt; 0) __pyx_t_151 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_152 &lt; 0) __pyx_t_152 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_151 * __pyx_v_hPot.strides[0]) ) + __pyx_t_152 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">111</span>:                         <span class="n">dONij</span> <span class="o">=</span> <span class="n">dist3c</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nNj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNj</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOi</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_153 = __pyx_v_nNj;
                                    __pyx_t_154 = 0;
                                    if (__pyx_t_153 &lt; 0) __pyx_t_153 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_154 &lt; 0) __pyx_t_154 += __pyx_v_xyz.shape[1];
                                    __pyx_t_155 = __pyx_v_nNj;
                                    __pyx_t_156 = 1;
                                    if (__pyx_t_155 &lt; 0) __pyx_t_155 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_156 &lt; 0) __pyx_t_156 += __pyx_v_xyz.shape[1];
                                    __pyx_t_157 = __pyx_v_nNj;
                                    __pyx_t_158 = 2;
                                    if (__pyx_t_157 &lt; 0) __pyx_t_157 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_158 &lt; 0) __pyx_t_158 += __pyx_v_xyz.shape[1];
                                    __pyx_t_159 = __pyx_v_nOi;
                                    __pyx_t_160 = 0;
                                    if (__pyx_t_159 &lt; 0) __pyx_t_159 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_160 &lt; 0) __pyx_t_160 += __pyx_v_xyz.shape[1];
                                    __pyx_t_161 = __pyx_v_nOi;
                                    __pyx_t_162 = 1;
                                    if (__pyx_t_161 &lt; 0) __pyx_t_161 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_162 &lt; 0) __pyx_t_162 += __pyx_v_xyz.shape[1];
                                    __pyx_t_163 = __pyx_v_nOi;
                                    __pyx_t_164 = 2;
                                    if (__pyx_t_163 &lt; 0) __pyx_t_163 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_164 &lt; 0) __pyx_t_164 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dONij = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_153 * __pyx_v_xyz.strides[0]) ) + __pyx_t_154 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_155 * __pyx_v_xyz.strides[0]) ) + __pyx_t_156 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_157 * __pyx_v_xyz.strides[0]) ) + __pyx_t_158 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_159 * __pyx_v_xyz.strides[0]) ) + __pyx_t_160 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_161 * __pyx_v_xyz.strides[0]) ) + __pyx_t_162 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_163 * __pyx_v_xyz.strides[0]) ) + __pyx_t_164 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">112</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">dONij</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_165 = 1;
                                    __pyx_t_166 = ((int)(__pyx_v_dONij / __pyx_v_binWidth));
                                    if (__pyx_t_165 &lt; 0) __pyx_t_165 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_166 &lt; 0) __pyx_t_166 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_165 * __pyx_v_hPot.strides[0]) ) + __pyx_t_166 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">113</span>:                         <span class="n">dCHij</span> <span class="o">=</span> <span class="n">dist3c</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nCi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCi</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHj</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_167 = __pyx_v_nCi;
                                    __pyx_t_168 = 0;
                                    if (__pyx_t_167 &lt; 0) __pyx_t_167 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_168 &lt; 0) __pyx_t_168 += __pyx_v_xyz.shape[1];
                                    __pyx_t_169 = __pyx_v_nCi;
                                    __pyx_t_170 = 1;
                                    if (__pyx_t_169 &lt; 0) __pyx_t_169 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_170 &lt; 0) __pyx_t_170 += __pyx_v_xyz.shape[1];
                                    __pyx_t_171 = __pyx_v_nCi;
                                    __pyx_t_172 = 2;
                                    if (__pyx_t_171 &lt; 0) __pyx_t_171 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_172 &lt; 0) __pyx_t_172 += __pyx_v_xyz.shape[1];
                                    __pyx_t_173 = __pyx_v_nHj;
                                    __pyx_t_174 = 0;
                                    if (__pyx_t_173 &lt; 0) __pyx_t_173 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_174 &lt; 0) __pyx_t_174 += __pyx_v_xyz.shape[1];
                                    __pyx_t_175 = __pyx_v_nHj;
                                    __pyx_t_176 = 1;
                                    if (__pyx_t_175 &lt; 0) __pyx_t_175 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_176 &lt; 0) __pyx_t_176 += __pyx_v_xyz.shape[1];
                                    __pyx_t_177 = __pyx_v_nHj;
                                    __pyx_t_178 = 2;
                                    if (__pyx_t_177 &lt; 0) __pyx_t_177 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_178 &lt; 0) __pyx_t_178 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCHij = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_167 * __pyx_v_xyz.strides[0]) ) + __pyx_t_168 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_169 * __pyx_v_xyz.strides[0]) ) + __pyx_t_170 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_171 * __pyx_v_xyz.strides[0]) ) + __pyx_t_172 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_173 * __pyx_v_xyz.strides[0]) ) + __pyx_t_174 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_175 * __pyx_v_xyz.strides[0]) ) + __pyx_t_176 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_177 * __pyx_v_xyz.strides[0]) ) + __pyx_t_178 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">114</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">dCHij</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_179 = 0;
                                    __pyx_t_180 = ((int)(__pyx_v_dCHij / __pyx_v_binWidth));
                                    if (__pyx_t_179 &lt; 0) __pyx_t_179 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_180 &lt; 0) __pyx_t_180 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_179 * __pyx_v_hPot.strides[0]) ) + __pyx_t_180 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>:                         <span class="n">dCNij</span> <span class="o">=</span> <span class="n">dist3c</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nNj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNj</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCi</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_181 = __pyx_v_nNj;
                                    __pyx_t_182 = 0;
                                    if (__pyx_t_181 &lt; 0) __pyx_t_181 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_182 &lt; 0) __pyx_t_182 += __pyx_v_xyz.shape[1];
                                    __pyx_t_183 = __pyx_v_nNj;
                                    __pyx_t_184 = 1;
                                    if (__pyx_t_183 &lt; 0) __pyx_t_183 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_184 &lt; 0) __pyx_t_184 += __pyx_v_xyz.shape[1];
                                    __pyx_t_185 = __pyx_v_nNj;
                                    __pyx_t_186 = 2;
                                    if (__pyx_t_185 &lt; 0) __pyx_t_185 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_186 &lt; 0) __pyx_t_186 += __pyx_v_xyz.shape[1];
                                    __pyx_t_187 = __pyx_v_nCi;
                                    __pyx_t_188 = 0;
                                    if (__pyx_t_187 &lt; 0) __pyx_t_187 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_188 &lt; 0) __pyx_t_188 += __pyx_v_xyz.shape[1];
                                    __pyx_t_189 = __pyx_v_nCi;
                                    __pyx_t_190 = 1;
                                    if (__pyx_t_189 &lt; 0) __pyx_t_189 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_190 &lt; 0) __pyx_t_190 += __pyx_v_xyz.shape[1];
                                    __pyx_t_191 = __pyx_v_nCi;
                                    __pyx_t_192 = 2;
                                    if (__pyx_t_191 &lt; 0) __pyx_t_191 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_192 &lt; 0) __pyx_t_192 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCNij = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_181 * __pyx_v_xyz.strides[0]) ) + __pyx_t_182 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_183 * __pyx_v_xyz.strides[0]) ) + __pyx_t_184 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_185 * __pyx_v_xyz.strides[0]) ) + __pyx_t_186 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_187 * __pyx_v_xyz.strides[0]) ) + __pyx_t_188 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_189 * __pyx_v_xyz.strides[0]) ) + __pyx_t_190 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_191 * __pyx_v_xyz.strides[0]) ) + __pyx_t_192 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">116</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">3</span><span class="p">,</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">dCNij</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_193 = 3;
                                    __pyx_t_194 = ((int)(__pyx_v_dCNij / __pyx_v_binWidth));
                                    if (__pyx_t_193 &lt; 0) __pyx_t_193 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_194 &lt; 0) __pyx_t_194 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_193 * __pyx_v_hPot.strides[0]) ) + __pyx_t_194 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">117</span>:                         <span class="c"># j -&gt; i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">118</span>:                 <span class="k">elif</span> <span class="p">(</span><span class="n">nHj</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">nHi</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>                                __pyx_t_26 = ((__pyx_v_nHj &lt; 0) != 0);
                                if (__pyx_t_26) {
                                } else {
                                  __pyx_t_17 = __pyx_t_26;
                                  goto __pyx_L21_bool_binop_done;
                                }
                                __pyx_t_26 = ((__pyx_v_nHi &gt; 0) != 0);
                                __pyx_t_17 = __pyx_t_26;
                                __pyx_L21_bool_binop_done:;
                                if (__pyx_t_17) {
/* … */
                                }
                                __pyx_L13:;
</pre><pre class="cython line score-0">&#xA0;<span class="">119</span>:                     <span class="c"># i -&gt; j</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">120</span>:                     <span class="n">dOHji</span> <span class="o">=</span> <span class="n">dist3c2</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nHi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHi</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOj</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                  __pyx_t_195 = __pyx_v_nHi;
                                  __pyx_t_196 = 0;
                                  if (__pyx_t_195 &lt; 0) __pyx_t_195 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_196 &lt; 0) __pyx_t_196 += __pyx_v_xyz.shape[1];
                                  __pyx_t_197 = __pyx_v_nHi;
                                  __pyx_t_198 = 1;
                                  if (__pyx_t_197 &lt; 0) __pyx_t_197 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_198 &lt; 0) __pyx_t_198 += __pyx_v_xyz.shape[1];
                                  __pyx_t_199 = __pyx_v_nHi;
                                  __pyx_t_200 = 2;
                                  if (__pyx_t_199 &lt; 0) __pyx_t_199 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_200 &lt; 0) __pyx_t_200 += __pyx_v_xyz.shape[1];
                                  __pyx_t_201 = __pyx_v_nOj;
                                  __pyx_t_202 = 0;
                                  if (__pyx_t_201 &lt; 0) __pyx_t_201 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_202 &lt; 0) __pyx_t_202 += __pyx_v_xyz.shape[1];
                                  __pyx_t_203 = __pyx_v_nOj;
                                  __pyx_t_204 = 1;
                                  if (__pyx_t_203 &lt; 0) __pyx_t_203 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_204 &lt; 0) __pyx_t_204 += __pyx_v_xyz.shape[1];
                                  __pyx_t_205 = __pyx_v_nOj;
                                  __pyx_t_206 = 2;
                                  if (__pyx_t_205 &lt; 0) __pyx_t_205 += __pyx_v_xyz.shape[0];
                                  if (__pyx_t_206 &lt; 0) __pyx_t_206 += __pyx_v_xyz.shape[1];
                                  __pyx_v_dOHji = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c2((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_195 * __pyx_v_xyz.strides[0]) ) + __pyx_t_196 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_197 * __pyx_v_xyz.strides[0]) ) + __pyx_t_198 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_199 * __pyx_v_xyz.strides[0]) ) + __pyx_t_200 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_201 * __pyx_v_xyz.strides[0]) ) + __pyx_t_202 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_203 * __pyx_v_xyz.strides[0]) ) + __pyx_t_204 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_205 * __pyx_v_xyz.strides[0]) ) + __pyx_t_206 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">121</span>:                     <span class="k">if</span> <span class="n">dOHji</span> <span class="o">&lt;</span> <span class="n">cutoffH2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>                                  __pyx_t_17 = ((__pyx_v_dOHji &lt; __pyx_v_cutoffH2) != 0);
                                  if (__pyx_t_17) {
/* … */
                                  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">122</span>:                         <span class="n">nHBond</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>                                    __pyx_v_nHBond = (__pyx_v_nHBond + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">123</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">2</span><span class="p">,</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">dOHji</span><span class="p">)</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_207 = 2;
                                    __pyx_t_208 = ((int)(sqrt(__pyx_v_dOHji) / __pyx_v_binWidth));
                                    if (__pyx_t_207 &lt; 0) __pyx_t_207 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_208 &lt; 0) __pyx_t_208 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_207 * __pyx_v_hPot.strides[0]) ) + __pyx_t_208 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">124</span>:                         <span class="n">dONji</span> <span class="o">=</span> <span class="n">dist3c</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nNi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNi</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nOj</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_209 = __pyx_v_nNi;
                                    __pyx_t_210 = 0;
                                    if (__pyx_t_209 &lt; 0) __pyx_t_209 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_210 &lt; 0) __pyx_t_210 += __pyx_v_xyz.shape[1];
                                    __pyx_t_211 = __pyx_v_nNi;
                                    __pyx_t_212 = 1;
                                    if (__pyx_t_211 &lt; 0) __pyx_t_211 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_212 &lt; 0) __pyx_t_212 += __pyx_v_xyz.shape[1];
                                    __pyx_t_213 = __pyx_v_nNi;
                                    __pyx_t_214 = 2;
                                    if (__pyx_t_213 &lt; 0) __pyx_t_213 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_214 &lt; 0) __pyx_t_214 += __pyx_v_xyz.shape[1];
                                    __pyx_t_215 = __pyx_v_nOj;
                                    __pyx_t_216 = 0;
                                    if (__pyx_t_215 &lt; 0) __pyx_t_215 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_216 &lt; 0) __pyx_t_216 += __pyx_v_xyz.shape[1];
                                    __pyx_t_217 = __pyx_v_nOj;
                                    __pyx_t_218 = 1;
                                    if (__pyx_t_217 &lt; 0) __pyx_t_217 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_218 &lt; 0) __pyx_t_218 += __pyx_v_xyz.shape[1];
                                    __pyx_t_219 = __pyx_v_nOj;
                                    __pyx_t_220 = 2;
                                    if (__pyx_t_219 &lt; 0) __pyx_t_219 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_220 &lt; 0) __pyx_t_220 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dONji = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_209 * __pyx_v_xyz.strides[0]) ) + __pyx_t_210 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_211 * __pyx_v_xyz.strides[0]) ) + __pyx_t_212 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_213 * __pyx_v_xyz.strides[0]) ) + __pyx_t_214 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_215 * __pyx_v_xyz.strides[0]) ) + __pyx_t_216 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_217 * __pyx_v_xyz.strides[0]) ) + __pyx_t_218 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_219 * __pyx_v_xyz.strides[0]) ) + __pyx_t_220 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">125</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">1</span><span class="p">,</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">dONji</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_221 = 1;
                                    __pyx_t_222 = ((int)(__pyx_v_dONji / __pyx_v_binWidth));
                                    if (__pyx_t_221 &lt; 0) __pyx_t_221 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_222 &lt; 0) __pyx_t_222 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_221 * __pyx_v_hPot.strides[0]) ) + __pyx_t_222 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">126</span>:                         <span class="n">dCHji</span> <span class="o">=</span> <span class="n">dist3c</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nCj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCj</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nHi</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_223 = __pyx_v_nCj;
                                    __pyx_t_224 = 0;
                                    if (__pyx_t_223 &lt; 0) __pyx_t_223 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_224 &lt; 0) __pyx_t_224 += __pyx_v_xyz.shape[1];
                                    __pyx_t_225 = __pyx_v_nCj;
                                    __pyx_t_226 = 1;
                                    if (__pyx_t_225 &lt; 0) __pyx_t_225 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_226 &lt; 0) __pyx_t_226 += __pyx_v_xyz.shape[1];
                                    __pyx_t_227 = __pyx_v_nCj;
                                    __pyx_t_228 = 2;
                                    if (__pyx_t_227 &lt; 0) __pyx_t_227 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_228 &lt; 0) __pyx_t_228 += __pyx_v_xyz.shape[1];
                                    __pyx_t_229 = __pyx_v_nHi;
                                    __pyx_t_230 = 0;
                                    if (__pyx_t_229 &lt; 0) __pyx_t_229 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_230 &lt; 0) __pyx_t_230 += __pyx_v_xyz.shape[1];
                                    __pyx_t_231 = __pyx_v_nHi;
                                    __pyx_t_232 = 1;
                                    if (__pyx_t_231 &lt; 0) __pyx_t_231 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_232 &lt; 0) __pyx_t_232 += __pyx_v_xyz.shape[1];
                                    __pyx_t_233 = __pyx_v_nHi;
                                    __pyx_t_234 = 2;
                                    if (__pyx_t_233 &lt; 0) __pyx_t_233 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_234 &lt; 0) __pyx_t_234 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCHji = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_223 * __pyx_v_xyz.strides[0]) ) + __pyx_t_224 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_225 * __pyx_v_xyz.strides[0]) ) + __pyx_t_226 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_227 * __pyx_v_xyz.strides[0]) ) + __pyx_t_228 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_229 * __pyx_v_xyz.strides[0]) ) + __pyx_t_230 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_231 * __pyx_v_xyz.strides[0]) ) + __pyx_t_232 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_233 * __pyx_v_xyz.strides[0]) ) + __pyx_t_234 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">dCHji</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_235 = 0;
                                    __pyx_t_236 = ((int)(__pyx_v_dCHji / __pyx_v_binWidth));
                                    if (__pyx_t_235 &lt; 0) __pyx_t_235 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_236 &lt; 0) __pyx_t_236 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_235 * __pyx_v_hPot.strides[0]) ) + __pyx_t_236 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">128</span>:                         <span class="n">dCNji</span> <span class="o">=</span> <span class="n">dist3c</span><span class="p">(</span><span class="n">xyz</span><span class="p">[</span><span class="n">nNi</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNi</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nNi</span><span class="p">,</span> <span class="mf">2</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCj</span><span class="p">,</span> <span class="mf">0</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCj</span><span class="p">,</span> <span class="mf">1</span><span class="p">],</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCj</span><span class="p">,</span> <span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_237 = __pyx_v_nNi;
                                    __pyx_t_238 = 0;
                                    if (__pyx_t_237 &lt; 0) __pyx_t_237 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_238 &lt; 0) __pyx_t_238 += __pyx_v_xyz.shape[1];
                                    __pyx_t_239 = __pyx_v_nNi;
                                    __pyx_t_240 = 1;
                                    if (__pyx_t_239 &lt; 0) __pyx_t_239 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_240 &lt; 0) __pyx_t_240 += __pyx_v_xyz.shape[1];
                                    __pyx_t_241 = __pyx_v_nNi;
                                    __pyx_t_242 = 2;
                                    if (__pyx_t_241 &lt; 0) __pyx_t_241 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_242 &lt; 0) __pyx_t_242 += __pyx_v_xyz.shape[1];
                                    __pyx_t_243 = __pyx_v_nCj;
                                    __pyx_t_244 = 0;
                                    if (__pyx_t_243 &lt; 0) __pyx_t_243 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_244 &lt; 0) __pyx_t_244 += __pyx_v_xyz.shape[1];
                                    __pyx_t_245 = __pyx_v_nCj;
                                    __pyx_t_246 = 1;
                                    if (__pyx_t_245 &lt; 0) __pyx_t_245 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_246 &lt; 0) __pyx_t_246 += __pyx_v_xyz.shape[1];
                                    __pyx_t_247 = __pyx_v_nCj;
                                    __pyx_t_248 = 2;
                                    if (__pyx_t_247 &lt; 0) __pyx_t_247 += __pyx_v_xyz.shape[0];
                                    if (__pyx_t_248 &lt; 0) __pyx_t_248 += __pyx_v_xyz.shape[1];
                                    __pyx_v_dCNji = __pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_237 * __pyx_v_xyz.strides[0]) ) + __pyx_t_238 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_239 * __pyx_v_xyz.strides[0]) ) + __pyx_t_240 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_241 * __pyx_v_xyz.strides[0]) ) + __pyx_t_242 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_243 * __pyx_v_xyz.strides[0]) ) + __pyx_t_244 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_245 * __pyx_v_xyz.strides[0]) ) + __pyx_t_246 * __pyx_v_xyz.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_247 * __pyx_v_xyz.strides[0]) ) + __pyx_t_248 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">129</span>:                         <span class="n">E</span> <span class="o">+=</span> <span class="n">hPot</span><span class="p">[</span><span class="mf">3</span><span class="p">,</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;(</span><span class="n">dCNji</span> <span class="o">/</span> <span class="n">binWidth</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>                                    __pyx_t_249 = 3;
                                    __pyx_t_250 = ((int)(__pyx_v_dCNji / __pyx_v_binWidth));
                                    if (__pyx_t_249 &lt; 0) __pyx_t_249 += __pyx_v_hPot.shape[0];
                                    if (__pyx_t_250 &lt; 0) __pyx_t_250 += __pyx_v_hPot.shape[1];
                                    __pyx_v_E = (__pyx_v_E + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_hPot.data + __pyx_t_249 * __pyx_v_hPot.strides[0]) ) + __pyx_t_250 * __pyx_v_hPot.strides[1]) ))));
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">130</span>:     <span class="k">return</span> <span class="n">nHBond</span><span class="p">,</span> <span class="n">E</span></pre>
<pre class='cython code score-15 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_251 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nHBond);<span class='error_goto'> if (unlikely(!__pyx_t_251)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_251);
  __pyx_t_252 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E);<span class='error_goto'> if (unlikely(!__pyx_t_252)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_252);
  __pyx_t_253 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_253)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_253);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_251);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_253, 0, __pyx_t_251);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_252);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_253, 1, __pyx_t_252);
  __pyx_t_251 = 0;
  __pyx_t_252 = 0;
  __pyx_r = __pyx_t_253;
  __pyx_t_253 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">131</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">132</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">133</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">134</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-78" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>: <span class="k">def</span> <span class="nf">gb</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">rAtoms</span><span class="p">,</span> <span class="n">double</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">double</span> <span class="n">epsilon0</span> <span class="o">=</span> <span class="mf">80.1</span><span class="p">,</span> <span class="n">double</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">12.0</span><span class="p">):</span></pre>
<pre class='cython code score-78 '>/* Python wrapper */
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_5gb(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3mfm_9structure_9potential_11cPotentials_4gb[] = "\n    Generalized Born http://en.wikipedia.org/wiki/Implicit_solvation\n    with cutoff-potential potential shifted by value at cutoff to smooth the energy\n    :param rAtoms: atom-list\n    :param epsilon: dielectric constant of proteins: 2-40\n    :param epsilon0: dielectric constant of water 80.1\n    :param cutoff: cutoff-distance in Angstrom\n    :return:\n    ";
static PyMethodDef __pyx_mdef_3mfm_9structure_9potential_11cPotentials_5gb = {"gb", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_3mfm_9structure_9potential_11cPotentials_5gb, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3mfm_9structure_9potential_11cPotentials_4gb};
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_5gb(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_rAtoms = 0;
  double __pyx_v_epsilon;
  double __pyx_v_epsilon0;
  double __pyx_v_cutoff;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("gb (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_rAtoms,&amp;__pyx_n_s_epsilon,&amp;__pyx_n_s_epsilon0,&amp;__pyx_n_s_cutoff,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_rAtoms)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_epsilon);
          if (value) { values[1] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_epsilon0);
          if (value) { values[2] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cutoff);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "gb") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_rAtoms = ((PyArrayObject *)values[0]);
    if (values[1]) {
      __pyx_v_epsilon = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_epsilon == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L3_error)</span>
    } else {
      __pyx_v_epsilon = ((double)4.0);
    }
    if (values[2]) {
      __pyx_v_epsilon0 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_epsilon0 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L3_error)</span>
    } else {
      __pyx_v_epsilon0 = ((double)80.1);
    }
    if (values[3]) {
      __pyx_v_cutoff = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_cutoff == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L3_error)</span>
    } else {
      __pyx_v_cutoff = ((double)12.0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gb", 0, 1, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.gb", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_rAtoms), __pyx_ptype_5numpy_ndarray, 1, "rAtoms", 0))) <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_3mfm_9structure_9potential_11cPotentials_4gb(__pyx_self, __pyx_v_rAtoms, __pyx_v_epsilon, __pyx_v_epsilon0, __pyx_v_cutoff);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3mfm_9structure_9potential_11cPotentials_4gb(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_rAtoms, double __pyx_v_epsilon, double __pyx_v_epsilon0, double __pyx_v_cutoff) {
  int __pyx_v_nAtoms;
  double __pyx_v_cutoff2;
  __Pyx_memviewslice __pyx_v_rs = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_aRadii = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_aCharges = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_pre;
  double __pyx_v_E;
  double __pyx_v_fgbr;
  double __pyx_v_D;
  double __pyx_v_fgbc;
  double __pyx_v_r1x;
  double __pyx_v_r1y;
  double __pyx_v_r1z;
  double __pyx_v_r2x;
  double __pyx_v_r2y;
  double __pyx_v_r2z;
  double __pyx_v_rij2;
  double __pyx_v_ai;
  double __pyx_v_aj;
  double __pyx_v_qi;
  double __pyx_v_qj;
  double __pyx_v_qij;
  double __pyx_v_aij2;
  int __pyx_v_i;
  int __pyx_v_j;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("gb", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.gb", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rs, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_aRadii, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_aCharges, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__30 = <span class='py_c_api'>PyTuple_Pack</span>(31, __pyx_n_s_rAtoms, __pyx_n_s_epsilon, __pyx_n_s_epsilon0, __pyx_n_s_cutoff, __pyx_n_s_nAtoms, __pyx_n_s_cutoff2, __pyx_n_s_rs, __pyx_n_s_aRadii, __pyx_n_s_aCharges, __pyx_n_s_pre, __pyx_n_s_E, __pyx_n_s_fgbr, __pyx_n_s_D, __pyx_n_s_fgbc, __pyx_n_s_r1x, __pyx_n_s_r1y, __pyx_n_s_r1z, __pyx_n_s_r2x, __pyx_n_s_r2y, __pyx_n_s_r2z, __pyx_n_s_rij, __pyx_n_s_rij2, __pyx_n_s_ai, __pyx_n_s_aj, __pyx_n_s_qi, __pyx_n_s_qj, __pyx_n_s_qij, __pyx_n_s_aij, __pyx_n_s_aij2, __pyx_n_s_i, __pyx_n_s_j);<span class='error_goto'> if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__30);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__30);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3mfm_9structure_9potential_11cPotentials_5gb, NULL, __pyx_n_s_mfm_structure_potential_cPotenti_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_gb, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__31 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 31, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__30, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_mfm_structure_potential_cPotenti, __pyx_n_s_gb, 135, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__31)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">136</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">137</span>: <span class="sd">    Generalized Born http://en.wikipedia.org/wiki/Implicit_solvation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">138</span>: <span class="sd">    with cutoff-potential potential shifted by value at cutoff to smooth the energy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">139</span>: <span class="sd">    :param rAtoms: atom-list</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">140</span>: <span class="sd">    :param epsilon: dielectric constant of proteins: 2-40</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">141</span>: <span class="sd">    :param epsilon0: dielectric constant of water 80.1</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">142</span>: <span class="sd">    :param cutoff: cutoff-distance in Angstrom</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">143</span>: <span class="sd">    :return:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">144</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">145</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">146</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">nAtoms</span> <span class="o">=</span> <span class="n">rAtoms</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nAtoms = (__pyx_v_rAtoms-&gt;dimensions[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">147</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">cutoff2</span> <span class="o">=</span> <span class="n">cutoff</span> <span class="o">**</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>  __pyx_v_cutoff2 = pow(__pyx_v_cutoff, 2.0);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">148</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">rAtoms</span><span class="p">[</span><span class="s">&#39;coord&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_rAtoms), __pyx_n_s_coord);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 148, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 148, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_rs = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">149</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">aRadii</span> <span class="o">=</span> <span class="n">rAtoms</span><span class="p">[</span><span class="s">&#39;radius&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_rAtoms), __pyx_n_s_radius);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_aRadii = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">150</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:]</span> <span class="n">aCharges</span> <span class="o">=</span> <span class="n">rAtoms</span><span class="p">[</span><span class="s">&#39;charge&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_rAtoms), __pyx_n_s_charge);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_aCharges = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">pre</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mf">8</span> <span class="o">*</span> <span class="mf">3.14159265359</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">epsilon0</span> <span class="o">-</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">epsilon</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_pre = ((1. / (8.0 * 3.14159265359)) * ((1. / __pyx_v_epsilon0) - (1. / __pyx_v_epsilon)));
</pre><pre class="cython line score-0">&#xA0;<span class="">152</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E</span><span class="p">,</span> <span class="nf">fgbr</span><span class="p">,</span> <span class="nf">D</span><span class="p">,</span> <span class="nf">fgbc</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">153</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">r1x</span><span class="p">,</span> <span class="nf">r1y</span><span class="p">,</span> <span class="nf">r1z</span><span class="p">,</span> <span class="nf">r2x</span><span class="p">,</span> <span class="nf">r2y</span><span class="p">,</span> <span class="nf">r2z</span><span class="p">,</span> <span class="nf">rij</span><span class="p">,</span> <span class="nf">rij2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">154</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">ai</span><span class="p">,</span> <span class="nf">aj</span><span class="p">,</span> <span class="nf">qi</span><span class="p">,</span> <span class="nf">qj</span><span class="p">,</span> <span class="nf">qij</span><span class="p">,</span> <span class="nf">aij</span><span class="p">,</span> <span class="nf">aij2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">155</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">156</span>:     <span class="n">E</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">157</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nAtoms</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_nAtoms;
  __pyx_t_5 = __pyx_t_4;
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_i = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">158</span>:         <span class="n">qi</span> <span class="o">=</span> <span class="n">aCharges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_i;
    if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_v_aCharges.shape[0];
    __pyx_v_qi = (*((double *) ( /* dim=0 */ (__pyx_v_aCharges.data + __pyx_t_7 * __pyx_v_aCharges.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">159</span>:         <span class="k">if</span> <span class="n">qi</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = ((__pyx_v_qi == 0.0) != 0);
    if (__pyx_t_8) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">160</span>:             <span class="k">continue</span></pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">161</span>:         <span class="n">r1x</span> <span class="o">=</span> <span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_9 = __pyx_v_i;
    __pyx_t_10 = 0;
    if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_v_rs.shape[0];
    if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_v_rs.shape[1];
    __pyx_v_r1x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs.data + __pyx_t_9 * __pyx_v_rs.strides[0]) ) + __pyx_t_10 * __pyx_v_rs.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">162</span>:         <span class="n">r1y</span> <span class="o">=</span> <span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_i;
    __pyx_t_12 = 1;
    if (__pyx_t_11 &lt; 0) __pyx_t_11 += __pyx_v_rs.shape[0];
    if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_v_rs.shape[1];
    __pyx_v_r1y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs.data + __pyx_t_11 * __pyx_v_rs.strides[0]) ) + __pyx_t_12 * __pyx_v_rs.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">163</span>:         <span class="n">r1z</span> <span class="o">=</span> <span class="n">rs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_13 = __pyx_v_i;
    __pyx_t_14 = 2;
    if (__pyx_t_13 &lt; 0) __pyx_t_13 += __pyx_v_rs.shape[0];
    if (__pyx_t_14 &lt; 0) __pyx_t_14 += __pyx_v_rs.shape[1];
    __pyx_v_r1z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs.data + __pyx_t_13 * __pyx_v_rs.strides[0]) ) + __pyx_t_14 * __pyx_v_rs.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">164</span>:         <span class="n">ai</span> <span class="o">=</span> <span class="n">aRadii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_i;
    if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_v_aRadii.shape[0];
    __pyx_v_ai = (*((double *) ( /* dim=0 */ (__pyx_v_aRadii.data + __pyx_t_15 * __pyx_v_aRadii.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">165</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">nAtoms</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_16 = __pyx_v_nAtoms;
    __pyx_t_17 = __pyx_t_16;
    for (__pyx_t_18 = __pyx_v_i; __pyx_t_18 &lt; __pyx_t_17; __pyx_t_18+=1) {
      __pyx_v_j = __pyx_t_18;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">166</span>:             <span class="n">qj</span> <span class="o">=</span> <span class="n">aCharges</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_j;
      if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_v_aCharges.shape[0];
      __pyx_v_qj = (*((double *) ( /* dim=0 */ (__pyx_v_aCharges.data + __pyx_t_19 * __pyx_v_aCharges.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">167</span>:             <span class="k">if</span> <span class="n">qj</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_8 = ((__pyx_v_qj == 0.0) != 0);
      if (__pyx_t_8) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">168</span>:                 <span class="k">continue</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L6_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">169</span>:             <span class="n">r2x</span> <span class="o">=</span> <span class="n">rs</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_j;
      __pyx_t_21 = 0;
      if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_v_rs.shape[0];
      if (__pyx_t_21 &lt; 0) __pyx_t_21 += __pyx_v_rs.shape[1];
      __pyx_v_r2x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs.data + __pyx_t_20 * __pyx_v_rs.strides[0]) ) + __pyx_t_21 * __pyx_v_rs.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">170</span>:             <span class="n">r2y</span> <span class="o">=</span> <span class="n">rs</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_22 = __pyx_v_j;
      __pyx_t_23 = 1;
      if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_v_rs.shape[0];
      if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_v_rs.shape[1];
      __pyx_v_r2y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs.data + __pyx_t_22 * __pyx_v_rs.strides[0]) ) + __pyx_t_23 * __pyx_v_rs.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">171</span>:             <span class="n">r2z</span> <span class="o">=</span> <span class="n">rs</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_24 = __pyx_v_j;
      __pyx_t_25 = 2;
      if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_v_rs.shape[0];
      if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_v_rs.shape[1];
      __pyx_v_r2z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rs.data + __pyx_t_24 * __pyx_v_rs.strides[0]) ) + __pyx_t_25 * __pyx_v_rs.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">172</span>:             <span class="n">aj</span> <span class="o">=</span> <span class="n">aRadii</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_26 = __pyx_v_j;
      if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_v_aRadii.shape[0];
      __pyx_v_aj = (*((double *) ( /* dim=0 */ (__pyx_v_aRadii.data + __pyx_t_26 * __pyx_v_aRadii.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">173</span>:             <span class="n">rij2</span> <span class="o">=</span> <span class="p">(</span><span class="n">r1x</span> <span class="o">-</span> <span class="n">r2x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r1x</span> <span class="o">-</span> <span class="n">r2x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1y</span> <span class="o">-</span> <span class="n">r2y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r1y</span> <span class="o">-</span> <span class="n">r2y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1z</span> <span class="o">-</span> <span class="n">r2z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r1z</span> <span class="o">-</span> <span class="n">r2z</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_rij2 = ((((__pyx_v_r1x - __pyx_v_r2x) * (__pyx_v_r1x - __pyx_v_r2x)) + ((__pyx_v_r1y - __pyx_v_r2y) * (__pyx_v_r1y - __pyx_v_r2y))) + ((__pyx_v_r1z - __pyx_v_r2z) * (__pyx_v_r1z - __pyx_v_r2z)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">174</span>:             <span class="k">if</span> <span class="n">rij2</span> <span class="o">&gt;</span> <span class="n">cutoff2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_8 = ((__pyx_v_rij2 &gt; __pyx_v_cutoff2) != 0);
      if (__pyx_t_8) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">175</span>:                 <span class="k">continue</span></pre>
<pre class='cython code score-0 '>        goto __pyx_L6_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">176</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">177</span>:                 <span class="n">aij2</span> <span class="o">=</span> <span class="n">ai</span> <span class="o">*</span> <span class="n">aj</span></pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_aij2 = (__pyx_v_ai * __pyx_v_aj);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">178</span>:                 <span class="n">qij</span> <span class="o">=</span> <span class="n">qi</span> <span class="o">*</span> <span class="n">qj</span></pre>
<pre class='cython code score-0 '>        __pyx_v_qij = (__pyx_v_qi * __pyx_v_qj);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">179</span>:                 <span class="n">D</span> <span class="o">=</span> <span class="n">rij2</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">aij2</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        __pyx_v_D = (__pyx_v_rij2 / (4.0 * __pyx_v_aij2));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">180</span>:                 <span class="n">fgbr</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">rij2</span> <span class="o">+</span> <span class="n">aij2</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">D</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>        __pyx_v_fgbr = sqrt((__pyx_v_rij2 + (__pyx_v_aij2 * exp((-__pyx_v_D)))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">181</span>:                 <span class="n">fgbc</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">cutoff</span> <span class="o">+</span> <span class="n">aij2</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">D</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>        __pyx_v_fgbc = sqrt((__pyx_v_cutoff + (__pyx_v_aij2 * exp((-__pyx_v_D)))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">182</span>:                 <span class="n">E</span> <span class="o">=</span> <span class="n">E</span> <span class="o">+</span> <span class="n">qij</span> <span class="o">/</span> <span class="n">fgbr</span> <span class="o">-</span> <span class="n">qij</span><span class="o">/</span><span class="n">fgbc</span></pre>
<pre class='cython code score-0 '>        __pyx_v_E = ((__pyx_v_E + (__pyx_v_qij / __pyx_v_fgbr)) - (__pyx_v_qij / __pyx_v_fgbc));
      }
      __pyx_L6_continue:;
    }
    __pyx_L3_continue:;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">183</span>:     <span class="n">E</span> <span class="o">*=</span> <span class="n">pre</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = (__pyx_v_E * __pyx_v_pre);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">184</span>:     <span class="k">return</span> <span class="n">E</span></pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 184, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">185</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">186</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">187</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">188</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-72" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">189</span>: <span class="k">def</span> <span class="nf">clash_potential</span><span class="p">(</span><span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">double</span><span class="p">[:]</span> <span class="n">vdw</span><span class="p">,</span> <span class="n">double</span> <span class="n">clash_tolerance</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">double</span> <span class="n">covalent_radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span></pre>
<pre class='cython code score-72 '>/* Python wrapper */
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_7clash_potential(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3mfm_9structure_9potential_11cPotentials_6clash_potential[] = "\n    Clash potential\n    with cutoff-potential potential shifted by value at cutoff to smooth the energy\n    :param xyz: Cartesian coordinates of the atoms\n    :param vdw: van der Waals radii of the atoms\n    :param clash_tolerance: clash tolerance\n    :return:\n    ";
static PyMethodDef __pyx_mdef_3mfm_9structure_9potential_11cPotentials_7clash_potential = {"clash_potential", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_3mfm_9structure_9potential_11cPotentials_7clash_potential, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3mfm_9structure_9potential_11cPotentials_6clash_potential};
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_7clash_potential(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_xyz = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vdw = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_clash_tolerance;
  double __pyx_v_covalent_radius;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("clash_potential (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_xyz,&amp;__pyx_n_s_vdw,&amp;__pyx_n_s_clash_tolerance,&amp;__pyx_n_s_covalent_radius,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_xyz)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_vdw)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("clash_potential", 0, 2, 4, 1); <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_clash_tolerance);
          if (value) { values[2] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_covalent_radius);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "clash_potential") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_xyz = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_xyz.memview)) __PYX_ERR(0, 189, __pyx_L3_error)</span>
    __pyx_v_vdw = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_vdw.memview)) __PYX_ERR(0, 189, __pyx_L3_error)</span>
    if (values[2]) {
      __pyx_v_clash_tolerance = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_clash_tolerance == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L3_error)</span>
    } else {
      __pyx_v_clash_tolerance = ((double)1.0);
    }
    if (values[3]) {
      __pyx_v_covalent_radius = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_covalent_radius == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L3_error)</span>
    } else {
      __pyx_v_covalent_radius = ((double)1.0);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("clash_potential", 0, 2, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.clash_potential", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3mfm_9structure_9potential_11cPotentials_6clash_potential(__pyx_self, __pyx_v_xyz, __pyx_v_vdw, __pyx_v_clash_tolerance, __pyx_v_covalent_radius);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3mfm_9structure_9potential_11cPotentials_6clash_potential(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_xyz, __Pyx_memviewslice __pyx_v_vdw, double __pyx_v_clash_tolerance, double __pyx_v_covalent_radius) {
  int __pyx_v_nAtoms;
  double __pyx_v_E;
  double __pyx_v_r1x;
  double __pyx_v_r1y;
  double __pyx_v_r1z;
  double __pyx_v_r2x;
  double __pyx_v_r2y;
  double __pyx_v_r2z;
  double __pyx_v_rij;
  double __pyx_v_vdwi;
  double __pyx_v_vdwj;
  double __pyx_v_vdwij;
  int __pyx_v_i;
  int __pyx_v_j;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("clash_potential", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.clash_potential", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vdw, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__32 = <span class='py_c_api'>PyTuple_Pack</span>(19, __pyx_n_s_xyz, __pyx_n_s_vdw, __pyx_n_s_clash_tolerance, __pyx_n_s_covalent_radius, __pyx_n_s_nAtoms, __pyx_n_s_E, __pyx_n_s_r1x, __pyx_n_s_r1y, __pyx_n_s_r1z, __pyx_n_s_r2x, __pyx_n_s_r2y, __pyx_n_s_r2z, __pyx_n_s_rij, __pyx_n_s_rij2, __pyx_n_s_vdwi, __pyx_n_s_vdwj, __pyx_n_s_vdwij, __pyx_n_s_i, __pyx_n_s_j);<span class='error_goto'> if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 189, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__32);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__32);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3mfm_9structure_9potential_11cPotentials_7clash_potential, NULL, __pyx_n_s_mfm_structure_potential_cPotenti_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 189, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_clash_potential, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__33 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 19, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__32, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_mfm_structure_potential_cPotenti, __pyx_n_s_clash_potential, 189, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__33)) __PYX_ERR(0, 189, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">190</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">191</span>: <span class="sd">    Clash potential</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">192</span>: <span class="sd">    with cutoff-potential potential shifted by value at cutoff to smooth the energy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">193</span>: <span class="sd">    :param xyz: Cartesian coordinates of the atoms</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">194</span>: <span class="sd">    :param vdw: van der Waals radii of the atoms</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">195</span>: <span class="sd">    :param clash_tolerance: clash tolerance</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">196</span>: <span class="sd">    :return:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">197</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">198</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">199</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">nAtoms</span> <span class="o">=</span> <span class="n">xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nAtoms = (__pyx_v_xyz.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">200</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">E</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">201</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">r1x</span><span class="p">,</span> <span class="nf">r1y</span><span class="p">,</span> <span class="nf">r1z</span><span class="p">,</span> <span class="nf">r2x</span><span class="p">,</span> <span class="nf">r2y</span><span class="p">,</span> <span class="nf">r2z</span><span class="p">,</span> <span class="nf">rij</span><span class="p">,</span> <span class="nf">rij2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">202</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">vdwi</span><span class="p">,</span> <span class="nf">vdwj</span><span class="p">,</span> <span class="nf">vdwij</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">203</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">204</span>:     <span class="n">E</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_E = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">205</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nAtoms</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_nAtoms;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">206</span>:         <span class="n">r1x</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_5 = 0;
    if (__pyx_t_4 &lt; 0) __pyx_t_4 += __pyx_v_xyz.shape[0];
    if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_xyz.shape[1];
    __pyx_v_r1x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_4 * __pyx_v_xyz.strides[0]) ) + __pyx_t_5 * __pyx_v_xyz.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">207</span>:         <span class="n">r1y</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_i;
    __pyx_t_7 = 1;
    if (__pyx_t_6 &lt; 0) __pyx_t_6 += __pyx_v_xyz.shape[0];
    if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_v_xyz.shape[1];
    __pyx_v_r1y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_6 * __pyx_v_xyz.strides[0]) ) + __pyx_t_7 * __pyx_v_xyz.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>:         <span class="n">r1z</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_8 = __pyx_v_i;
    __pyx_t_9 = 2;
    if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_v_xyz.shape[0];
    if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_v_xyz.shape[1];
    __pyx_v_r1z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_8 * __pyx_v_xyz.strides[0]) ) + __pyx_t_9 * __pyx_v_xyz.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">209</span>:         <span class="n">vdwi</span> <span class="o">=</span> <span class="n">vdw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_v_i;
    if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_v_vdw.shape[0];
    __pyx_v_vdwi = (*((double *) ( /* dim=0 */ (__pyx_v_vdw.data + __pyx_t_10 * __pyx_v_vdw.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">210</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">nAtoms</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_nAtoms;
    __pyx_t_12 = __pyx_t_11;
    for (__pyx_t_13 = (__pyx_v_i + 1); __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
      __pyx_v_j = __pyx_t_13;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>:             <span class="n">vdwj</span> <span class="o">=</span> <span class="n">vdw</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_j;
      if (__pyx_t_14 &lt; 0) __pyx_t_14 += __pyx_v_vdw.shape[0];
      __pyx_v_vdwj = (*((double *) ( /* dim=0 */ (__pyx_v_vdw.data + __pyx_t_14 * __pyx_v_vdw.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">212</span>:             <span class="n">r2x</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_j;
      __pyx_t_16 = 0;
      if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_v_xyz.shape[0];
      if (__pyx_t_16 &lt; 0) __pyx_t_16 += __pyx_v_xyz.shape[1];
      __pyx_v_r2x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_15 * __pyx_v_xyz.strides[0]) ) + __pyx_t_16 * __pyx_v_xyz.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">213</span>:             <span class="n">r2y</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_v_j;
      __pyx_t_18 = 1;
      if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_v_xyz.shape[0];
      if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_v_xyz.shape[1];
      __pyx_v_r2y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_17 * __pyx_v_xyz.strides[0]) ) + __pyx_t_18 * __pyx_v_xyz.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">214</span>:             <span class="n">r2z</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_19 = __pyx_v_j;
      __pyx_t_20 = 2;
      if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_v_xyz.shape[0];
      if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_v_xyz.shape[1];
      __pyx_v_r2z = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_19 * __pyx_v_xyz.strides[0]) ) + __pyx_t_20 * __pyx_v_xyz.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>:             <span class="n">rij</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">r1x</span> <span class="o">-</span> <span class="n">r2x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r1x</span> <span class="o">-</span> <span class="n">r2x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1y</span> <span class="o">-</span> <span class="n">r2y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r1y</span> <span class="o">-</span> <span class="n">r2y</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1z</span> <span class="o">-</span> <span class="n">r2z</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r1z</span> <span class="o">-</span> <span class="n">r2z</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>      __pyx_v_rij = sqrt(((((__pyx_v_r1x - __pyx_v_r2x) * (__pyx_v_r1x - __pyx_v_r2x)) + ((__pyx_v_r1y - __pyx_v_r2y) * (__pyx_v_r1y - __pyx_v_r2y))) + ((__pyx_v_r1z - __pyx_v_r2z) * (__pyx_v_r1z - __pyx_v_r2z))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">216</span>:             <span class="n">vdwij</span> <span class="o">=</span> <span class="p">(</span><span class="n">vdwi</span> <span class="o">+</span> <span class="n">vdwj</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_vdwij = (__pyx_v_vdwi + __pyx_v_vdwj);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">217</span>:             <span class="k">if</span> <span class="n">covalent_radius</span> <span class="o">&lt;</span> <span class="n">rij</span> <span class="o">&lt;</span> <span class="n">vdwij</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_21 = (__pyx_v_covalent_radius &lt; __pyx_v_rij);
      if (__pyx_t_21) {
        __pyx_t_21 = (__pyx_v_rij &lt; __pyx_v_vdwij);
      }
      __pyx_t_22 = (__pyx_t_21 != 0);
      if (__pyx_t_22) {
/* … */
      }
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">218</span>:                 <span class="n">E</span> <span class="o">+=</span> <span class="p">((</span><span class="n">vdwi</span> <span class="o">+</span> <span class="n">vdwj</span> <span class="o">-</span> <span class="n">rij</span><span class="p">)</span> <span class="o">/</span> <span class="n">clash_tolerance</span><span class="p">)</span><span class="o">**</span><span class="mf">2.0</span></pre>
<pre class='cython code score-0 '>        __pyx_v_E = (__pyx_v_E + pow((((__pyx_v_vdwi + __pyx_v_vdwj) - __pyx_v_rij) / __pyx_v_clash_tolerance), 2.0));
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">219</span>:     <span class="k">return</span> <span class="n">E</span></pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_23 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_E);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 219, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_r = __pyx_t_23;
  __pyx_t_23 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">220</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">221</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">222</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-98" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">223</span>: <span class="k">def</span> <span class="nf">go_init</span><span class="p">(</span><span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">caDist</span><span class="p">,</span> <span class="n">double</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">double</span> <span class="n">nnEFactor</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">double</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">6.5</span><span class="p">):</span></pre>
<pre class='cython code score-98 '>/* Python wrapper */
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_9go_init(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3mfm_9structure_9potential_11cPotentials_8go_init[] = "\n    The go-interactions are implemented as truncated LJ-(6,12) potential. The function looks for each\n    residue within a radius of nativeCut for neighbors if the residues are within the cutoff. If the\n    residues are within the cutoff the value in the returned interaction matrix is set to epsilon\n    otherwise the value is set to epsilon*nnFraction (non-native interaction).\n    ";
static PyMethodDef __pyx_mdef_3mfm_9structure_9potential_11cPotentials_9go_init = {"go_init", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_3mfm_9structure_9potential_11cPotentials_9go_init, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3mfm_9structure_9potential_11cPotentials_8go_init};
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_9go_init(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_caDist = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_epsilon;
  double __pyx_v_nnEFactor;
  double __pyx_v_cutoff;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("go_init (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_caDist,&amp;__pyx_n_s_epsilon,&amp;__pyx_n_s_nnEFactor,&amp;__pyx_n_s_cutoff,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_caDist)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_epsilon)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("go_init", 0, 2, 4, 1); <span class='error_goto'>__PYX_ERR(0, 223, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_nnEFactor);
          if (value) { values[2] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cutoff);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "go_init") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 223, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_caDist = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_caDist.memview)) __PYX_ERR(0, 223, __pyx_L3_error)</span>
    __pyx_v_epsilon = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_epsilon == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 223, __pyx_L3_error)</span>
    if (values[2]) {
      __pyx_v_nnEFactor = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_nnEFactor == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 223, __pyx_L3_error)</span>
    } else {
      __pyx_v_nnEFactor = ((double)0.1);
    }
    if (values[3]) {
      __pyx_v_cutoff = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_cutoff == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 223, __pyx_L3_error)</span>
    } else {
      __pyx_v_cutoff = ((double)6.5);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("go_init", 0, 2, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 223, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.go_init", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3mfm_9structure_9potential_11cPotentials_8go_init(__pyx_self, __pyx_v_caDist, __pyx_v_epsilon, __pyx_v_nnEFactor, __pyx_v_cutoff);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3mfm_9structure_9potential_11cPotentials_8go_init(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_caDist, double __pyx_v_epsilon, double __pyx_v_nnEFactor, double __pyx_v_cutoff) {
  int __pyx_v_i;
  int __pyx_v_j;
  double __pyx_v_rm;
  double __pyx_v_intE;
  int __pyx_v_nRes;
  PyArrayObject *__pyx_v_eMatrix = 0;
  PyArrayObject *__pyx_v_rmMatrix = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_eMatrix;
  __Pyx_Buffer __pyx_pybuffer_eMatrix;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_rmMatrix;
  __Pyx_Buffer __pyx_pybuffer_rmMatrix;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("go_init", 0);
  __pyx_pybuffer_eMatrix.pybuffer.buf = NULL;
  __pyx_pybuffer_eMatrix.refcount = 0;
  __pyx_pybuffernd_eMatrix.data = NULL;
  __pyx_pybuffernd_eMatrix.rcbuffer = &amp;__pyx_pybuffer_eMatrix;
  __pyx_pybuffer_rmMatrix.pybuffer.buf = NULL;
  __pyx_pybuffer_rmMatrix.refcount = 0;
  __pyx_pybuffernd_rmMatrix.data = NULL;
  __pyx_pybuffernd_rmMatrix.rcbuffer = &amp;__pyx_pybuffer_rmMatrix;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.go_init", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_eMatrix);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_rmMatrix);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_caDist, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__34 = <span class='py_c_api'>PyTuple_Pack</span>(11, __pyx_n_s_caDist, __pyx_n_s_epsilon, __pyx_n_s_nnEFactor, __pyx_n_s_cutoff, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_rm, __pyx_n_s_intE, __pyx_n_s_nRes, __pyx_n_s_eMatrix, __pyx_n_s_rmMatrix);<span class='error_goto'> if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__34);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__34);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3mfm_9structure_9potential_11cPotentials_9go_init, NULL, __pyx_n_s_mfm_structure_potential_cPotenti_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_go_init, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__35 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__34, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_mfm_structure_potential_cPotenti, __pyx_n_s_go_init, 223, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__35)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">224</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">225</span>: <span class="sd">    The go-interactions are implemented as truncated LJ-(6,12) potential. The function looks for each</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">226</span>: <span class="sd">    residue within a radius of nativeCut for neighbors if the residues are within the cutoff. If the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">227</span>: <span class="sd">    residues are within the cutoff the value in the returned interaction matrix is set to epsilon</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">228</span>: <span class="sd">    otherwise the value is set to epsilon*nnFraction (non-native interaction).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">229</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">230</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">231</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">rm</span><span class="p">,</span> <span class="nf">intE</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">232</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">nRes</span> <span class="o">=</span> <span class="n">caDist</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nRes = (__pyx_v_caDist.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">233</span>: </pre>
<pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">234</span>:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">np</span>.<span class="nf">float64_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">eMatrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nRes</span><span class="p">,</span> <span class="n">nRes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-45 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nRes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nRes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
  __pyx_t_1 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 234, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 234, __pyx_L1_error)</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_eMatrix = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 234, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_eMatrix.diminfo[0].strides = __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_eMatrix.diminfo[0].shape = __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_eMatrix.diminfo[1].strides = __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_eMatrix.diminfo[1].shape = __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_eMatrix = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">235</span>:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">np</span>.<span class="nf">float64_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">rmMatrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nRes</span><span class="p">,</span> <span class="n">nRes</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-45 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nRes);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nRes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
  __pyx_t_5 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 235, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 235, __pyx_L1_error)</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_rmMatrix = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 235, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_rmMatrix.diminfo[0].strides = __pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_rmMatrix.diminfo[0].shape = __pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_rmMatrix.diminfo[1].strides = __pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_rmMatrix.diminfo[1].shape = __pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_rmMatrix = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">236</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">237</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nRes</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __pyx_v_nRes;
  __pyx_t_9 = __pyx_t_8;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">238</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">nRes</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = __pyx_v_nRes;
    __pyx_t_12 = __pyx_t_11;
    for (__pyx_t_13 = (__pyx_v_i + 1); __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
      __pyx_v_j = __pyx_t_13;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">239</span>:             <span class="n">rm</span> <span class="o">=</span> <span class="n">caDist</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_i;
      __pyx_t_15 = __pyx_v_j;
      if (__pyx_t_14 &lt; 0) __pyx_t_14 += __pyx_v_caDist.shape[0];
      if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_v_caDist.shape[1];
      __pyx_v_rm = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_caDist.data + __pyx_t_14 * __pyx_v_caDist.strides[0]) ) + __pyx_t_15 * __pyx_v_caDist.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">240</span>:             <span class="n">intE</span> <span class="o">=</span> <span class="p">(</span><span class="mf">17.</span><span class="o">/</span><span class="mf">55.</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">*</span> <span class="n">rm</span>  <span class="c"># (2.5 sigma)</span></pre>
<pre class='cython code score-0 '>      __pyx_v_intE = (((17. / 55.) + 1.) * __pyx_v_rm);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">241</span>:             <span class="n">rmMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">rm</span></pre>
<pre class='cython code score-0 '>      __pyx_t_16 = __pyx_v_i;
      __pyx_t_17 = __pyx_v_j;
      if (__pyx_t_16 &lt; 0) __pyx_t_16 += __pyx_pybuffernd_rmMatrix.diminfo[0].shape;
      if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_pybuffernd_rmMatrix.diminfo[1].shape;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_rmMatrix.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_rmMatrix.diminfo[1].strides) = __pyx_v_rm;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">242</span>:             <span class="n">rmMatrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rm</span></pre>
<pre class='cython code score-0 '>      __pyx_t_18 = __pyx_v_j;
      __pyx_t_19 = __pyx_v_i;
      if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_pybuffernd_rmMatrix.diminfo[0].shape;
      if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_pybuffernd_rmMatrix.diminfo[1].shape;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_rmMatrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_rmMatrix.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_rmMatrix.diminfo[1].strides) = __pyx_v_rm;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:             <span class="k">if</span> <span class="n">caDist</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_20 = __pyx_v_i;
      __pyx_t_21 = __pyx_v_j;
      if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_v_caDist.shape[0];
      if (__pyx_t_21 &lt; 0) __pyx_t_21 += __pyx_v_caDist.shape[1];
      __pyx_t_22 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_caDist.data + __pyx_t_20 * __pyx_v_caDist.strides[0]) ) + __pyx_t_21 * __pyx_v_caDist.strides[1]) ))) &lt; __pyx_v_cutoff) != 0);
      if (__pyx_t_22) {
/* … */
        goto __pyx_L7;
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">244</span>:                 <span class="n">eMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">epsilon</span> <span class="o">/</span> <span class="n">intE</span></pre>
<pre class='cython code score-5 '>        if (unlikely(__pyx_v_intE == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 244, __pyx_L1_error)</span>
        }
        __pyx_t_23 = __pyx_v_i;
        __pyx_t_24 = __pyx_v_j;
        if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_pybuffernd_eMatrix.diminfo[0].shape;
        if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_pybuffernd_eMatrix.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_eMatrix.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_eMatrix.diminfo[1].strides) = (__pyx_v_epsilon / __pyx_v_intE);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">245</span>:                 <span class="n">eMatrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">epsilon</span> <span class="o">/</span> <span class="n">intE</span></pre>
<pre class='cython code score-5 '>        if (unlikely(__pyx_v_intE == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 245, __pyx_L1_error)</span>
        }
        __pyx_t_25 = __pyx_v_j;
        __pyx_t_26 = __pyx_v_i;
        if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_pybuffernd_eMatrix.diminfo[0].shape;
        if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_pybuffernd_eMatrix.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_25, __pyx_pybuffernd_eMatrix.diminfo[0].strides, __pyx_t_26, __pyx_pybuffernd_eMatrix.diminfo[1].strides) = (__pyx_v_epsilon / __pyx_v_intE);
</pre><pre class="cython line score-0">&#xA0;<span class="">246</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">247</span>:                 <span class="n">eMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">nnEFactor</span> <span class="o">*</span> <span class="n">epsilon</span> <span class="o">/</span> <span class="n">intE</span></pre>
<pre class='cython code score-5 '>      /*else*/ {
        __pyx_t_27 = (__pyx_v_nnEFactor * __pyx_v_epsilon);
        if (unlikely(__pyx_v_intE == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 247, __pyx_L1_error)</span>
        }
        __pyx_t_28 = __pyx_v_i;
        __pyx_t_29 = __pyx_v_j;
        if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_pybuffernd_eMatrix.diminfo[0].shape;
        if (__pyx_t_29 &lt; 0) __pyx_t_29 += __pyx_pybuffernd_eMatrix.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_eMatrix.diminfo[0].strides, __pyx_t_29, __pyx_pybuffernd_eMatrix.diminfo[1].strides) = (__pyx_t_27 / __pyx_v_intE);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">248</span>:                 <span class="n">eMatrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nnEFactor</span> <span class="o">*</span> <span class="n">epsilon</span> <span class="o">/</span> <span class="n">intE</span></pre>
<pre class='cython code score-5 '>        __pyx_t_27 = (__pyx_v_nnEFactor * __pyx_v_epsilon);
        if (unlikely(__pyx_v_intE == 0)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
          <span class='error_goto'>__PYX_ERR(0, 248, __pyx_L1_error)</span>
        }
        __pyx_t_30 = __pyx_v_j;
        __pyx_t_31 = __pyx_v_i;
        if (__pyx_t_30 &lt; 0) __pyx_t_30 += __pyx_pybuffernd_eMatrix.diminfo[0].shape;
        if (__pyx_t_31 &lt; 0) __pyx_t_31 += __pyx_pybuffernd_eMatrix.diminfo[1].shape;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_eMatrix.rcbuffer-&gt;pybuffer.buf, __pyx_t_30, __pyx_pybuffernd_eMatrix.diminfo[0].strides, __pyx_t_31, __pyx_pybuffernd_eMatrix.diminfo[1].strides) = (__pyx_t_27 / __pyx_v_intE);
      }
      __pyx_L7:;
    }
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">249</span>:     <span class="k">return</span> <span class="n">eMatrix</span><span class="p">,</span> <span class="n">rmMatrix</span></pre>
<pre class='cython code score-10 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 249, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_eMatrix));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_eMatrix));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_eMatrix));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_rmMatrix));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_rmMatrix));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, ((PyObject *)__pyx_v_rmMatrix));
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">250</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">251</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">252</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">253</span>: <span class="k">def</span> <span class="nf">go</span><span class="p">(</span><span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">caDist</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">eMatrix</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">rmMatrix</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-63 '>/* Python wrapper */
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_11go(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3mfm_9structure_9potential_11cPotentials_10go[] = "\n    If cutoff is True the LJ-Potential is cutoff and shifted at 2.5 sigma\n\n    :param resLookUp:\n    :param caDist:\n    :param eMatrix:\n    :param rmMatrix:\n    :param cutoff:\n    :return:\n    ";
static PyMethodDef __pyx_mdef_3mfm_9structure_9potential_11cPotentials_11go = {"go", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_3mfm_9structure_9potential_11cPotentials_11go, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3mfm_9structure_9potential_11cPotentials_10go};
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_11go(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_caDist = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_eMatrix = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_rmMatrix = { 0, 0, { 0 }, { 0 }, { 0 } };
  CYTHON_UNUSED int __pyx_v_cutoff;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("go (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_caDist,&amp;__pyx_n_s_eMatrix,&amp;__pyx_n_s_rmMatrix,&amp;__pyx_n_s_cutoff,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_caDist)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_eMatrix)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("go", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 253, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_rmMatrix)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("go", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 253, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cutoff);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "go") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 253, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_caDist = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_caDist.memview)) __PYX_ERR(0, 253, __pyx_L3_error)</span>
    __pyx_v_eMatrix = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_eMatrix.memview)) __PYX_ERR(0, 253, __pyx_L3_error)</span>
    __pyx_v_rmMatrix = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_rmMatrix.memview)) __PYX_ERR(0, 253, __pyx_L3_error)</span>
    if (values[3]) {
      __pyx_v_cutoff = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_cutoff == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 253, __pyx_L3_error)</span>
    } else {
      __pyx_v_cutoff = ((int)1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("go", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 253, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.go", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3mfm_9structure_9potential_11cPotentials_10go(__pyx_self, __pyx_v_caDist, __pyx_v_eMatrix, __pyx_v_rmMatrix, __pyx_v_cutoff);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3mfm_9structure_9potential_11cPotentials_10go(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_caDist, __Pyx_memviewslice __pyx_v_eMatrix, __Pyx_memviewslice __pyx_v_rmMatrix, CYTHON_UNUSED int __pyx_v_cutoff) {
  double __pyx_v_Etemp;
  double __pyx_v_Etot;
  double __pyx_v_r;
  double __pyx_v_sr;
  int __pyx_v_nRes;
  int __pyx_v_i;
  int __pyx_v_j;
  double __pyx_v_epsilon;
  double __pyx_v_rm;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("go", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.go", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_caDist, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_eMatrix, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_rmMatrix, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__36 = <span class='py_c_api'>PyTuple_Pack</span>(16, __pyx_n_s_caDist, __pyx_n_s_eMatrix, __pyx_n_s_rmMatrix, __pyx_n_s_cutoff, __pyx_n_s_Etemp, __pyx_n_s_Etot, __pyx_n_s_Enn, __pyx_n_s_Ena, __pyx_n_s_r, __pyx_n_s_sr, __pyx_n_s_nRes, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_n, __pyx_n_s_epsilon, __pyx_n_s_rm);<span class='error_goto'> if (unlikely(!__pyx_tuple__36)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__36);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__36);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3mfm_9structure_9potential_11cPotentials_11go, NULL, __pyx_n_s_mfm_structure_potential_cPotenti_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_go, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__37 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 16, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__36, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_mfm_structure_potential_cPotenti, __pyx_n_s_go, 253, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__37)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">254</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">255</span>: <span class="sd">    If cutoff is True the LJ-Potential is cutoff and shifted at 2.5 sigma</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">256</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">257</span>: <span class="sd">    :param resLookUp:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">258</span>: <span class="sd">    :param caDist:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">259</span>: <span class="sd">    :param eMatrix:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">260</span>: <span class="sd">    :param rmMatrix:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">261</span>: <span class="sd">    :param cutoff:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">262</span>: <span class="sd">    :return:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">263</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">264</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">Etemp</span><span class="p">,</span> <span class="nf">Etot</span><span class="p">,</span> <span class="nf">Enn</span><span class="p">,</span> <span class="nf">Ena</span><span class="p">,</span> <span class="nf">r</span><span class="p">,</span> <span class="nf">sr</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">265</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">nRes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">266</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">n</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">267</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">epsilon</span><span class="p">,</span> <span class="nf">rm</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">268</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">269</span>:     <span class="n">Etemp</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_Etemp = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">270</span>:     <span class="n">Etot</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c"># total energy</span></pre>
<pre class='cython code score-0 '>  __pyx_v_Etot = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>:     <span class="n">nRes</span> <span class="o">=</span> <span class="n">caDist</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nRes = (__pyx_v_caDist.shape[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">272</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nRes</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_nRes;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">273</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">nRes</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_nRes;
    __pyx_t_5 = __pyx_t_4;
    for (__pyx_t_6 = (__pyx_v_i + 1); __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_j = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">274</span>:             <span class="n">epsilon</span> <span class="o">=</span> <span class="n">eMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = __pyx_v_i;
      __pyx_t_8 = __pyx_v_j;
      if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_v_eMatrix.shape[0];
      if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_v_eMatrix.shape[1];
      __pyx_v_epsilon = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_eMatrix.data + __pyx_t_7 * __pyx_v_eMatrix.strides[0]) ) + __pyx_t_8 * __pyx_v_eMatrix.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">275</span>:             <span class="n">rm</span> <span class="o">=</span> <span class="n">rmMatrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_9 = __pyx_v_i;
      __pyx_t_10 = __pyx_v_j;
      if (__pyx_t_9 &lt; 0) __pyx_t_9 += __pyx_v_rmMatrix.shape[0];
      if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_v_rmMatrix.shape[1];
      __pyx_v_rm = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rmMatrix.data + __pyx_t_9 * __pyx_v_rmMatrix.strides[0]) ) + __pyx_t_10 * __pyx_v_rmMatrix.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">276</span>:             <span class="n">r</span> <span class="o">=</span> <span class="n">caDist</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_11 = __pyx_v_i;
      __pyx_t_12 = __pyx_v_j;
      if (__pyx_t_11 &lt; 0) __pyx_t_11 += __pyx_v_caDist.shape[0];
      if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_v_caDist.shape[1];
      __pyx_v_r = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_caDist.data + __pyx_t_11 * __pyx_v_caDist.strides[0]) ) + __pyx_t_12 * __pyx_v_caDist.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">277</span>:             <span class="k">if</span> <span class="n">rm</span> <span class="o">&lt;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="n">rm</span> <span class="o">*</span> <span class="mf">2.5</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_13 = (__pyx_v_rm &lt; __pyx_v_r);
      if (__pyx_t_13) {
        __pyx_t_13 = (__pyx_v_r &lt; (__pyx_v_rm * 2.5));
      }
      __pyx_t_14 = (__pyx_t_13 != 0);
      if (__pyx_t_14) {
/* … */
        goto __pyx_L7;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">278</span>:                 <span class="n">sr</span> <span class="o">=</span> <span class="mf">2</span><span class="o">*</span><span class="p">(</span><span class="n">rm</span> <span class="o">/</span> <span class="n">r</span><span class="p">)</span> <span class="o">**</span> <span class="mf">6</span></pre>
<pre class='cython code score-0 '>        __pyx_v_sr = (2.0 * pow((__pyx_v_rm / __pyx_v_r), 6.0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:                 <span class="n">Etemp</span> <span class="o">-=</span> <span class="n">sr</span></pre>
<pre class='cython code score-0 '>        __pyx_v_Etemp = (__pyx_v_Etemp - __pyx_v_sr);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>:                 <span class="n">Etemp</span> <span class="o">+=</span> <span class="n">sr</span> <span class="o">**</span> <span class="mf">2</span> <span class="o">/</span> <span class="mf">4.0</span></pre>
<pre class='cython code score-0 '>        __pyx_v_Etemp = (__pyx_v_Etemp + (pow(__pyx_v_sr, 2.0) / 4.0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">281</span>:                 <span class="n">Etemp</span> <span class="o">*=</span> <span class="n">epsilon</span></pre>
<pre class='cython code score-0 '>        __pyx_v_Etemp = (__pyx_v_Etemp * __pyx_v_epsilon);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">282</span>:                 <span class="n">Etemp</span> <span class="o">+=</span> <span class="mf">0.00818</span> <span class="o">*</span> <span class="n">epsilon</span></pre>
<pre class='cython code score-0 '>        __pyx_v_Etemp = (__pyx_v_Etemp + (0.00818 * __pyx_v_epsilon));
</pre><pre class="cython line score-0">&#xA0;<span class="">283</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">284</span>:                 <span class="n">Etemp</span> <span class="o">=</span> <span class="o">-</span> <span class="n">epsilon</span></pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_v_Etemp = (-__pyx_v_epsilon);
      }
      __pyx_L7:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>:             <span class="n">Etot</span> <span class="o">+=</span> <span class="n">Etemp</span></pre>
<pre class='cython code score-0 '>      __pyx_v_Etot = (__pyx_v_Etot + __pyx_v_Etemp);
    }
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">286</span>:     <span class="k">return</span> <span class="n">Etot</span></pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_15 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_Etot);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 286, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  __pyx_r = __pyx_t_15;
  __pyx_t_15 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">287</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">288</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">289</span>: <span class="k">def</span> <span class="nf">spherePoints</span><span class="p">(</span><span class="nb">int</span> <span class="n">nSphere</span><span class="p">):</span></pre>
<pre class='cython code score-29 '>/* Python wrapper */
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_13spherePoints(PyObject *__pyx_self, PyObject *__pyx_arg_nSphere); /*proto*/
static PyMethodDef __pyx_mdef_3mfm_9structure_9potential_11cPotentials_13spherePoints = {"spherePoints", (PyCFunction)__pyx_pw_3mfm_9structure_9potential_11cPotentials_13spherePoints, METH_O, 0};
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_13spherePoints(PyObject *__pyx_self, PyObject *__pyx_arg_nSphere) {
  int __pyx_v_nSphere;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("spherePoints (wrapper)", 0);
  assert(__pyx_arg_nSphere); {
    __pyx_v_nSphere = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_arg_nSphere); if (unlikely((__pyx_v_nSphere == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 289, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.spherePoints", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3mfm_9structure_9potential_11cPotentials_12spherePoints(__pyx_self, ((int)__pyx_v_nSphere));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3mfm_9structure_9potential_11cPotentials_12spherePoints(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_nSphere) {
  double __pyx_v_offset;
  double __pyx_v_rd;
  double __pyx_v_y;
  double __pyx_v_phi;
  __Pyx_memviewslice __pyx_v_sphere_points = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_inc;
  int32_t __pyx_v_k;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("spherePoints", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.spherePoints", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_sphere_points, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__38 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_nSphere, __pyx_n_s_nSphere, __pyx_n_s_offset, __pyx_n_s_rd, __pyx_n_s_y, __pyx_n_s_phi, __pyx_n_s_sphere_points, __pyx_n_s_inc, __pyx_n_s_k);<span class='error_goto'> if (unlikely(!__pyx_tuple__38)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__38);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__38);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3mfm_9structure_9potential_11cPotentials_13spherePoints, NULL, __pyx_n_s_mfm_structure_potential_cPotenti_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_spherePoints, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 289, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__39 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__38, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_mfm_structure_potential_cPotenti, __pyx_n_s_spherePoints, 289, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__39)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">290</span>:     <span class="c"># generate sphere points Returns list of 3d coordinates of points on a sphere using the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">291</span>:     <span class="c"># Golden Section Spiral algorithm.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">292</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">offset</span><span class="p">,</span> <span class="nf">rd</span><span class="p">,</span> <span class="nf">y</span><span class="p">,</span> <span class="nf">phi</span></pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">293</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">sphere_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nSphere</span><span class="p">,</span><span class="mf">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_nSphere);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_sphere_points = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">294</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">inc</span> <span class="o">=</span> <span class="mf">3.14159265359</span> <span class="o">*</span> <span class="p">(</span><span class="mf">3</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">5</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>  __pyx_v_inc = (3.14159265359 * (3.0 - sqrt(5.0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">295</span>:     <span class="k">cdef</span> <span class="kt">int32_t</span> <span class="nf">k</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>:     <span class="n">offset</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="p">(&lt;</span><span class="kt">double</span><span class="p">&gt;</span> <span class="n">nSphere</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  if (unlikely(((double)__pyx_v_nSphere) == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>
  }
  __pyx_v_offset = (2.0 / ((double)__pyx_v_nSphere));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">297</span>:     <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nSphere</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_nSphere;
  __pyx_t_8 = __pyx_t_7;
  for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {
    __pyx_v_k = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">298</span>:         <span class="n">y</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">offset</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">offset</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_y = (((__pyx_v_k * __pyx_v_offset) - 1.0) + (__pyx_v_offset / 2.0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">299</span>:         <span class="n">rd</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_v_rd = sqrt((1.0 - (__pyx_v_y * __pyx_v_y)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">300</span>:         <span class="n">phi</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">inc</span></pre>
<pre class='cython code score-0 '>    __pyx_v_phi = (__pyx_v_k * __pyx_v_inc);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">301</span>:         <span class="n">sphere_points</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">rd</span></pre>
<pre class='cython code score-2 '>    __pyx_t_10 = __pyx_v_k;
    __pyx_t_11 = 0;
    __pyx_t_12 = -1;
    if (__pyx_t_10 &lt; 0) {
      __pyx_t_10 += __pyx_v_sphere_points.shape[0];
      if (unlikely(__pyx_t_10 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_10 &gt;= __pyx_v_sphere_points.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_11 &lt; 0) {
      __pyx_t_11 += __pyx_v_sphere_points.shape[1];
      if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_11 &gt;= __pyx_v_sphere_points.shape[1])) __pyx_t_12 = 1;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 301, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sphere_points.data + __pyx_t_10 * __pyx_v_sphere_points.strides[0]) ) + __pyx_t_11 * __pyx_v_sphere_points.strides[1]) )) = (cos(__pyx_v_phi) * __pyx_v_rd);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">302</span>:         <span class="n">sphere_points</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span></pre>
<pre class='cython code score-2 '>    __pyx_t_13 = __pyx_v_k;
    __pyx_t_14 = 1;
    __pyx_t_12 = -1;
    if (__pyx_t_13 &lt; 0) {
      __pyx_t_13 += __pyx_v_sphere_points.shape[0];
      if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_13 &gt;= __pyx_v_sphere_points.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_14 &lt; 0) {
      __pyx_t_14 += __pyx_v_sphere_points.shape[1];
      if (unlikely(__pyx_t_14 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_14 &gt;= __pyx_v_sphere_points.shape[1])) __pyx_t_12 = 1;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 302, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sphere_points.data + __pyx_t_13 * __pyx_v_sphere_points.strides[0]) ) + __pyx_t_14 * __pyx_v_sphere_points.strides[1]) )) = __pyx_v_y;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">303</span>:         <span class="n">sphere_points</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">rd</span></pre>
<pre class='cython code score-2 '>    __pyx_t_15 = __pyx_v_k;
    __pyx_t_16 = 2;
    __pyx_t_12 = -1;
    if (__pyx_t_15 &lt; 0) {
      __pyx_t_15 += __pyx_v_sphere_points.shape[0];
      if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_12 = 0;
    } else if (unlikely(__pyx_t_15 &gt;= __pyx_v_sphere_points.shape[0])) __pyx_t_12 = 0;
    if (__pyx_t_16 &lt; 0) {
      __pyx_t_16 += __pyx_v_sphere_points.shape[1];
      if (unlikely(__pyx_t_16 &lt; 0)) __pyx_t_12 = 1;
    } else if (unlikely(__pyx_t_16 &gt;= __pyx_v_sphere_points.shape[1])) __pyx_t_12 = 1;
    if (unlikely(__pyx_t_12 != -1)) {
      <span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_12);
      <span class='error_goto'>__PYX_ERR(0, 303, __pyx_L1_error)</span>
    }
    *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sphere_points.data + __pyx_t_15 * __pyx_v_sphere_points.strides[0]) ) + __pyx_t_16 * __pyx_v_sphere_points.strides[1]) )) = (sin(__pyx_v_phi) * __pyx_v_rd);
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">304</span>:     <span class="k">return</span> <span class="n">sphere_points</span></pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_sphere_points, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 304, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">305</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">306</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">307</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">308</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">309</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-99" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">310</span>: <span class="k">def</span> <span class="nf">asa</span><span class="p">(</span><span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">xyz</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">resLookUp</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">caDist</span><span class="p">,</span> <span class="n">double</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">sphere_points</span><span class="p">,</span></pre>
<pre class='cython code score-99 '>/* Python wrapper */
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_15asa(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_3mfm_9structure_9potential_11cPotentials_14asa[] = "\n    Returns list of accessible surface areas of the atoms, using the probe\n    and atom radius to define the surface.\n\n    Routines to calculate the Accessible Surface Area of a set of atoms.\n    The algorithm is adapted from the Rose lab's chasa.py, which uses\n\n    :param xyz:\n    :param resLookUp:\n    :param caDist:\n    :param sphere_points:\n    :param probe:\n    :param radius:\n    :param sum:\n    the dot density technique found in:\n\n    Shrake, A., and J. A. Rupley. \"Environment and Exposure to Solvent\n    of Protein Atoms. Lysozyme and Insulin.\" JMB (1973) 79:351-371.\n    ";
static PyMethodDef __pyx_mdef_3mfm_9structure_9potential_11cPotentials_15asa = {"asa", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_3mfm_9structure_9potential_11cPotentials_15asa, METH_VARARGS|METH_KEYWORDS, __pyx_doc_3mfm_9structure_9potential_11cPotentials_14asa};
static PyObject *__pyx_pw_3mfm_9structure_9potential_11cPotentials_15asa(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_xyz = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_resLookUp = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_caDist = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_sphere_points = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_probe;
  double __pyx_v_radius;
  CYTHON_UNUSED char __pyx_v_sum;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("asa (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_xyz,&amp;__pyx_n_s_resLookUp,&amp;__pyx_n_s_caDist,&amp;__pyx_n_s_sphere_points,&amp;__pyx_n_s_probe,&amp;__pyx_n_s_radius,&amp;__pyx_n_s_sum,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_xyz)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_resLookUp)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("asa", 0, 4, 7, 1); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_caDist)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("asa", 0, 4, 7, 2); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_sphere_points)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("asa", 0, 4, 7, 3); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_probe);
          if (value) { values[4] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_radius);
          if (value) { values[5] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_sum);
          if (value) { values[6] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "asa") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_xyz = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_xyz.memview)) __PYX_ERR(0, 310, __pyx_L3_error)</span>
    __pyx_v_resLookUp = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_int</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_resLookUp.memview)) __PYX_ERR(0, 310, __pyx_L3_error)</span>
    __pyx_v_caDist = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_caDist.memview)) __PYX_ERR(0, 310, __pyx_L3_error)</span>
    __pyx_v_sphere_points = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_sphere_points.memview)) __PYX_ERR(0, 310, __pyx_L3_error)</span>
    if (values[4]) {
      __pyx_v_probe = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_probe == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
    } else {
      __pyx_v_probe = ((double)1.0);
    }
    if (values[5]) {
      __pyx_v_radius = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_radius == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
    } else {
      __pyx_v_radius = ((double)2.5);
    }
    if (values[6]) {
      __pyx_v_sum = <span class='pyx_c_api'>__Pyx_PyInt_As_char</span>(values[6]); if (unlikely((__pyx_v_sum == (char)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L3_error)</span>
    } else {
      __pyx_v_sum = ((char)1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("asa", 0, 4, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.asa", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_3mfm_9structure_9potential_11cPotentials_14asa(__pyx_self, __pyx_v_xyz, __pyx_v_resLookUp, __pyx_v_caDist, __pyx_v_sphere_points, __pyx_v_probe, __pyx_v_radius, __pyx_v_sum);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_3mfm_9structure_9potential_11cPotentials_14asa(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_xyz, __Pyx_memviewslice __pyx_v_resLookUp, __Pyx_memviewslice __pyx_v_caDist, __Pyx_memviewslice __pyx_v_sphere_points, double __pyx_v_probe, double __pyx_v_radius, CYTHON_UNUSED char __pyx_v_sum) {
  char __pyx_v_is_accessible;
  int32_t __pyx_v_n_accessible_point;
  int32_t __pyx_v_n_neighbor;
  int32_t __pyx_v_i;
  int32_t __pyx_v_j;
  int32_t __pyx_v_k;
  int32_t __pyx_v_nSphere;
  int32_t __pyx_v_nCi;
  int32_t __pyx_v_nRes;
  double __pyx_v_area;
  double __pyx_v_aX;
  double __pyx_v_aY;
  double __pyx_v_aZ;
  double __pyx_v_bX;
  double __pyx_v_bY;
  double __pyx_v_bZ;
  int *__pyx_v_neighbor_indices;
  double __pyx_v_c;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("asa", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_35);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("mfm.structure.potential.cPotentials.asa", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_xyz, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_resLookUp, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_caDist, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_sphere_points, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__40 = <span class='py_c_api'>PyTuple_Pack</span>(25, __pyx_n_s_xyz, __pyx_n_s_resLookUp, __pyx_n_s_caDist, __pyx_n_s_sphere_points, __pyx_n_s_probe, __pyx_n_s_radius, __pyx_n_s_sum, __pyx_n_s_is_accessible, __pyx_n_s_n_accessible_point, __pyx_n_s_n_neighbor, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_nSphere, __pyx_n_s_nCi, __pyx_n_s_nRes, __pyx_n_s_area, __pyx_n_s_aX, __pyx_n_s_aY, __pyx_n_s_aZ, __pyx_n_s_bX, __pyx_n_s_bY, __pyx_n_s_bZ, __pyx_n_s_neighbor_indices, __pyx_n_s_c);<span class='error_goto'> if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__40);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__40);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_3mfm_9structure_9potential_11cPotentials_15asa, NULL, __pyx_n_s_mfm_structure_potential_cPotenti_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_asa, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__41 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 25, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__40, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_mfm_structure_potential_cPotenti, __pyx_n_s_asa, 310, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__41)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">311</span>:         <span class="n">double</span> <span class="n">probe</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">double</span> <span class="n">radius</span> <span class="o">=</span> <span class="mf">2.5</span><span class="p">,</span> <span class="n">char</span> <span class="nb">sum</span><span class="o">=</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">312</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">313</span>: <span class="sd">    Returns list of accessible surface areas of the atoms, using the probe</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">314</span>: <span class="sd">    and atom radius to define the surface.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">315</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">316</span>: <span class="sd">    Routines to calculate the Accessible Surface Area of a set of atoms.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">317</span>: <span class="sd">    The algorithm is adapted from the Rose lab&#39;s chasa.py, which uses</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">318</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">319</span>: <span class="sd">    :param xyz:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">320</span>: <span class="sd">    :param resLookUp:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">321</span>: <span class="sd">    :param caDist:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">322</span>: <span class="sd">    :param sphere_points:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">323</span>: <span class="sd">    :param probe:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">324</span>: <span class="sd">    :param radius:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">325</span>: <span class="sd">    :param sum:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">326</span>: <span class="sd">    the dot density technique found in:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">327</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">328</span>: <span class="sd">    Shrake, A., and J. A. Rupley. &quot;Environment and Exposure to Solvent</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">329</span>: <span class="sd">    of Protein Atoms. Lysozyme and Insulin.&quot; JMB (1973) 79:351-371.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">330</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">331</span>:     <span class="k">cdef</span> <span class="kt">char</span> <span class="nf">is_accessible</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">332</span>:     <span class="k">cdef</span> <span class="kt">int32_t</span> <span class="nf">n_accessible_point</span><span class="p">,</span> <span class="nf">n_neighbor</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">333</span>:     <span class="k">cdef</span> <span class="kt">int32_t</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span><span class="p">,</span> <span class="nf">nSphere</span><span class="p">,</span> <span class="nf">nCi</span><span class="p">,</span> <span class="nf">nRes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">334</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">335</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">area</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">336</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">aX</span><span class="p">,</span> <span class="nf">aY</span><span class="p">,</span> <span class="nf">aZ</span><span class="p">,</span> <span class="nf">bX</span><span class="p">,</span> <span class="nf">bY</span><span class="p">,</span> <span class="nf">bZ</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">337</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">338</span>:     <span class="n">nSphere</span> <span class="o">=</span> <span class="n">sphere_points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nSphere = (__pyx_v_sphere_points.shape[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">339</span>:     <span class="n">nRes</span> <span class="o">=</span> <span class="n">caDist</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nRes = (__pyx_v_caDist.shape[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">340</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">341</span>:     <span class="k">cdef</span> <span class="kt">int</span>* <span class="nf">neighbor_indices</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">int</span><span class="o">*&gt;</span> <span class="n">malloc</span><span class="p">(</span><span class="n">sizeof</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">*</span> <span class="n">nRes</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_neighbor_indices = ((int *)malloc(((sizeof(int)) * __pyx_v_nRes)));
</pre><pre class="cython line score-0">&#xA0;<span class="">342</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">343</span>:     <span class="c"># calcuate asa</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">344</span>:     <span class="n">area</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_area = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">345</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">c</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="mf">3.14159265359</span> <span class="o">/</span> <span class="p">(&lt;</span><span class="kt">double</span><span class="p">&gt;</span> <span class="n">nSphere</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_v_c = ((4.0 * 3.14159265359) / ((double)__pyx_v_nSphere));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">346</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nRes</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_nRes;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">347</span>:         <span class="n">nCi</span> <span class="o">=</span> <span class="n">resLookUp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mf">3</span> <span class="o">+</span> <span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_5 = 6;
    if (__pyx_t_4 &lt; 0) __pyx_t_4 += __pyx_v_resLookUp.shape[0];
    if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_resLookUp.shape[1];
    __pyx_v_nCi = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_4 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_5 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">348</span>:         <span class="c"># find neighbors!</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">349</span>:         <span class="n">n_neighbor</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_n_neighbor = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">350</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nRes</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_nRes;
    __pyx_t_7 = __pyx_t_6;
    for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
      __pyx_v_j = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">351</span>:             <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_9 = ((__pyx_v_i != __pyx_v_j) != 0);
      if (__pyx_t_9) {
/* … */
      }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">352</span>:                 <span class="k">if</span> <span class="n">caDist</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">radius</span> <span class="o">+</span> <span class="n">probe</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_10 = __pyx_v_i;
        __pyx_t_11 = __pyx_v_j;
        if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_v_caDist.shape[0];
        if (__pyx_t_11 &lt; 0) __pyx_t_11 += __pyx_v_caDist.shape[1];
        __pyx_t_9 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_caDist.data + __pyx_t_10 * __pyx_v_caDist.strides[0]) ) + __pyx_t_11 * __pyx_v_caDist.strides[1]) ))) &lt; (2.0 * (__pyx_v_radius + __pyx_v_probe))) != 0);
        if (__pyx_t_9) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">353</span>:                     <span class="n">neighbor_indices</span><span class="p">[</span><span class="n">n_neighbor</span><span class="p">]</span> <span class="o">=</span> <span class="n">resLookUp</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">3</span> <span class="o">+</span> <span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>          __pyx_t_12 = __pyx_v_j;
          __pyx_t_13 = 6;
          if (__pyx_t_12 &lt; 0) __pyx_t_12 += __pyx_v_resLookUp.shape[0];
          if (__pyx_t_13 &lt; 0) __pyx_t_13 += __pyx_v_resLookUp.shape[1];
          (__pyx_v_neighbor_indices[__pyx_v_n_neighbor]) = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_resLookUp.data + __pyx_t_12 * __pyx_v_resLookUp.strides[0]) ) + __pyx_t_13 * __pyx_v_resLookUp.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">354</span>:                     <span class="n">n_neighbor</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>          __pyx_v_n_neighbor = (__pyx_v_n_neighbor + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">355</span>:         <span class="c"># accessible?</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">356</span>:         <span class="n">n_accessible_point</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_n_accessible_point = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">357</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nSphere</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>    __pyx_t_6 = __pyx_v_nSphere;
    __pyx_t_7 = __pyx_t_6;
    for (__pyx_t_8 = 0; __pyx_t_8 &lt; __pyx_t_7; __pyx_t_8+=1) {
      __pyx_v_j = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">358</span>:             <span class="n">is_accessible</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_is_accessible = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">359</span>:             <span class="n">aX</span> <span class="o">=</span> <span class="n">sphere_points</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">radius</span> <span class="o">+</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCi</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_14 = __pyx_v_j;
      __pyx_t_15 = 0;
      if (__pyx_t_14 &lt; 0) __pyx_t_14 += __pyx_v_sphere_points.shape[0];
      if (__pyx_t_15 &lt; 0) __pyx_t_15 += __pyx_v_sphere_points.shape[1];
      __pyx_t_16 = __pyx_v_nCi;
      __pyx_t_17 = 0;
      if (__pyx_t_16 &lt; 0) __pyx_t_16 += __pyx_v_xyz.shape[0];
      if (__pyx_t_17 &lt; 0) __pyx_t_17 += __pyx_v_xyz.shape[1];
      __pyx_v_aX = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sphere_points.data + __pyx_t_14 * __pyx_v_sphere_points.strides[0]) ) + __pyx_t_15 * __pyx_v_sphere_points.strides[1]) ))) * __pyx_v_radius) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_16 * __pyx_v_xyz.strides[0]) ) + __pyx_t_17 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">360</span>:             <span class="n">aY</span> <span class="o">=</span> <span class="n">sphere_points</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">radius</span> <span class="o">+</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCi</span><span class="p">,</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_18 = __pyx_v_j;
      __pyx_t_19 = 1;
      if (__pyx_t_18 &lt; 0) __pyx_t_18 += __pyx_v_sphere_points.shape[0];
      if (__pyx_t_19 &lt; 0) __pyx_t_19 += __pyx_v_sphere_points.shape[1];
      __pyx_t_20 = __pyx_v_nCi;
      __pyx_t_21 = 1;
      if (__pyx_t_20 &lt; 0) __pyx_t_20 += __pyx_v_xyz.shape[0];
      if (__pyx_t_21 &lt; 0) __pyx_t_21 += __pyx_v_xyz.shape[1];
      __pyx_v_aY = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sphere_points.data + __pyx_t_18 * __pyx_v_sphere_points.strides[0]) ) + __pyx_t_19 * __pyx_v_sphere_points.strides[1]) ))) * __pyx_v_radius) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_20 * __pyx_v_xyz.strides[0]) ) + __pyx_t_21 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">361</span>:             <span class="n">aZ</span> <span class="o">=</span> <span class="n">sphere_points</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">radius</span> <span class="o">+</span> <span class="n">xyz</span><span class="p">[</span><span class="n">nCi</span><span class="p">,</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_t_22 = __pyx_v_j;
      __pyx_t_23 = 2;
      if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_v_sphere_points.shape[0];
      if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_v_sphere_points.shape[1];
      __pyx_t_24 = __pyx_v_nCi;
      __pyx_t_25 = 2;
      if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_v_xyz.shape[0];
      if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_v_xyz.shape[1];
      __pyx_v_aZ = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sphere_points.data + __pyx_t_22 * __pyx_v_sphere_points.strides[0]) ) + __pyx_t_23 * __pyx_v_sphere_points.strides[1]) ))) * __pyx_v_radius) + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_24 * __pyx_v_xyz.strides[0]) ) + __pyx_t_25 * __pyx_v_xyz.strides[1]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">362</span>:             <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_neighbor</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_26 = __pyx_v_n_neighbor;
      __pyx_t_27 = __pyx_t_26;
      for (__pyx_t_28 = 0; __pyx_t_28 &lt; __pyx_t_27; __pyx_t_28+=1) {
        __pyx_v_k = __pyx_t_28;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">363</span>:                 <span class="n">bX</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">neighbor_indices</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_29 = (__pyx_v_neighbor_indices[__pyx_v_k]);
        __pyx_t_30 = 0;
        if (__pyx_t_29 &lt; 0) __pyx_t_29 += __pyx_v_xyz.shape[0];
        if (__pyx_t_30 &lt; 0) __pyx_t_30 += __pyx_v_xyz.shape[1];
        __pyx_v_bX = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_29 * __pyx_v_xyz.strides[0]) ) + __pyx_t_30 * __pyx_v_xyz.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">364</span>:                 <span class="n">bY</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">neighbor_indices</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_31 = (__pyx_v_neighbor_indices[__pyx_v_k]);
        __pyx_t_32 = 1;
        if (__pyx_t_31 &lt; 0) __pyx_t_31 += __pyx_v_xyz.shape[0];
        if (__pyx_t_32 &lt; 0) __pyx_t_32 += __pyx_v_xyz.shape[1];
        __pyx_v_bY = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_31 * __pyx_v_xyz.strides[0]) ) + __pyx_t_32 * __pyx_v_xyz.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">365</span>:                 <span class="n">bZ</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">[</span><span class="n">neighbor_indices</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>        __pyx_t_33 = (__pyx_v_neighbor_indices[__pyx_v_k]);
        __pyx_t_34 = 2;
        if (__pyx_t_33 &lt; 0) __pyx_t_33 += __pyx_v_xyz.shape[0];
        if (__pyx_t_34 &lt; 0) __pyx_t_34 += __pyx_v_xyz.shape[1];
        __pyx_v_bZ = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_xyz.data + __pyx_t_33 * __pyx_v_xyz.strides[0]) ) + __pyx_t_34 * __pyx_v_xyz.strides[1]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">366</span>:                 <span class="k">if</span> <span class="n">dist3c2</span><span class="p">(</span><span class="n">aX</span><span class="p">,</span> <span class="n">aY</span><span class="p">,</span> <span class="n">aZ</span><span class="p">,</span> <span class="n">bX</span><span class="p">,</span> <span class="n">bY</span><span class="p">,</span> <span class="n">bZ</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">radius</span> <span class="o">+</span> <span class="n">probe</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">radius</span> <span class="o">+</span> <span class="n">probe</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_9 = ((__pyx_f_3mfm_9structure_9potential_11cPotentials_dist3c2(__pyx_v_aX, __pyx_v_aY, __pyx_v_aZ, __pyx_v_bX, __pyx_v_bY, __pyx_v_bZ) &lt; ((__pyx_v_radius + __pyx_v_probe) * (__pyx_v_radius + __pyx_v_probe))) != 0);
        if (__pyx_t_9) {
/* … */
        }
      }
      __pyx_L12_break:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">367</span>:                     <span class="n">is_accessible</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>          __pyx_v_is_accessible = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">368</span>:                     <span class="k">break</span></pre>
<pre class='cython code score-0 '>          goto __pyx_L12_break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">369</span>:             <span class="k">if</span> <span class="n">is_accessible</span> <span class="o">&gt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>      __pyx_t_9 = ((__pyx_v_is_accessible &gt; 0) != 0);
      if (__pyx_t_9) {
/* … */
      }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">370</span>:                 <span class="n">n_accessible_point</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>        __pyx_v_n_accessible_point = (__pyx_v_n_accessible_point + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">371</span>:         <span class="n">area</span> <span class="o">+=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">n_accessible_point</span> <span class="o">*</span> <span class="n">radius</span> <span class="o">**</span> <span class="mf">2</span></pre>
<pre class='cython code score-0 '>    __pyx_v_area = (__pyx_v_area + ((__pyx_v_c * __pyx_v_n_accessible_point) * pow(__pyx_v_radius, 2.0)));
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">372</span>:     <span class="n">free</span><span class="p">(</span><span class="n">neighbor_indices</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  free(__pyx_v_neighbor_indices);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">373</span>:     <span class="k">return</span> <span class="n">area</span></pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_35 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_area);<span class='error_goto'> if (unlikely(!__pyx_t_35)) __PYX_ERR(0, 373, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_35);
  __pyx_r = __pyx_t_35;
  __pyx_t_35 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">374</span>: </pre>
</div></body></html>
